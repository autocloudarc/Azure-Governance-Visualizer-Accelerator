{
  "identity": {
    "principalId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
    "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
    "type": "SystemAssigned"
  },
  "properties": {
    "displayName": "Enable Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26",
    "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
    "notScopes": [],
    "parameters": {
      "bringYourOwnDcr": {
        "value": true
      },
      "bringYourOwnUserAssignedManagedIdentity": {
        "value": true
      },
      "dcrResourceId": {
        "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-defendersql-prod"
      },
      "enableCollectionOfSqlQueriesForSecurityResearch": {
        "value": false
      },
      "userAssignedIdentityResourceId": {
        "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
      },
      "userWorkspaceResourceId": {
        "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
      },
      "workspaceRegion": {
        "value": "northeurope"
      }
    },
    "description": "Microsoft Defender for SQL collects events from the agents and uses them to provide security alerts and tailored hardening tasks (recommendations).",
    "metadata": {
      "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
      "createdOn": "2026-01-21T00:37:34.5449446Z",
      "updatedBy": null,
      "updatedOn": null
    },
    "enforcementMode": "Default",
    "nonComplianceMessages": [
      {
        "message": "Microsoft Defender for SQL must be deployed."
      }
    ]
  },
  "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA",
  "type": "Microsoft.Authorization/policyAssignments",
  "name": "Deploy-MDFC-DefSQL-AMA",
  "location": "eastus2",
  "systemData": {
    "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
    "createdByType": "Application",
    "createdAt": "2026-01-21T00:37:33.9511722Z",
    "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
    "lastModifiedByType": "Application",
    "lastModifiedAt": "2026-01-21T00:37:33.9511722Z"
  }
}
