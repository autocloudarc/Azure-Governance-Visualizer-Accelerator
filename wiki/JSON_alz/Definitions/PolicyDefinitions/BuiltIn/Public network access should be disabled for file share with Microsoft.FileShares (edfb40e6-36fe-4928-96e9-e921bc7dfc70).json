{
  "displayName": "Public network access should be disabled for file share with Microsoft.FileShares",
  "policyType": "BuiltIn",
  "mode": "Indexed",
  "description": "Disabling the public endpoint allows you to restrict access to your Microsoft.FileShares resource to requests destined to approved private endpoints or service endpoints on your organization's network. You can disable the public endpoint for a file share with Microsoft.FileShares by setting the FileShare publicNetworkAccess of the resource to Disabled.",
  "metadata": {
    "version": "1.0.0",
    "category": "Storage"
  },
  "parameters": {
    "effect": {
      "type": "String",
      "metadata": {
        "displayName": "Effect",
        "description": "Enable or disable the execution of the policy"
      },
      "allowedValues": [
        "Audit",
        "Deny",
        "Disabled"
      ],
      "defaultValue": "Audit"
    }
  },
  "policyRule": {
    "if": {
      "allOf": [
        {
          "field": "type",
          "equals": "Microsoft.FileShares/fileShares"
        },
        {
          "field": "Microsoft.FileShares/fileShares/publicNetworkAccess",
          "notEquals": "Disabled"
        }
      ]
    },
    "then": {
      "effect": "[parameters('effect')]"
    }
  }
}
