{
  "displayName": "[Deprecated]: Packet Core Control Plane diagnostic access should only use Microsoft EntraID authentication type",
  "policyType": "BuiltIn",
  "mode": "Indexed",
  "description": "This policy is deprecated because the Microsoft.MobileNetwork resource provider has been decommissioned with no replacement. We recommend you remove all assignments of this policy and all references to it from initiatives. Learn more about policy definition deprecation at aka.ms/policydefdeprecation.",
  "metadata": {
    "category": "Mobile Network",
    "version": "1.1.0-deprecated",
    "deprecated": true
  },
  "parameters": {
    "effect": {
      "type": "String",
      "metadata": {
        "displayName": "Effect",
        "description": "Enable or disable the execution of the policy"
      },
      "allowedValues": [
        "Audit",
        "Deny",
        "Disabled"
      ],
      "defaultValue": "Disabled"
    }
  },
  "policyRule": {
    "if": {
      "allOf": [
        {
          "field": "type",
          "equals": "Microsoft.MobileNetwork/packetCoreControlPlanes"
        },
        {
          "field": "Microsoft.MobileNetwork/packetCoreControlPlanes/localDiagnosticsAccess.authenticationType",
          "notEquals": "AAD"
        }
      ]
    },
    "then": {
      "effect": "[parameters('effect')]"
    }
  }
}
