{
  "Tenant": {
    "TenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
    "RoleAssignments": {
      "/providers/microsoft.authorization/roleassignments/1c2f5871-2b4a-40a6-9847-5c5b64cacf20": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/1c2f5871-2b4a-40a6-9847-5c5b64cacf20",
          "Scope": "/",
          "DisplayName": "Microsoft Demos",
          "SignInName": null,
          "RoleDefinitionName": "User Access Administrator",
          "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
          "ObjectId": "3ba76acc-be40-4508-a9cb-2853c9ef3396",
          "ObjectType": "ServicePrincipal",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/2324fe2e-1979-4acb-8926-90cada27d38f": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/2324fe2e-1979-4acb-8926-90cada27d38f",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "Reader",
          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "ObjectId": "fcbfff18-947f-4838-93bb-7d7c05bc6104",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/396a42e5-df21-442d-baea-be4417b43786": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/396a42e5-df21-442d-baea-be4417b43786",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "Contributor",
          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
          "ObjectId": "a829b1b4-a9cf-4a4c-bea6-5de6be9284d0",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/3f6a3508-613b-4151-aa07-91279a479b72": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/3f6a3508-613b-4151-aa07-91279a479b72",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "Reader",
          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "ObjectId": "9411b893-21f5-4159-8c19-a3751d350461",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/609aeea5-19ff-4c15-852c-f55a0dfa570a": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/609aeea5-19ff-4c15-852c-f55a0dfa570a",
          "Scope": "/",
          "DisplayName": "System Administrator",
          "SignInName": "autocloudarc@autocloudarc.dev",
          "RoleDefinitionName": "User Access Administrator",
          "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
          "ObjectType": "User",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/6c2f6ce5-c83f-4266-bdbe-46819a8133c9": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/6c2f6ce5-c83f-4266-bdbe-46819a8133c9",
          "Scope": "/",
          "DisplayName": "spn-fed-ghe-0075",
          "SignInName": null,
          "RoleDefinitionName": "Contributor",
          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
          "ObjectId": "39f85f35-a02b-43d2-a0c3-3a963360e007",
          "ObjectType": "ServicePrincipal",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/7e5d0746-7b48-4318-a5f2-5572ff6a0a71": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/7e5d0746-7b48-4318-a5f2-5572ff6a0a71",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "Reader",
          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "ObjectId": "33a5a488-bf6b-4f23-88a1-58b647f32906",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/8d0f1561-2f71-4397-a7e3-95e1523f51a2": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/8d0f1561-2f71-4397-a7e3-95e1523f51a2",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "User Access Administrator",
          "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
          "ObjectId": "a829b1b4-a9cf-4a4c-bea6-5de6be9284d0",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/b5e24de5-913d-41b4-81dc-266b08f3f94f": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/b5e24de5-913d-41b4-81dc-266b08f3f94f",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "Reader",
          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "ObjectId": "a829b1b4-a9cf-4a4c-bea6-5de6be9284d0",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/b9aecb21-3e2d-4b2d-8d19-490702ebe7a1": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/b9aecb21-3e2d-4b2d-8d19-490702ebe7a1",
          "Scope": "/",
          "DisplayName": null,
          "SignInName": null,
          "RoleDefinitionName": "Owner",
          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
          "ObjectId": "a829b1b4-a9cf-4a4c-bea6-5de6be9284d0",
          "ObjectType": "Unknown",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/ee28d888-87f3-4784-a87c-ea020189db74": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/ee28d888-87f3-4784-a87c-ea020189db74",
          "Scope": "/",
          "DisplayName": "ado-user-cap-01",
          "SignInName": null,
          "RoleDefinitionName": "Reader",
          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "ObjectId": "a8a72541-fb63-4da2-98c7-4c06b0966a51",
          "ObjectType": "ServicePrincipal",
          "PIM": "false"
        }
      ],
      "/providers/microsoft.authorization/roleassignments/fcee7b62-c90a-4de2-8ecb-1536a2febdc6": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/fcee7b62-c90a-4de2-8ecb-1536a2febdc6",
          "Scope": "/",
          "DisplayName": "System Administrator",
          "SignInName": "autocloudarc@autocloudarc.dev",
          "RoleDefinitionName": "Owner",
          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
          "ObjectType": "User",
          "PIM": "false"
        }
      ]
    },
    "ManagementGroups": {
      "alz": {
        "MgId": "alz",
        "MgName": "Azure Landing Zones",
        "mgParentId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
        "mgParentName": "Tenant Root Group",
        "level": "1",
        "PolicyDefinitionsCustom": {
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/append-appservice-httpsonly": {
            "properties": {
              "displayName": "AppService append enable https only setting to enforce https setting.",
              "policyType": "Custom",
              "mode": "All",
              "description": "Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.2100733Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Web/sites/httpsOnly",
                      "notequals": true
                    }
                  ]
                },
                "then": {
                  "details": [
                    {
                      "field": "Microsoft.Web/sites/httpsOnly",
                      "value": true
                    }
                  ],
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Append-AppService-httpsonly",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.1765121Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.1765121Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/append-appservice-latesttls": {
            "properties": {
              "displayName": "AppService append sites with minimum TLS version to enforce.",
              "policyType": "Custom",
              "mode": "All",
              "description": "Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.3807763Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "minTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for a  Web App config to enforce",
                    "displayName": "Select version minimum TLS Web App config"
                  },
                  "allowedValues": [
                    "1.3",
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "exists": "true",
                      "field": "Microsoft.Web/sites/config/minTlsVersion"
                    },
                    {
                      "field": "Microsoft.Web/sites/config/minTlsVersion",
                      "less": "[parameters('minTlsVersion')]"
                    }
                  ]
                },
                "then": {
                  "details": [
                    {
                      "field": "Microsoft.Web/sites/config/minTlsVersion",
                      "value": "[parameters('minTlsVersion')]"
                    }
                  ],
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Append-AppService-latestTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.9315273Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.9315273Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/append-kv-softdelete": {
            "properties": {
              "displayName": "KeyVault SoftDelete should be enabled",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Key Vault",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.5621988Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {},
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.KeyVault/vaults",
                          "field": "type"
                        },
                        {
                          "field": "Microsoft.KeyVault/vaults/enableSoftDelete",
                          "notEquals": true
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": [
                    {
                      "field": "Microsoft.KeyVault/vaults/enableSoftDelete",
                      "value": true
                    }
                  ],
                  "effect": "append"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Append-KV-SoftDelete",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.4696026Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.4696026Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/append-redis-disablenonsslport": {
            "properties": {
              "displayName": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cache",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.6600918Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis",
                    "displayName": "Effect Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Cache/redis",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Cache/Redis/enableNonSslPort"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": [
                    {
                      "field": "Microsoft.Cache/Redis/enableNonSslPort",
                      "value": false
                    }
                  ],
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Append-Redis-disableNonSslPort",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.6031169Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.6031169Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/append-redis-sslenforcement": {
            "properties": {
              "displayName": "Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cache",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.8018834Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis",
                    "displayName": "Effect Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "minimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version Azure Cache for Redis to enforce",
                    "displayName": "Select version for Redis server"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Cache/redis",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.Cache/Redis/minimumTlsVersion",
                          "less": "[parameters('minimumTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": [
                    {
                      "field": "Microsoft.Cache/Redis/minimumTlsVersion",
                      "value": "[parameters('minimumTlsVersion')]"
                    }
                  ],
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Append-Redis-sslEnforcement",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.7779867Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.7779867Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-azurehybridbenefit": {
            "properties": {
              "displayName": "Audit AHUB for eligible VMs",
              "policyType": "Custom",
              "mode": "All",
              "description": "Optimize cost by enabling Azure Hybrid Benefit. Leverage this Policy definition as a cost control to reveal Virtual Machines not using AHUB.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cost Optimization",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.8166573Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "in": [
                        "Microsoft.Compute/virtualMachines",
                        "Microsoft.Compute/virtualMachineScaleSets"
                      ]
                    },
                    {
                      "equals": "MicrosoftWindowsServer",
                      "field": "Microsoft.Compute/imagePublisher"
                    },
                    {
                      "equals": "WindowsServer",
                      "field": "Microsoft.Compute/imageOffer"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "like": "2008-R2-SP1*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "like": "2012-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "like": "2016-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "like": "2019-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "like": "2022-*"
                        }
                      ]
                    },
                    {
                      "field": "Microsoft.Compute/licenseType",
                      "notEquals": "Windows_Server"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-AzureHybridBenefit",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.6609437Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.6609437Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-disks-unusedresourcescostoptimization": {
            "properties": {
              "displayName": "Unused Disks driving cost should be avoided",
              "policyType": "Custom",
              "mode": "All",
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Disks that are driving cost.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cost Optimization",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.5286721Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Compute/disks",
                      "field": "type"
                    },
                    {
                      "equals": "Unattached",
                      "field": "Microsoft.Compute/disks/diskState"
                    },
                    {
                      "allof": [
                        {
                          "field": "name",
                          "notlike": "*-ASRReplica"
                        },
                        {
                          "field": "name",
                          "notlike": "ms-asr-*"
                        },
                        {
                          "field": "name",
                          "notlike": "asrseeddisk-*"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-Disks-UnusedResourcesCostOptimization",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.4970551Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.4970551Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-machinelearning-privateendpointid": {
            "properties": {
              "displayName": "Control private endpoint connections to Azure Machine Learning",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.7317652Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces/privateEndpointConnections",
                      "field": "type"
                    },
                    {
                      "equals": "Approved",
                      "field": "Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id"
                        },
                        {
                          "notEquals": "[subscription().subscriptionId]",
                          "value": "[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-MachineLearning-PrivateEndpointId",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.6475637Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.6475637Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-privatelinkdnszones": {
            "properties": {
              "displayName": "Audit or Deny the creation of Private Link Private DNS Zones",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy audits or denies, depending on assignment effect, the creation of a Private Link Private DNS Zones in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.2",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.6567031Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "privateLinkDnsZones": {
                  "type": "Array",
                  "metadata": {
                    "description": "An array of Private Link Private DNS Zones to check for the existence of in the assigned scope.",
                    "displayName": "Private Link Private DNS Zones"
                  },
                  "defaultValue": [
                    "privatelink.adf.azure.com",
                    "privatelink.afs.azure.net",
                    "privatelink.agentsvc.azure-automation.net",
                    "privatelink.analysis.windows.net",
                    "privatelink.api.azureml.ms",
                    "privatelink.azconfig.io",
                    "privatelink.azure-api.net",
                    "privatelink.azure-automation.net",
                    "privatelink.azurecr.io",
                    "privatelink.azure-devices.net",
                    "privatelink.azure-devices-provisioning.net",
                    "privatelink.azuredatabricks.net",
                    "privatelink.azurehdinsight.net",
                    "privatelink.azurehealthcareapis.com",
                    "privatelink.azurestaticapps.net",
                    "privatelink.azuresynapse.net",
                    "privatelink.azurewebsites.net",
                    "privatelink.batch.azure.com",
                    "privatelink.blob.core.windows.net",
                    "privatelink.cassandra.cosmos.azure.com",
                    "privatelink.cognitiveservices.azure.com",
                    "privatelink.database.windows.net",
                    "privatelink.datafactory.azure.net",
                    "privatelink.dev.azuresynapse.net",
                    "privatelink.dfs.core.windows.net",
                    "privatelink.dicom.azurehealthcareapis.com",
                    "privatelink.digitaltwins.azure.net",
                    "privatelink.directline.botframework.com",
                    "privatelink.documents.azure.com",
                    "privatelink.eventgrid.azure.net",
                    "privatelink.file.core.windows.net",
                    "privatelink.gremlin.cosmos.azure.com",
                    "privatelink.guestconfiguration.azure.com",
                    "privatelink.his.arc.azure.com",
                    "privatelink.kubernetesconfiguration.azure.com",
                    "privatelink.managedhsm.azure.net",
                    "privatelink.mariadb.database.azure.com",
                    "privatelink.media.azure.net",
                    "privatelink.mongo.cosmos.azure.com",
                    "privatelink.monitor.azure.com",
                    "privatelink.mysql.database.azure.com",
                    "privatelink.notebooks.azure.net",
                    "privatelink.ods.opinsights.azure.com",
                    "privatelink.oms.opinsights.azure.com",
                    "privatelink.pbidedicated.windows.net",
                    "privatelink.postgres.database.azure.com",
                    "privatelink.prod.migration.windowsazure.com",
                    "privatelink.purview.azure.com",
                    "privatelink.purviewstudio.azure.com",
                    "privatelink.queue.core.windows.net",
                    "privatelink.redis.cache.windows.net",
                    "privatelink.redisenterprise.cache.azure.net",
                    "privatelink.search.windows.net",
                    "privatelink.service.signalr.net",
                    "privatelink.servicebus.windows.net",
                    "privatelink.siterecovery.windowsazure.com",
                    "privatelink.sql.azuresynapse.net",
                    "privatelink.table.core.windows.net",
                    "privatelink.table.cosmos.azure.com",
                    "privatelink.tip1.powerquery.microsoft.com",
                    "privatelink.token.botframework.com",
                    "privatelink.vaultcore.azure.net",
                    "privatelink.web.core.windows.net",
                    "privatelink.webpubsub.azure.com"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/privateDnsZones",
                      "field": "type"
                    },
                    {
                      "field": "name",
                      "in": "[parameters('privateLinkDnsZones')]"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-PrivateLinkDnsZones",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.6103492Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.6103492Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-publicipaddresses-unusedresourcescostoptimization": {
            "properties": {
              "displayName": "Unused Public IP addresses driving cost should be avoided",
              "policyType": "Custom",
              "mode": "All",
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Public IP addresses that are driving cost.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cost Optimization",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.4526364Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "microsoft.network/publicIpAddresses",
                      "field": "type"
                    },
                    {
                      "equals": "Static",
                      "field": "Microsoft.Network/publicIPAddresses/publicIPAllocationMethod"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.Network/publicIPAddresses/natGateway"
                        },
                        {
                          "equals": true,
                          "value": "[equals(length(field('Microsoft.Network/publicIPAddresses/natGateway')), 0)]"
                        }
                      ]
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.Network/publicIPAddresses/ipConfiguration"
                        },
                        {
                          "equals": true,
                          "value": "[equals(length(field('Microsoft.Network/publicIPAddresses/ipConfiguration')), 0)]"
                        }
                      ]
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.Network/publicIPAddresses/publicIPPrefix"
                        },
                        {
                          "equals": true,
                          "value": "[equals(length(field('Microsoft.Network/publicIPAddresses/publicIPPrefix')), 0)]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.4117909Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.4117909Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-serverfarms-unusedresourcescostoptimization": {
            "properties": {
              "displayName": "Unused App Service plans driving cost should be avoided",
              "policyType": "Custom",
              "mode": "All",
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned App Service plans that are driving cost.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cost Optimization",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.9937832Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/serverfarms",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Web/serverFarms/sku.tier",
                      "notEquals": "Free"
                    },
                    {
                      "equals": 0,
                      "field": "Microsoft.Web/serverFarms/numberOfSites"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-ServerFarms-UnusedResourcesCostOptimization",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.9541322Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.9541322Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-tags-mandatory": {
            "properties": {
              "displayName": "Audit for mandatory tags on resources",
              "policyType": "Custom",
              "mode": "All",
              "description": "Audits resources to ensure they have required tags based on tag array. Does not apply to resource groups.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Tags",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.9659295Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "mandatoryTags": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of mandatory tags that must be present on the resource group. The array should contain semicolon separated list of the tag names.",
                    "displayName": "Array of mandatory tags"
                  },
                  "defaultValue": [
                    "owner",
                    "costcenter"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "not": {
                    "count": {
                      "name": "tagcount",
                      "value": "[parameters('mandatoryTags')]",
                      "where": {
                        "containsKey": "[current('tagcount')]",
                        "field": "tags"
                      }
                    },
                    "equals": "[length(parameters('mandatoryTags'))]"
                  }
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-Tags-Mandatory",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-Tags-Mandatory",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.9421076Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.9421076Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/audit-tags-mandatory-rg": {
            "properties": {
              "displayName": "Audit for mandatory tags on resource groups",
              "policyType": "Custom",
              "mode": "All",
              "description": "Audits resource groups to ensure they have required tags based on tag array.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Tags",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.3472908Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "mandatoryTags": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of mandatory tags that must be present on the resource group. The array should contain semicolon separated list of the tag names.",
                    "displayName": "Array of mandatory tags"
                  },
                  "defaultValue": [
                    "owner",
                    "costcenter"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Resources/subscriptions/resourceGroups",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "not": {
                            "count": {
                              "name": "tagcount",
                              "value": "[parameters('mandatoryTags')]",
                              "where": {
                                "containsKey": "[current('tagcount')]",
                                "field": "tags"
                              }
                            },
                            "equals": "[length(parameters('mandatoryTags'))]"
                          }
                        },
                        {
                          "not": {
                            "count": {
                              "name": "tagnullcount",
                              "value": "[parameters('mandatoryTags')]",
                              "where": {
                                "notMatch": "",
                                "value": "[resourceGroup().tags[current('tagnullcount')]]"
                              }
                            },
                            "equals": "[length(parameters('mandatoryTags'))]"
                          }
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-Tags-Mandatory-Rg",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Audit-Tags-Mandatory-Rg",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.204016Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.204016Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-aa-child-resources": {
            "properties": {
              "displayName": "No child resources in Automation Account",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy denies the creation of child resources on the Automation Account",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureUSGovernment"
                ],
                "category": "Automation",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.4619902Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "in": [
                        "Microsoft.Automation/automationAccounts/runbooks",
                        "Microsoft.Automation/automationAccounts/variables",
                        "Microsoft.Automation/automationAccounts/modules",
                        "Microsoft.Automation/automationAccounts/credentials",
                        "Microsoft.Automation/automationAccounts/connections",
                        "Microsoft.Automation/automationAccounts/certificates"
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AA-child-resources",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.3200568Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.3200568Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-apim-tls": {
            "properties": {
              "displayName": "API Management services should use TLS version 1.2",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure API Management service should use TLS version 1.2",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "API Management",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:10.1049379Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.ApiManagement/service",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "greater": 0,
                          "value": "[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls10\":\"true\"')]"
                        },
                        {
                          "greater": 0,
                          "value": "[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls10\":true')]"
                        },
                        {
                          "greater": 0,
                          "value": "[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls11\":\"true\"')]"
                        },
                        {
                          "greater": 0,
                          "value": "[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls11\":true')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-APIM-TLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.9948253Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.9948253Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-appgw-without-tls": {
            "properties": {
              "displayName": "Application Gateway should be deployed with predefined Microsoft policy that is using TLS version 1.2",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy enables you to restrict that Application Gateways is always deployed with predefined Microsoft policy that is using TLS version 1.2",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.0485817Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "predefinedPolicyName": {
                  "type": "array",
                  "metadata": {
                    "description": "Predefined policy name",
                    "displayName": "Predefined policy name"
                  },
                  "defaultValue": [
                    "AppGwSslPolicy20220101",
                    "AppGwSslPolicy20170401S",
                    "AppGwSslPolicy20220101S"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/applicationGateways",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.Network/applicationGateways/sslPolicy.policyType",
                          "notEquals": "Predefined"
                        },
                        {
                          "exists": "false",
                          "field": "Microsoft.Network/applicationGateways/sslPolicy.policyType"
                        },
                        {
                          "field": "Microsoft.Network/applicationGateways/sslPolicy.policyName",
                          "notIn": "[parameters('predefinedPolicyName')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AppGw-Without-Tls",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.9312751Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.9312751Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-appgw-without-waf": {
            "properties": {
              "displayName": "Application Gateway should be deployed with WAF enabled",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy enables you to restrict that Application Gateways is always deployed with WAF enabled",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.2531124Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/applicationGateways",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Network/applicationGateways/sku.name",
                      "notequals": "WAF_v2"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AppGW-Without-WAF",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.2187169Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.2187169Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-appservice-without-byoc": {
            "properties": {
              "displayName": "App Service certificates must be stored in Key Vault",
              "policyType": "Custom",
              "mode": "All",
              "description": "App Service (including Logic apps and Function apps) must use certificates stored in Key Vault",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.8712275Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/certificates",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Web/certificates/keyVaultId"
                        },
                        {
                          "exists": "false",
                          "field": "Microsoft.Web/certificates/keyVaultSecretName"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AppService-without-BYOC",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.8172038Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.8172038Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-appserviceapiapp-http": {
            "properties": {
              "displayName": "API App should only be accessible over HTTPS",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:53.7873547Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "field": "kind",
                      "like": "*api"
                    },
                    {
                      "equals": "false",
                      "field": "Microsoft.Web/sites/httpsOnly"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AppServiceApiApp-http",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:53.7517165Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:53.7517165Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-appservicefunctionapp-http": {
            "properties": {
              "displayName": "Function App should only be accessible over HTTPS",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.5239037Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "field": "kind",
                      "like": "functionapp*"
                    },
                    {
                      "equals": "false",
                      "field": "Microsoft.Web/sites/httpsOnly"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AppServiceFunctionApp-http",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.4607456Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.4607456Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-appservicewebapp-http": {
            "properties": {
              "displayName": "Web Application should only be accessible over HTTPS",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.4313624Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "field": "kind",
                      "like": "app*"
                    },
                    {
                      "equals": "false",
                      "field": "Microsoft.Web/sites/httpsOnly"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AppServiceWebApp-http",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.4055676Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.4055676Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-azfw-without-policy": {
            "properties": {
              "displayName": "Azure Firewall should have a default Firewall Policy",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of Azure Firewall without a default Firewall Policy.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.4642169Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/azureFirewalls",
                      "field": "type"
                    },
                    {
                      "exists": "false",
                      "field": "Microsoft.Network/azureFirewalls/firewallPolicy.id"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AzFw-Without-Policy",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-AzFw-Without-Policy",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.4012191Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.4012191Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-cognitiveservices-networkacls": {
            "properties": {
              "displayName": "Network ACLs should be restricted for Cognitive Services",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Cognitive Services should not allow adding individual IPs or virtual network rules to the service-level firewall. Enable this to restrict inbound network access and enforce the usage of private endpoints.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cognitive Services",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.5454113Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.CognitiveServices/accounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "count": {
                            "field": "Microsoft.CognitiveServices/accounts/networkAcls.ipRules[*]"
                          },
                          "greater": 0
                        },
                        {
                          "count": {
                            "field": "Microsoft.CognitiveServices/accounts/networkAcls.virtualNetworkRules[*]"
                          },
                          "greater": 0
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-CognitiveServices-NetworkAcls",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.52605Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.52605Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-cognitiveservices-resource-kinds": {
            "properties": {
              "displayName": "Only explicit kinds for Cognitive Services should be allowed",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Cognitive Services should only create explicit allowed kinds.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cognitive Services",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.2637057Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedKinds": {
                  "type": "array",
                  "metadata": {
                    "description": "Select the allowed resource kinds to be used with Cognitive Services",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "AnomalyDetector",
                    "ComputerVision",
                    "CognitiveServices",
                    "ContentModerator",
                    "CustomVision.Training",
                    "CustomVision.Prediction",
                    "Face",
                    "FormRecognizer",
                    "ImmersiveReader",
                    "LUIS",
                    "Personalizer",
                    "SpeechServices",
                    "TextAnalytics",
                    "TextTranslation",
                    "OpenAI"
                  ],
                  "defaultValue": [
                    "AnomalyDetector",
                    "ComputerVision",
                    "CognitiveServices",
                    "ContentModerator",
                    "CustomVision.Training",
                    "CustomVision.Prediction",
                    "Face",
                    "FormRecognizer",
                    "ImmersiveReader",
                    "LUIS",
                    "Personalizer",
                    "SpeechServices",
                    "TextAnalytics",
                    "TextTranslation",
                    "OpenAI"
                  ]
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.CognitiveServices/accounts",
                      "field": "type"
                    },
                    {
                      "field": "kind",
                      "notIn": "[parameters('allowedKinds')]"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-Resource-Kinds",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-CognitiveServices-Resource-Kinds",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.2162526Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.2162526Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-cognitiveservices-restrictoutboundnetworkaccess": {
            "properties": {
              "displayName": "Outbound network access should be restricted for Cognitive Services",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Cognitive Services allow restricting outbound network access. Enable this to limit outbound connectivity for the service.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cognitive Services",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.3762996Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.CognitiveServices/accounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.CognitiveServices/accounts/restrictOutboundNetworkAccess"
                        },
                        {
                          "field": "Microsoft.CognitiveServices/accounts/restrictOutboundNetworkAccess",
                          "notEquals": true
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-CognitiveServices-RestrictOutboundNetworkAccess",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.3329154Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.3329154Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-databricks-nopublicip": {
            "properties": {
              "displayName": "Deny public IPs for Databricks cluster",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Databricks",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.8105506Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Databricks/workspaces",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value",
                      "notEquals": true
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Databricks-NoPublicIp",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.7738533Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.7738533Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-databricks-sku": {
            "properties": {
              "displayName": "Deny non-premium Databricks sku",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for Microsoft Entra ID.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Databricks",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.4573193Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Databricks/workspaces",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.DataBricks/workspaces/sku.name",
                      "notEquals": "premium"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Databricks-Sku",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.4265612Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.4265612Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-databricks-virtualnetwork": {
            "properties": {
              "displayName": "Deny Databricks workspaces without Vnet injection",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Enforces the use of vnet injection for Databricks workspaces.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Databricks",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.2355907Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Databricks/workspaces",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value"
                        },
                        {
                          "exists": false,
                          "field": "Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value"
                        },
                        {
                          "exists": false,
                          "field": "Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Databricks-VirtualNetwork",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.1473034Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.1473034Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-eh-mintls": {
            "properties": {
              "displayName": "Event Hub namespaces should use a valid TLS version",
              "policyType": "Custom",
              "mode": "All",
              "description": "Event Hub namespaces should use a valid TLS version.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Event Hub",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.2",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.8958541Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "minTlsVersion": {
                  "type": "string",
                  "metadata": {
                    "description": "Minimum TLS version to be used by Event Hub",
                    "displayName": "Minimum TLS Version"
                  },
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.EventHub/namespaces",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.EventHub/namespaces/minimumTlsVersion",
                          "less": "[parameters('minTlsVersion')]"
                        },
                        {
                          "exists": "false",
                          "field": "Microsoft.EventHub/namespaces/minimumTlsVersion"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-EH-minTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.8484389Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.8484389Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-eh-premium-cmk": {
            "properties": {
              "displayName": "Event Hub namespaces (Premium) should use a customer-managed key for encryption",
              "policyType": "Custom",
              "mode": "All",
              "description": "Event Hub namespaces (Premium) should use a customer-managed key for encryption.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Event Hub",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.476757Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.EventHub/namespaces",
                      "field": "type"
                    },
                    {
                      "equals": "Premium",
                      "field": "Microsoft.EventHub/namespaces/sku.name"
                    },
                    {
                      "not": {
                        "equals": "Microsoft.Keyvault",
                        "field": "Microsoft.EventHub/namespaces/encryption.keySource"
                      }
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-EH-Premium-CMK",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.4265148Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.4265148Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-fileservices-insecureauth": {
            "properties": {
              "displayName": "File Services with insecure authentication methods should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the use of insecure authentication methods (NTLMv2) when using File Services on a storage account.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.9801168Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "notAllowedAuthMethods": {
                  "type": "String",
                  "metadata": {
                    "description": "The list of channelEncryption not allowed.",
                    "displayName": "Authentication methods supported by server. Valid values are NTLMv2, Kerberos."
                  },
                  "allowedValues": [
                    "NTLMv2",
                    "Kerberos"
                  ],
                  "defaultValue": "NTLMv2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "contains": "[parameters('notAllowedAuthMethods')]",
                      "field": "Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.authenticationMethods"
                    },
                    {
                      "equals": "Microsoft.Storage/storageAccounts/fileServices",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-FileServices-InsecureAuth",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.7916798Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.7916798Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-fileservices-insecurekerberos": {
            "properties": {
              "displayName": "File Services with insecure Kerberos ticket encryption should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the use of insecure Kerberos ticket encryption (RC4-HMAC) when using File Services on a storage account.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.7055147Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "notAllowedKerberosTicketEncryption": {
                  "type": "String",
                  "metadata": {
                    "description": "The list of kerberosTicketEncryption not allowed.",
                    "displayName": "Kerberos ticket encryption supported by server. Valid values are RC4-HMAC, AES-256."
                  },
                  "allowedValues": [
                    "RC4-HMAC",
                    "AES-256"
                  ],
                  "defaultValue": "RC4-HMAC"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts/fileServices",
                      "field": "type"
                    },
                    {
                      "contains": "[parameters('notAllowedKerberosTicketEncryption')]",
                      "field": "Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.kerberosTicketEncryption"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-FileServices-InsecureKerberos",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.6677305Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.6677305Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-fileservices-insecuresmbchannel": {
            "properties": {
              "displayName": "File Services with insecure SMB channel encryption should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the use of insecure channel encryption (AES-128-CCM) when using File Services on a storage account.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.64579Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "notAllowedChannelEncryption": {
                  "type": "String",
                  "metadata": {
                    "description": "The list of channelEncryption not allowed.",
                    "displayName": "SMB channel encryption supported by server. Valid values are AES-128-CCM, AES-128-GCM, AES-256-GCM."
                  },
                  "allowedValues": [
                    "AES-128-CCM",
                    "AES-128-GCM",
                    "AES-256-GCM"
                  ],
                  "defaultValue": "AES-128-CCM"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts/fileServices",
                      "field": "type"
                    },
                    {
                      "contains": "[parameters('notAllowedChannelEncryption')]",
                      "field": "Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.channelEncryption"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-FileServices-InsecureSmbChannel",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.6264147Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.6264147Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-fileservices-insecuresmbversions": {
            "properties": {
              "displayName": "File Services with insecure SMB versions should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the use of insecure versions of SMB (2.1 & 3.0) when using File Services on a storage account.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.2036708Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedSmbVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "The allowed SMB version for maximum security",
                    "displayName": "Allowed SMB Version"
                  },
                  "allowedValues": [
                    "SMB2.1",
                    "SMB3.0",
                    "SMB3.1.1"
                  ],
                  "defaultValue": "SMB3.1.1"
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts/fileServices",
                      "field": "type"
                    },
                    {
                      "not": {
                        "contains": "[parameters('allowedSmbVersion')]",
                        "field": "Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.versions"
                      }
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-FileServices-InsecureSmbVersions",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.184208Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.184208Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-logicapp-public-network": {
            "properties": {
              "displayName": "Logic apps should disable public network access",
              "policyType": "Custom",
              "mode": "All",
              "description": "Disabling public network access improves security by ensuring that the Logic App is not exposed on the public internet. Creating private endpoints can limit exposure of a Logic App. Learn more at: https://aka.ms/app-service-private-endpoint.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Logic Apps",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.6993292Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "contains": "workflowapp",
                      "field": "kind"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Web/sites/publicNetworkAccess"
                        },
                        {
                          "field": "Microsoft.Web/sites/publicNetworkAccess",
                          "notEquals": "Disabled"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-LogicApp-Public-Network",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.6572248Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.6572248Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-logicapps-without-https": {
            "properties": {
              "displayName": "Logic app should only be accessible over HTTPS",
              "policyType": "Custom",
              "mode": "All",
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Logic Apps",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.4426864Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "contains": "workflowapp",
                      "field": "kind"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Web/sites/httpsOnly"
                        },
                        {
                          "equals": "false",
                          "field": "Microsoft.Web/sites/httpsOnly"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-LogicApps-Without-Https",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.4108922Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.4108922Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-aks": {
            "properties": {
              "displayName": "Deny AKS cluster creation in Azure Machine Learning",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.0040394Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces/computes",
                      "field": "type"
                    },
                    {
                      "equals": "AKS",
                      "field": "Microsoft.MachineLearningServices/workspaces/computes/computeType"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.MachineLearningServices/workspaces/computes/resourceId"
                        },
                        {
                          "equals": true,
                          "value": "[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-Aks",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.9647367Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.9647367Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-compute-subnetid": {
            "properties": {
              "displayName": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.2086187Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces/computes",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.MachineLearningServices/workspaces/computes/computeType",
                      "in": [
                        "AmlCompute",
                        "ComputeInstance"
                      ]
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.MachineLearningServices/workspaces/computes/subnet.id"
                        },
                        {
                          "equals": true,
                          "value": "[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-Compute-SubnetId",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.1793002Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.1793002Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-compute-vmsize": {
            "properties": {
              "displayName": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Budget",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.7885089Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedVmSizes": {
                  "type": "Array",
                  "metadata": {
                    "description": "Specifies the allowed VM Sizes for Aml Compute Clusters and Instances",
                    "displayName": "Allowed VM Sizes for Aml Compute Clusters and Instances"
                  },
                  "defaultValue": [
                    "Standard_D1_v2",
                    "Standard_D2_v2",
                    "Standard_D3_v2",
                    "Standard_D4_v2",
                    "Standard_D11_v2",
                    "Standard_D12_v2",
                    "Standard_D13_v2",
                    "Standard_D14_v2",
                    "Standard_DS1_v2",
                    "Standard_DS2_v2",
                    "Standard_DS3_v2",
                    "Standard_DS4_v2",
                    "Standard_DS5_v2",
                    "Standard_DS11_v2",
                    "Standard_DS12_v2",
                    "Standard_DS13_v2",
                    "Standard_DS14_v2",
                    "Standard_M8-2ms",
                    "Standard_M8-4ms",
                    "Standard_M8ms",
                    "Standard_M16-4ms",
                    "Standard_M16-8ms",
                    "Standard_M16ms",
                    "Standard_M32-8ms",
                    "Standard_M32-16ms",
                    "Standard_M32ls",
                    "Standard_M32ms",
                    "Standard_M32ts",
                    "Standard_M64-16ms",
                    "Standard_M64-32ms",
                    "Standard_M64ls",
                    "Standard_M64ms",
                    "Standard_M64s",
                    "Standard_M128-32ms",
                    "Standard_M128-64ms",
                    "Standard_M128ms",
                    "Standard_M128s",
                    "Standard_M64",
                    "Standard_M64m",
                    "Standard_M128",
                    "Standard_M128m",
                    "Standard_D1",
                    "Standard_D2",
                    "Standard_D3",
                    "Standard_D4",
                    "Standard_D11",
                    "Standard_D12",
                    "Standard_D13",
                    "Standard_D14",
                    "Standard_DS15_v2",
                    "Standard_NV6",
                    "Standard_NV12",
                    "Standard_NV24",
                    "Standard_F2s_v2",
                    "Standard_F4s_v2",
                    "Standard_F8s_v2",
                    "Standard_F16s_v2",
                    "Standard_F32s_v2",
                    "Standard_F64s_v2",
                    "Standard_F72s_v2",
                    "Standard_NC6s_v3",
                    "Standard_NC12s_v3",
                    "Standard_NC24rs_v3",
                    "Standard_NC24s_v3",
                    "Standard_NC6",
                    "Standard_NC12",
                    "Standard_NC24",
                    "Standard_NC24r",
                    "Standard_ND6s",
                    "Standard_ND12s",
                    "Standard_ND24rs",
                    "Standard_ND24s",
                    "Standard_NC6s_v2",
                    "Standard_NC12s_v2",
                    "Standard_NC24rs_v2",
                    "Standard_NC24s_v2",
                    "Standard_ND40rs_v2",
                    "Standard_NV12s_v3",
                    "Standard_NV24s_v3",
                    "Standard_NV48s_v3"
                  ]
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces/computes",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.MachineLearningServices/workspaces/computes/computeType",
                      "in": [
                        "AmlCompute",
                        "ComputeInstance"
                      ]
                    },
                    {
                      "field": "Microsoft.MachineLearningServices/workspaces/computes/vmSize",
                      "notIn": "[parameters('allowedVmSizes')]"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-Compute-VmSize",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.7071393Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.7071393Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-computecluster-remoteloginportpublicaccess": {
            "properties": {
              "displayName": "Deny public access of Azure Machine Learning clusters via SSH",
              "policyType": "Custom",
              "mode": "All",
              "description": "Deny public access of Azure Machine Learning clusters via SSH.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.5597239Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces/computes",
                      "field": "type"
                    },
                    {
                      "equals": "AmlCompute",
                      "field": "Microsoft.MachineLearningServices/workspaces/computes/computeType"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess"
                        },
                        {
                          "field": "Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess",
                          "notEquals": "Disabled"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.4956829Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.4956829Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-computecluster-scale": {
            "properties": {
              "displayName": "Enforce scale settings for Azure Machine Learning compute clusters",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Enforce scale settings for Azure Machine Learning compute clusters.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Budget",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:01.180828Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "maxNodeCount": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Specifies the maximum node count of AML Clusters",
                    "displayName": "Maximum Node Count"
                  },
                  "defaultValue": 10
                },
                "maxNodeIdleTimeInSecondsBeforeScaleDown": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Specifies the maximum node idle time in seconds before scaledown",
                    "displayName": "Maximum Node Idle Time in Seconds Before Scaledown"
                  },
                  "defaultValue": 900
                },
                "minNodeCount": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Specifies the minimum node count of AML Clusters",
                    "displayName": "Minimum Node Count"
                  },
                  "defaultValue": 0
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces/computes",
                      "field": "type"
                    },
                    {
                      "equals": "AmlCompute",
                      "field": "Microsoft.MachineLearningServices/workspaces/computes/computeType"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount",
                          "greater": "[parameters('maxNodeCount')]"
                        },
                        {
                          "field": "Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount",
                          "greater": "[parameters('minNodeCount')]"
                        },
                        {
                          "greater": "[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]",
                          "value": "[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-ComputeCluster-Scale",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:01.1099233Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:01.1099233Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-hbiworkspace": {
            "properties": {
              "displayName": "Enforces high business impact Azure Machine Learning Workspaces",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Enforces high business impact Azure Machine Learning workspaces.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.1254273Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.MachineLearningServices/workspaces/hbiWorkspace"
                        },
                        {
                          "field": "Microsoft.MachineLearningServices/workspaces/hbiWorkspace",
                          "notEquals": true
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-HbiWorkspace",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.0462533Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.0462533Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-publicaccesswhenbehindvnet": {
            "properties": {
              "displayName": "Deny public access behind vnet to Azure Machine Learning workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deny public access behind vnet to Azure Machine Learning workspaces.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.0824966Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet"
                        },
                        {
                          "field": "Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet",
                          "notEquals": false
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.029622Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.029622Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-machinelearning-publicnetworkaccess": {
            "properties": {
              "displayName": "[Deprecated] Azure Machine Learning should have disabled public network access",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Denies public network access for Azure Machine Learning workspaces. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/438c38d2-3772-465a-a9cc-7a6666a275ce.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Machine Learning",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "438c38d2-3772-465a-a9cc-7a6666a275ce",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.9122443Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.MachineLearningServices/workspaces",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.MachineLearningServices/workspaces/publicNetworkAccess",
                      "notEquals": "Disabled"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MachineLearning-PublicNetworkAccess",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.8300251Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.8300251Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-mgmtports-from-internet": {
            "properties": {
              "displayName": "Management port access from the Internet should be blocked",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies any network security rule that allows management port access from the Internet, by default blocking SSH/RDP ports.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "replacesPolicy": "Deny-RDP-From-Internet",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.7347544Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "ports": {
                  "type": "Array",
                  "metadata": {
                    "description": "Ports to be blocked",
                    "displayName": "Ports"
                  },
                  "defaultValue": [
                    "22",
                    "3389"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/networkSecurityGroups/securityRules",
                          "field": "type"
                        },
                        {
                          "allOf": [
                            {
                              "equals": "Allow",
                              "field": "Microsoft.Network/networkSecurityGroups/securityRules/access"
                            },
                            {
                              "equals": "Inbound",
                              "field": "Microsoft.Network/networkSecurityGroups/securityRules/direction"
                            },
                            {
                              "anyOf": [
                                {
                                  "equals": "*",
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"
                                },
                                {
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange",
                                  "in": "[parameters('ports')]"
                                },
                                {
                                  "count": {
                                    "value": "[parameters('ports')]",
                                    "where": {
                                      "equals": "true",
                                      "value": "[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current())),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current()))), 'false')]"
                                    }
                                  },
                                  "greater": 0
                                },
                                {
                                  "count": {
                                    "name": "ports",
                                    "value": "[parameters('ports')]",
                                    "where": {
                                      "count": {
                                        "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]",
                                        "where": {
                                          "equals": "true",
                                          "value": "[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]"
                                        }
                                      },
                                      "greater": 0
                                    }
                                  },
                                  "greater": 0
                                },
                                {
                                  "not": {
                                    "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]",
                                    "notEquals": "*"
                                  }
                                },
                                {
                                  "not": {
                                    "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]",
                                    "notIn": "[parameters('ports')]"
                                  }
                                }
                              ]
                            },
                            {
                              "anyOf": [
                                {
                                  "equals": "*",
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                                },
                                {
                                  "equals": "Internet",
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                                },
                                {
                                  "equals": "0.0.0.0/0",
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                                },
                                {
                                  "not": {
                                    "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]",
                                    "notEquals": "*"
                                  }
                                },
                                {
                                  "not": {
                                    "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]",
                                    "notEquals": "Internet"
                                  }
                                },
                                {
                                  "not": {
                                    "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]",
                                    "notEquals": "0.0.0.0/0"
                                  }
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/networkSecurityGroups",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Network/networkSecurityGroups/securityRules[*]",
                            "where": {
                              "allOf": [
                                {
                                  "equals": "Allow",
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].access"
                                },
                                {
                                  "equals": "Inbound",
                                  "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].direction"
                                },
                                {
                                  "anyOf": [
                                    {
                                      "equals": "*",
                                      "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange"
                                    },
                                    {
                                      "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange",
                                      "in": "[parameters('ports')]"
                                    },
                                    {
                                      "count": {
                                        "name": "ports",
                                        "value": "[parameters('ports')]",
                                        "where": {
                                          "equals": "true",
                                          "value": "[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports')))), 'false')]"
                                        }
                                      },
                                      "greater": 0
                                    },
                                    {
                                      "count": {
                                        "name": "ports",
                                        "value": "[parameters('ports')]",
                                        "where": {
                                          "count": {
                                            "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]",
                                            "where": {
                                              "equals": "true",
                                              "value": "[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]"
                                            }
                                          },
                                          "greater": 0
                                        }
                                      },
                                      "greater": 0
                                    },
                                    {
                                      "not": {
                                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]",
                                        "notEquals": "*"
                                      }
                                    },
                                    {
                                      "not": {
                                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]",
                                        "notIn": "[parameters('ports')]"
                                      }
                                    }
                                  ]
                                },
                                {
                                  "anyOf": [
                                    {
                                      "equals": "*",
                                      "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix"
                                    },
                                    {
                                      "equals": "Internet",
                                      "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix"
                                    },
                                    {
                                      "equals": "0.0.0.0/0",
                                      "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix"
                                    },
                                    {
                                      "not": {
                                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]",
                                        "notEquals": "*"
                                      }
                                    },
                                    {
                                      "not": {
                                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]",
                                        "notEquals": "Internet"
                                      }
                                    },
                                    {
                                      "not": {
                                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]",
                                        "notEquals": "0.0.0.0/0"
                                      }
                                    }
                                  ]
                                }
                              ]
                            }
                          },
                          "greater": 0
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MgmtPorts-From-Internet",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.3541944Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.3541944Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-mysql-http": {
            "properties": {
              "displayName": "MySQL database servers enforce SSL connections.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.3380478Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.DBforMySQL/servers",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.DBforMySQL/servers/sslEnforcement"
                        },
                        {
                          "field": "Microsoft.DBforMySQL/servers/sslEnforcement",
                          "notEquals": "Enabled"
                        },
                        {
                          "field": "Microsoft.DBforMySQL/servers/minimalTlsVersion",
                          "less": "[parameters('minimalTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-MySql-http",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.2869771Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.2869771Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-postgresql-http": {
            "properties": {
              "displayName": "PostgreSQL database servers enforce SSL connection.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.1461602Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version Azure Database for PostgreSQL server to enforce",
                    "displayName": "Select version minimum TLS for PostgreSQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.DBforPostgreSQL/servers",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.DBforPostgreSQL/servers/sslEnforcement"
                        },
                        {
                          "field": "Microsoft.DBforPostgreSQL/servers/sslEnforcement",
                          "notEquals": "Enabled"
                        },
                        {
                          "field": "Microsoft.DBforPostgreSQL/servers/minimalTlsVersion",
                          "notequals": "[parameters('minimalTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-PostgreSql-http",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.0563976Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.0563976Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-private-dns-zones": {
            "properties": {
              "displayName": "Deny the creation of private DNS",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.044079Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/privateDnsZones",
                  "field": "type"
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Private-DNS-Zones",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.9857748Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.9857748Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-mariadb": {
            "properties": {
              "displayName": "[Deprecated] Public network access should be disabled for MariaDB",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy denies the creation of Maria DB accounts with exposed public endpoints. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/fdccbe47-f3e3-4213-ad5d-ea459b2fa077.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.5205783Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.DBforMariaDB/servers",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.DBforMariaDB/servers/publicNetworkAccess",
                      "notequals": "Disabled"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-PublicEndpoint-MariaDB",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.4541225Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.4541225Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-publicip": {
            "properties": {
              "displayName": "[Deprecated] Deny the creation of public IP",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "[Deprecated] This policy denies creation of Public IPs under the assigned scope. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/6c112d4e-5bc7-47ae-a041-ea2d9dccd749.html using appropriate assignment parameters.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.8601679Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/publicIPAddresses",
                  "field": "type"
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-PublicIP",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.8289879Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.8289879Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-rdp-from-internet": {
            "properties": {
              "displayName": "[Deprecated] RDP access from the Internet should be blocked",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies any network security rule that allows RDP access from Internet. This policy is superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deny-MgmtPorts-From-Internet.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Deny-MgmtPorts-From-Internet",
                "version": "1.0.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.8407945Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/networkSecurityGroups/securityRules",
                      "field": "type"
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Allow",
                          "field": "Microsoft.Network/networkSecurityGroups/securityRules/access"
                        },
                        {
                          "equals": "Inbound",
                          "field": "Microsoft.Network/networkSecurityGroups/securityRules/direction"
                        },
                        {
                          "anyOf": [
                            {
                              "equals": "*",
                              "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"
                            },
                            {
                              "equals": "3389",
                              "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"
                            },
                            {
                              "equals": "true",
                              "value": "[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]"
                            },
                            {
                              "count": {
                                "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]",
                                "where": {
                                  "equals": "true",
                                  "value": "[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]"
                                }
                              },
                              "greater": 0
                            },
                            {
                              "not": {
                                "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]",
                                "notEquals": "*"
                              }
                            },
                            {
                              "not": {
                                "field": "Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]",
                                "notEquals": "3389"
                              }
                            }
                          ]
                        },
                        {
                          "anyOf": [
                            {
                              "equals": "*",
                              "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                            },
                            {
                              "equals": "Internet",
                              "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                            },
                            {
                              "not": {
                                "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]",
                                "notEquals": "*"
                              }
                            },
                            {
                              "not": {
                                "field": "Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]",
                                "notEquals": "Internet"
                              }
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-RDP-From-Internet",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.7555042Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.7555042Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-redis-http": {
            "properties": {
              "displayName": "Azure Cache for Redis only secure connections should be enabled",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cache",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.1925332Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "minimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select minimum TLS version for Azure Cache for Redis.",
                    "displayName": "Select minimum TLS version for Azure Cache for Redis."
                  },
                  "allowedValues": [
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Cache/redis",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Cache/Redis/enableNonSslPort"
                        },
                        {
                          "field": "Microsoft.Cache/Redis/minimumTlsVersion",
                          "less": "[parameters('minimumTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Redis-http",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.151026Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.151026Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-service-endpoints": {
            "properties": {
              "displayName": "Deny or Audit service endpoints on subnets",
              "policyType": "Custom",
              "mode": "All",
              "description": "This Policy will deny/audit Service Endpoints on subnets. Service Endpoints allows the network traffic to bypass Network appliances, such as the Azure Firewall.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.671798Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/virtualNetworks/subnets",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/virtualNetworks/subnets/serviceEndpoints[*]",
                        "where": {
                          "exists": true,
                          "field": "Microsoft.Network/virtualNetworks/subnets/serviceEndpoints[*].service"
                        }
                      },
                      "greater": 0
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Service-Endpoints",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.5490077Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.5490077Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-sql-mintls": {
            "properties": {
              "displayName": "Azure SQL Database should have the minimal TLS version set to the highest version",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:01.4046261Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version SQL servers to enforce",
                    "displayName": "Select version for SQL server"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Sql/servers",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Sql/servers/minimalTlsVersion"
                        },
                        {
                          "field": "Microsoft.Sql/servers/minimalTlsVersion",
                          "less": "[parameters('minimalTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Sql-minTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:01.3408494Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:01.3408494Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-sqlmi-mintls": {
            "properties": {
              "displayName": "SQL Managed Instance should have the minimal TLS version set to the highest version",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.5956153Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version SQL servers to enforce",
                    "displayName": "Select version for SQL server"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Sql/managedInstances",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Sql/managedInstances/minimalTlsVersion"
                        },
                        {
                          "field": "Microsoft.Sql/managedInstances/minimalTlsVersion",
                          "less": "[parameters('minimalTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-SqlMi-minTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.5389234Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.5389234Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-containerdeleteretentionpolicy": {
            "properties": {
              "displayName": "Storage Accounts should use a container delete retention policy",
              "policyType": "Custom",
              "mode": "All",
              "description": "Enforce container delete retention policies larger than seven days for storage account. Enable this for increased data loss protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.4117558Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "minContainerDeleteRetentionInDays": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Specifies the minimum number of days for the container delete retention policy",
                    "displayName": "Minimum Container Delete Retention in Days"
                  },
                  "defaultValue": 7
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts/blobServices",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": false,
                          "field": "Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.enabled"
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.enabled",
                          "notEquals": true
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.days",
                          "less": "[parameters('minContainerDeleteRetentionInDays')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-ContainerDeleteRetentionPolicy",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.3920274Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.3920274Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-copyscope": {
            "properties": {
              "displayName": "Allowed Copy scope should be restricted for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should restrict the allowed copy scope. Enforce this for increased data exfiltration protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.2729331Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedCopyScope": {
                  "type": "String",
                  "metadata": {
                    "description": "Specify the allowed copy scope.",
                    "displayName": "Allowed Copy Scope"
                  },
                  "allowedValues": [
                    "AAD",
                    "PrivateLink"
                  ],
                  "defaultValue": "AAD"
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Storage/storageAccounts/allowedCopyScope"
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/allowedCopyScope",
                          "notEquals": "[parameters('allowedCopyScope')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-CopyScope",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.1520763Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.1520763Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-corsrules": {
            "properties": {
              "displayName": "Storage Accounts should restrict CORS rules",
              "policyType": "Custom",
              "mode": "All",
              "description": "Deny CORS rules for storage account for increased data exfiltration protection and endpoint protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.9020095Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Storage/storageAccounts/blobServices",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Storage/storageAccounts/blobServices/cors.corsRules[*]"
                          },
                          "greater": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Storage/storageAccounts/fileServices",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Storage/storageAccounts/fileServices/cors.corsRules[*]"
                          },
                          "greater": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Storage/storageAccounts/tableServices",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Storage/storageAccounts/tableServices/cors.corsRules[*]"
                          },
                          "greater": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Storage/storageAccounts/queueServices",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Storage/storageAccounts/queueServices/cors.corsRules[*]"
                          },
                          "greater": 0
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-CorsRules",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.8201346Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.8201346Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-localuser": {
            "properties": {
              "displayName": "Local users should be restricted for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should disable local users for features like SFTP. Enforce this for increased data exfiltration protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.2916528Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Storage/storageAccounts/isLocalUserEnabled"
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/isLocalUserEnabled",
                          "notEquals": false
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-LocalUser",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.2280331Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.2280331Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-mintls": {
            "properties": {
              "displayName": "[Deprecated] Storage Account set to minimum TLS and Secure transfer should be enabled",
              "policyType": "Custom",
              "mode": "All",
              "description": "Audit requirement of Secure transfer in your storage account. This policy is superseded by https://www.azadvertizer.net/azpolicyadvertizer/fe83a0eb-a853-422d-aac2-1bffd182c5d0.html and https://www.azadvertizer.net/azpolicyadvertizer/404c3081-a854-4457-ae30-26a93ef643f9.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "fe83a0eb-a853-422d-aac2-1bffd182c5d0,404c3081-a854-4457-ae30-26a93ef643f9",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.218643Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "minimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version on Azure Storage Account to enforce",
                    "displayName": "Storage Account select minimum TLS version"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_1",
                    "TLS1_0"
                  ],
                  "defaultValue": "TLS1_2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "allOf": [
                            {
                              "less": "2019-04-01",
                              "value": "[requestContext().apiVersion]"
                            },
                            {
                              "exists": "false",
                              "field": "Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly"
                            }
                          ]
                        },
                        {
                          "equals": "false",
                          "field": "Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly"
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/minimumTlsVersion",
                          "notequals": "[parameters('minimumTlsVersion')]"
                        },
                        {
                          "exists": "false",
                          "field": "Microsoft.Storage/storageAccounts/minimumTlsVersion"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-minTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.1608646Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.1608646Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-networkaclsbypass": {
            "properties": {
              "displayName": "Network ACL bypass option should be restricted for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should restrict the bypass option for service-level network ACLs. Enforce this for increased data exfiltration protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.3269044Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedBypassOptions": {
                  "type": "Array",
                  "metadata": {
                    "description": "Specifies which options are allowed to bypass the vnet configuration",
                    "displayName": "Allowed Bypass Options"
                  },
                  "allowedValues": [
                    "None",
                    "Logging",
                    "Metrics",
                    "AzureServices",
                    "Logging, Metrics",
                    "Logging, AzureServices",
                    "Metrics, AzureServices",
                    "Logging, Metrics, AzureServices",
                    "Logging, Metrics, AzureServices"
                  ],
                  "defaultValue": [
                    "Logging",
                    "Metrics",
                    "AzureServices",
                    "Logging, Metrics",
                    "Logging, AzureServices",
                    "Metrics, AzureServices",
                    "Logging, Metrics, AzureServices",
                    "Logging, Metrics, AzureServices"
                  ]
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "false",
                          "field": "Microsoft.Storage/storageAccounts/networkAcls.bypass"
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/networkAcls.bypass",
                          "notIn": "[parameters('allowedBypassOptions')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-NetworkAclsBypass",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.1609173Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.1609173Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-networkaclsvirtualnetworkrules": {
            "properties": {
              "displayName": "Virtual network rules should be restricted for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should restrict the virtual network service-level network ACLs. Enforce this for increased data exfiltration protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.4453835Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Storage/storageAccounts/networkAcls.virtualNetworkRules[*]"
                      },
                      "greater": 0
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-NetworkAclsVirtualNetworkRules",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.3798351Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.3798351Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-resourceaccessrulesresourceid": {
            "properties": {
              "displayName": "Resource Access Rules resource IDs should be restricted for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should restrict the resource access rule for service-level network ACLs to services from a specific Azure subscription. Enforce this for increased data exfiltration protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.4943411Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]"
                      },
                      "greater": 0
                    },
                    {
                      "count": {
                        "field": "Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]",
                        "where": {
                          "equals": "*",
                          "value": "[split(current('Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*].resourceId'), '/')[2]]"
                        }
                      },
                      "greater": 0
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-ResourceAccessRulesResourceId",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.1738855Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.1738855Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-resourceaccessrulestenantid": {
            "properties": {
              "displayName": "Resource Access Rules Tenants should be restricted for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should restrict the resource access rule for service-level network ACLs to service from the same AAD tenant. Enforce this for increased data exfiltration protection.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.2148665Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]"
                      },
                      "greater": 0
                    },
                    {
                      "field": "Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*].tenantId",
                      "notEquals": "[subscription().tenantId]"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-ResourceAccessRulesTenantId",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.129698Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.129698Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-servicesencryption": {
            "properties": {
              "displayName": "Encryption for storage services should be enforced for Storage Accounts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Azure Storage accounts should enforce encryption for all storage services. Enforce this for increased encryption scope.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.1812302Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "anyOf": [
                            {
                              "exists": "false",
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.blob.enabled"
                            },
                            {
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.blob.enabled",
                              "notEquals": true
                            }
                          ]
                        },
                        {
                          "anyOf": [
                            {
                              "exists": "false",
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.file.enabled"
                            },
                            {
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.file.enabled",
                              "notEquals": true
                            }
                          ]
                        },
                        {
                          "anyOf": [
                            {
                              "exists": "false",
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.queue.keyType"
                            },
                            {
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.queue.keyType",
                              "notEquals": "Account"
                            }
                          ]
                        },
                        {
                          "anyOf": [
                            {
                              "exists": "false",
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.table.keyType"
                            },
                            {
                              "field": "Microsoft.Storage/storageAccounts/encryption.services.table.keyType",
                              "notEquals": "Account"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-ServicesEncryption",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.1460758Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.1460758Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storage-sftp": {
            "properties": {
              "displayName": "Storage Accounts with SFTP enabled should be denied",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This policy denies the creation of Storage Accounts with SFTP enabled for Blob Storage.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.5393086Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "equals": "true",
                      "field": "Microsoft.Storage/storageAccounts/isSftpEnabled"
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Storage-SFTP",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.5124599Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.5124599Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-storageaccount-customdomain": {
            "properties": {
              "displayName": "Storage Accounts with custom domains assigned should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of Storage Accounts with custom domains assigned as communication cannot be encrypted, and always uses HTTP.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:53.5492954Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "exists": "true",
                          "field": "Microsoft.Storage/storageAccounts/customDomain"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Storage/storageAccounts/customDomain.useSubDomainName"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-StorageAccount-CustomDomain",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:53.4935706Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:53.4935706Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-subnet-without-nsg": {
            "properties": {
              "displayName": "Subnets should have a Network Security Group",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.0985226Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "excludedSubnets": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of subnet names that are excluded from this policy",
                    "displayName": "Excluded Subnets"
                  },
                  "defaultValue": [
                    "GatewaySubnet",
                    "AzureFirewallSubnet",
                    "AzureFirewallManagementSubnet"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Network/virtualNetworks/subnets[*]",
                            "where": {
                              "allOf": [
                                {
                                  "exists": "false",
                                  "field": "Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id"
                                },
                                {
                                  "field": "Microsoft.Network/virtualNetworks/subnets[*].name",
                                  "notIn": "[parameters('excludedSubnets')]"
                                }
                              ]
                            }
                          },
                          "notEquals": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks/subnets",
                          "field": "type"
                        },
                        {
                          "field": "name",
                          "notIn": "[parameters('excludedSubnets')]"
                        },
                        {
                          "exists": "false",
                          "field": "Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Subnet-Without-Nsg",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.0523714Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.0523714Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-subnet-without-penp": {
            "properties": {
              "displayName": "Subnets without Private Endpoint Network Policies enabled should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of a subnet without Private Endpoint Netwotk Policies enabled. This policy is intended for 'workload' subnets, not 'central infrastructure' (aka, 'hub') subnets.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.5161622Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "excludedSubnets": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of subnet names that are excluded from this policy",
                    "displayName": "Excluded Subnets"
                  },
                  "defaultValue": [
                    "GatewaySubnet",
                    "AzureFirewallSubnet",
                    "AzureFirewallManagementSubnet",
                    "AzureBastionSubnet"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Network/virtualNetworks/subnets[*]",
                            "where": {
                              "allOf": [
                                {
                                  "field": "Microsoft.Network/virtualNetworks/subnets[*].privateEndpointNetworkPolicies",
                                  "notEquals": "Enabled"
                                },
                                {
                                  "field": "Microsoft.Network/virtualNetworks/subnets[*].name",
                                  "notIn": "[parameters('excludedSubnets')]"
                                }
                              ]
                            }
                          },
                          "notEquals": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks/subnets",
                          "field": "type"
                        },
                        {
                          "field": "name",
                          "notIn": "[parameters('excludedSubnets')]"
                        },
                        {
                          "field": "Microsoft.Network/virtualNetworks/subnets/privateEndpointNetworkPolicies",
                          "notEquals": "Enabled"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Subnet-Without-Penp",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.4613463Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.4613463Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-subnet-without-udr": {
            "properties": {
              "displayName": "Subnets should have a User Defined Route",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of a subnet without a User Defined Route (UDR).",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.232314Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "excludedSubnets": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of subnet names that are excluded from this policy",
                    "displayName": "Excluded Subnets"
                  },
                  "defaultValue": [
                    "AzureBastionSubnet"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Network/virtualNetworks/subnets[*]",
                            "where": {
                              "allOf": [
                                {
                                  "exists": "false",
                                  "field": "Microsoft.Network/virtualNetworks/subnets[*].routeTable.id"
                                },
                                {
                                  "field": "Microsoft.Network/virtualNetworks/subnets[*].name",
                                  "notIn": "[parameters('excludedSubnets')]"
                                }
                              ]
                            }
                          },
                          "notEquals": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks/subnets",
                          "field": "type"
                        },
                        {
                          "field": "name",
                          "notIn": "[parameters('excludedSubnets')]"
                        },
                        {
                          "exists": "false",
                          "field": "Microsoft.Network/virtualNetworks/subnets/routeTable.id"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-Subnet-Without-Udr",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.20397Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.20397Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-udr-with-specific-nexthop": {
            "properties": {
              "displayName": "User Defined Routes with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway' should be denied",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of a User Defined Route with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway'.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.4204635Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "excludedDestinations": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of route destinations that are to be denied",
                    "displayName": "Excluded Destinations"
                  },
                  "defaultValue": [
                    "Internet",
                    "VirtualNetworkGateway"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/routeTables",
                          "field": "type"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Network/routeTables/routes[*]",
                            "where": {
                              "field": "Microsoft.Network/routeTables/routes[*].nextHopType",
                              "in": "[parameters('excludedDestinations')]"
                            }
                          },
                          "notEquals": 0
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/routeTables/routes",
                          "field": "type"
                        },
                        {
                          "field": "Microsoft.Network/routeTables/routes/nextHopType",
                          "in": "[parameters('excludedDestinations')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-UDR-With-Specific-NextHop",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.3118188Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.3118188Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-vnet-peer-cross-sub": {
            "properties": {
              "displayName": "Deny vNet peering cross subscription.",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.3784827Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedVnets": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}",
                    "displayName": "Allowed vNets to peer with"
                  },
                  "defaultValue": []
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "field": "type"
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id",
                          "notIn": "[parameters('allowedVnets')]"
                        },
                        {
                          "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id",
                          "notLike": "[concat(subscription().id, '/*')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-VNET-Peer-Cross-Sub",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.2417752Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.2417752Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-vnet-peering": {
            "properties": {
              "displayName": "Deny vNet peering ",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of vNet Peerings under the assigned scope.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.7384683Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                  "field": "type"
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-VNet-Peering",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.6773554Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.6773554Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deny-vnet-peering-to-non-approved-vnets": {
            "properties": {
              "displayName": "Deny vNet peering to non-approved vNets",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.7577206Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "allowedVnets": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}",
                    "displayName": "Allowed vNets to peer with"
                  },
                  "defaultValue": []
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                          "field": "type"
                        },
                        {
                          "not": {
                            "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id",
                            "in": "[parameters('allowedVnets')]"
                          }
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "equals": "Microsoft.Network/virtualNetworks",
                          "field": "type"
                        },
                        {
                          "not": {
                            "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id",
                            "in": "[parameters('allowedVnets')]"
                          }
                        },
                        {
                          "not": {
                            "exists": false,
                            "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id"
                          }
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deny-VNET-Peering-To-Non-Approved-VNETs",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.7106947Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.7106947Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/denyaction-activitylogs": {
            "properties": {
              "displayName": "DenyAction implementation on Activity Logs",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "This is a DenyAction implementation policy on Activity Logs.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": false,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.5516031Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {},
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Resources/subscriptions/providers/diagnosticSettings",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "actionNames": [
                      "delete"
                    ]
                  },
                  "effect": "denyAction"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DenyAction-ActivityLogs",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.5103651Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.5103651Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/denyaction-deleteresources": {
            "properties": {
              "displayName": "Do not allow deletion of specified resource and resource type",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy enables you to specify the resource and resource type that your organization can protect from accidentals deletion by blocking delete calls using the deny action effect.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "General",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.6925618Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DenyAction",
                    "Disabled"
                  ],
                  "defaultValue": "DenyAction"
                },
                "resourceName": {
                  "type": "String",
                  "metadata": {
                    "description": "Provide the name of the resource that you want to protect from accidental deletion.",
                    "displayName": "Resource Name"
                  }
                },
                "resourceType": {
                  "type": "String",
                  "metadata": {
                    "description": "Provide the resource type that you want to protect from accidental deletion.",
                    "displayName": "Resource Type"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "[parameters('resourceType')]",
                      "field": "type"
                    },
                    {
                      "field": "name",
                      "like": "[parameters('resourceName')]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "actionNames": [
                      "delete"
                    ]
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DenyAction-DeleteResources",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.6497959Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.6497959Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/denyaction-diagnosticlogs": {
            "properties": {
              "displayName": "DenyAction implementation on Diagnostic Logs.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "DenyAction implementation on Diagnostic Logs.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": false,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.1551369Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {},
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Insights/diagnosticSettings",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "actionNames": [
                      "delete"
                    ]
                  },
                  "effect": "denyAction"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DenyAction-DiagnosticLogs",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.094353Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.094353Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-asc-securitycontacts": {
            "properties": {
              "displayName": "Deploy Microsoft Defender for Cloud Security Contacts",
              "policyType": "Custom",
              "mode": "All",
              "description": "Deploy Microsoft Defender for Cloud Security Contacts",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Security Center",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:53.147027Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "emailSecurityContact": {
                  "type": "String",
                  "metadata": {
                    "description": "Provide email addresses (semi-colon separated) for Defender for Cloud contact details",
                    "displayName": "Security contacts email address"
                  }
                },
                "minimalSeverity": {
                  "type": "String",
                  "metadata": {
                    "description": "Defines the minimal alert severity which will be sent as email notifications",
                    "displayName": "Minimal severity"
                  },
                  "allowedValues": [
                    "High",
                    "Medium",
                    "Low"
                  ],
                  "defaultValue": "High"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Resources/subscriptions",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "northeurope",
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "emailSecurityContact": {
                            "value": "[parameters('emailSecurityContact')]"
                          },
                          "minimalSeverity": {
                            "value": "[parameters('minimalSeverity')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "emailSecurityContact": {
                              "metadata": {
                                "description": "Security contacts email address"
                              },
                              "type": "string"
                            },
                            "minimalSeverity": {
                              "metadata": {
                                "description": "Minimal severity level reported"
                              },
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2023-12-01-preview",
                              "name": "default",
                              "properties": {
                                "emails": "[parameters('emailSecurityContact')]",
                                "isEnabled": true,
                                "notificationsByRole": {
                                  "roles": [
                                    "Owner"
                                  ],
                                  "state": "On"
                                },
                                "notificationsSources": [
                                  {
                                    "minimalSeverity": "[parameters('minimalSeverity')]",
                                    "sourceType": "Alert"
                                  }
                                ]
                              },
                              "type": "Microsoft.Security/securityContacts"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "contains": "[parameters('emailSecurityContact')]",
                          "field": "Microsoft.Security/securityContacts/email"
                        },
                        {
                          "equals": true,
                          "field": "Microsoft.Security/securityContacts/isEnabled"
                        },
                        {
                          "contains": "[parameters('minimalSeverity')]",
                          "field": "Microsoft.Security/securityContacts/notificationsSources[*].Alert.minimalSeverity"
                        }
                      ]
                    },
                    "existenceScope": "subscription",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
                    ],
                    "type": "Microsoft.Security/securityContacts"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-ASC-SecurityContacts",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:53.0905109Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:53.0905109Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-budget": {
            "properties": {
              "displayName": "Deploy a default budget on all subscriptions under the assigned scope",
              "policyType": "Custom",
              "mode": "All",
              "description": "Deploy a default budget on all subscriptions under the assigned scope",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureUSGovernment"
                ],
                "category": "Budget",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.6160399Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "amount": {
                  "type": "String",
                  "metadata": {
                    "description": "The total amount of cost or usage to track with the budget"
                  },
                  "defaultValue": "1000"
                },
                "budgetName": {
                  "type": "String",
                  "metadata": {
                    "description": "The name for the budget to be created"
                  },
                  "defaultValue": "budget-set-by-policy"
                },
                "contactEmails": {
                  "type": "Array",
                  "metadata": {
                    "description": "The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded."
                  },
                  "defaultValue": []
                },
                "contactGroups": {
                  "type": "Array",
                  "metadata": {
                    "description": "The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings."
                  },
                  "defaultValue": []
                },
                "contactRoles": {
                  "type": "Array",
                  "metadata": {
                    "description": "The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded."
                  },
                  "defaultValue": [
                    "Owner",
                    "Contributor"
                  ]
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "firstThreshold": {
                  "type": "String",
                  "metadata": {
                    "description": "Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000."
                  },
                  "defaultValue": "90"
                },
                "secondThreshold": {
                  "type": "String",
                  "metadata": {
                    "description": "Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000."
                  },
                  "defaultValue": "100"
                },
                "timeGrain": {
                  "type": "String",
                  "metadata": {
                    "description": "The time covered by a budget. Tracking of the amount will be reset based on the time grain."
                  },
                  "allowedValues": [
                    "Monthly",
                    "Quarterly",
                    "Annually",
                    "BillingMonth",
                    "BillingQuarter",
                    "BillingAnnual"
                  ],
                  "defaultValue": "Monthly"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Resources/subscriptions",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "northeurope",
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "amount": {
                            "value": "[parameters('amount')]"
                          },
                          "budgetName": {
                            "value": "[parameters('budgetName')]"
                          },
                          "contactEmails": {
                            "value": "[parameters('contactEmails')]"
                          },
                          "contactGroups": {
                            "value": "[parameters('contactGroups')]"
                          },
                          "contactRoles": {
                            "value": "[parameters('contactRoles')]"
                          },
                          "firstThreshold": {
                            "value": "[parameters('firstThreshold')]"
                          },
                          "secondThreshold": {
                            "value": "[parameters('secondThreshold')]"
                          },
                          "timeGrain": {
                            "value": "[parameters('timeGrain')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "amount": {
                              "type": "String"
                            },
                            "budgetName": {
                              "type": "String"
                            },
                            "contactEmails": {
                              "type": "Array"
                            },
                            "contactGroups": {
                              "type": "Array"
                            },
                            "contactRoles": {
                              "type": "Array"
                            },
                            "firstThreshold": {
                              "type": "String"
                            },
                            "secondThreshold": {
                              "type": "String"
                            },
                            "startDate": {
                              "defaultValue": "[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]",
                              "type": "String"
                            },
                            "timeGrain": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2019-10-01",
                              "name": "[parameters('budgetName')]",
                              "properties": {
                                "amount": "[parameters('amount')]",
                                "category": "Cost",
                                "notifications": {
                                  "NotificationForExceededBudget1": {
                                    "contactEmails": "[parameters('contactEmails')]",
                                    "contactGroups": "[parameters('contactGroups')]",
                                    "contactRoles": "[parameters('contactRoles')]",
                                    "enabled": true,
                                    "operator": "GreaterThan",
                                    "threshold": "[parameters('firstThreshold')]"
                                  },
                                  "NotificationForExceededBudget2": {
                                    "contactEmails": "[parameters('contactEmails')]",
                                    "contactGroups": "[parameters('contactGroups')]",
                                    "contactRoles": "[parameters('contactRoles')]",
                                    "enabled": true,
                                    "operator": "GreaterThan",
                                    "threshold": "[parameters('secondThreshold')]"
                                  }
                                },
                                "timeGrain": "[parameters('timeGrain')]",
                                "timePeriod": {
                                  "startDate": "[parameters('startDate')]"
                                }
                              },
                              "type": "Microsoft.Consumption/budgets"
                            }
                          ]
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('amount')]",
                          "field": "Microsoft.Consumption/budgets/amount"
                        },
                        {
                          "equals": "[parameters('timeGrain')]",
                          "field": "Microsoft.Consumption/budgets/timeGrain"
                        },
                        {
                          "equals": "Cost",
                          "field": "Microsoft.Consumption/budgets/category"
                        }
                      ]
                    },
                    "existenceScope": "subscription",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Consumption/budgets"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Budget",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.5672012Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.5672012Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-custom-route-table": {
            "properties": {
              "displayName": "Deploy a route table with specific user defined routes",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.925441Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "disableBgpPropagation": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "Disable BGP Propagation",
                    "displayName": "DisableBgpPropagation"
                  },
                  "defaultValue": false
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "requiredRoutes": {
                  "type": "Array",
                  "metadata": {
                    "description": "Routes that must exist in compliant route tables deployed by this policy",
                    "displayName": "requiredRoutes"
                  }
                },
                "routeTableName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the route table automatically deployed by this policy",
                    "displayName": "routeTableName"
                  }
                },
                "vnetRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Only VNets in this region will be evaluated against this policy",
                    "displayName": "vnetRegion"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/virtualNetworks",
                      "field": "type"
                    },
                    {
                      "equals": "[parameters('vnetRegion')]",
                      "field": "location"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "disableBgpPropagation": {
                            "value": "[parameters('disableBgpPropagation')]"
                          },
                          "requiredRoutes": {
                            "value": "[parameters('requiredRoutes')]"
                          },
                          "routeTableName": {
                            "value": "[parameters('routeTableName')]"
                          },
                          "vnetRegion": {
                            "value": "[parameters('vnetRegion')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "disableBgpPropagation": {
                              "type": "bool"
                            },
                            "requiredRoutes": {
                              "type": "array"
                            },
                            "routeTableName": {
                              "type": "string"
                            },
                            "vnetRegion": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2021-04-01",
                              "name": "routeTableDepl",
                              "properties": {
                                "mode": "Incremental",
                                "parameters": {
                                  "disableBgpPropagation": {
                                    "value": "[parameters('disableBgpPropagation')]"
                                  },
                                  "requiredRoutes": {
                                    "value": "[parameters('requiredRoutes')]"
                                  },
                                  "routeTableName": {
                                    "value": "[parameters('routeTableName')]"
                                  },
                                  "vnetRegion": {
                                    "value": "[parameters('vnetRegion')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "disableBgpPropagation": {
                                      "type": "bool"
                                    },
                                    "requiredRoutes": {
                                      "type": "array"
                                    },
                                    "routeTableName": {
                                      "type": "string"
                                    },
                                    "vnetRegion": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2021-02-01",
                                      "location": "[[parameters('vnetRegion')]",
                                      "name": "[[parameters('routeTableName')]",
                                      "properties": {
                                        "copy": "[variables('copyLoop')]",
                                        "disableBgpRoutePropagation": "[[parameters('disableBgpPropagation')]"
                                      },
                                      "type": "Microsoft.Network/routeTables"
                                    }
                                  ]
                                }
                              },
                              "type": "Microsoft.Resources/deployments"
                            }
                          ],
                          "variables": {
                            "copyLoop": [
                              {
                                "count": "[[length(parameters('requiredRoutes'))]",
                                "input": {
                                  "name": "[[concat('route-',copyIndex('routes'))]",
                                  "properties": {
                                    "addressPrefix": "[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]",
                                    "nextHopIpAddress": "[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]",
                                    "nextHopType": "[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]"
                                  }
                                },
                                "name": "routes"
                              }
                            ]
                          }
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('routeTableName')]",
                          "field": "name"
                        },
                        {
                          "count": {
                            "field": "Microsoft.Network/routeTables/routes[*]",
                            "where": {
                              "in": "[parameters('requiredRoutes')]",
                              "value": "[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]"
                            }
                          },
                          "equals": "[length(parameters('requiredRoutes'))]"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/routeTables"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Custom-Route-Table",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.8572415Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.8572415Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-ddosprotection": {
            "properties": {
              "displayName": "Deploy an Azure DDoS Network Protection",
              "policyType": "Custom",
              "mode": "All",
              "description": "Deploys an Azure DDoS Network Protection",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.0592384Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "ddosName": {
                  "type": "String",
                  "metadata": {
                    "description": "DDoSVnet",
                    "displayName": "ddosName"
                  }
                },
                "ddosRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "DDoSVnet location",
                    "displayName": "ddosRegion",
                    "strongType": "location"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "rgName": {
                  "type": "String",
                  "metadata": {
                    "description": "Provide name for resource group.",
                    "displayName": "rgName"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Resources/subscriptions",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "northeurope",
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "ddosname": {
                            "value": "[parameters('ddosname')]"
                          },
                          "ddosregion": {
                            "value": "[parameters('ddosRegion')]"
                          },
                          "rgName": {
                            "value": "[parameters('rgName')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "ddosRegion": {
                              "type": "String"
                            },
                            "ddosname": {
                              "type": "String"
                            },
                            "rgName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2018-05-01",
                              "location": "[deployment().location]",
                              "name": "[parameters('rgName')]",
                              "properties": {},
                              "type": "Microsoft.Resources/resourceGroups"
                            },
                            {
                              "apiVersion": "2018-05-01",
                              "dependsOn": [
                                "[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]"
                              ],
                              "name": "ddosprotection",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json",
                                  "contentVersion": "1.0.0.0",
                                  "outputs": {},
                                  "parameters": {},
                                  "resources": [
                                    {
                                      "apiVersion": "2019-12-01",
                                      "location": "[parameters('ddosRegion')]",
                                      "name": "[parameters('ddosName')]",
                                      "properties": {},
                                      "type": "Microsoft.Network/ddosProtectionPlans"
                                    }
                                  ]
                                }
                              },
                              "resourceGroup": "[parameters('rgName')]",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ]
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceScope": "resourceGroup",
                    "name": "[parameters('ddosName')]",
                    "resourceGroupName": "[parameters('rgName')]",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/ddosProtectionPlans"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-DDoSProtection",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.9898455Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.9898455Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-aa": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Automation to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.8647464Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Automation/automationAccounts",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "JobLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "JobStreams",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DscNodeStatus",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AuditEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Automation/automationAccounts/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-AA",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.7796474Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.7796474Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-aci": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.5198904Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.ContainerInstance/containerGroups",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-ACI",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.3853614Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.3853614Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-acr": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.1842642Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.ContainerRegistry/registries",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "ContainerRegistryLoginEvents",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ContainerRegistryRepositoryEvents",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.ContainerRegistry/registries/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-ACR",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.1303935Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.1303935Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-analysisservice": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.8442814Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.AnalysisServices/servers",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Engine",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Service",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.AnalysisServices/servers/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-AnalysisService",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.7859567Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.7859567Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-apiforfhir": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.7433592Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.HealthcareApis/services",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "AuditLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.HealthcareApis/services/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-ApiForFHIR",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.6657872Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.6657872Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-apimgmt": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for API Management to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:53.1388316Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logAnalyticsDestinationType": {
                  "type": "String",
                  "metadata": {
                    "description": "Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'",
                    "displayName": "Log Analytics destination type"
                  },
                  "allowedValues": [
                    "AzureDiagnostics",
                    "Dedicated"
                  ],
                  "defaultValue": "AzureDiagnostics"
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.ApiManagement/service",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logAnalyticsDestinationType": {
                            "value": "[parameters('logAnalyticsDestinationType')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logAnalyticsDestinationType": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logAnalyticsDestinationType": "[parameters('logAnalyticsDestinationType')]",
                                "logs": [
                                  {
                                    "category": "GatewayLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "WebSocketConnectionLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.ApiManagement/service/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-APIMgmt",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:53.1110582Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:53.1110582Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-applicationgateway": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.0542932Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/applicationGateways",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "ApplicationGatewayAccessLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ApplicationGatewayPerformanceLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ApplicationGatewayFirewallLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/applicationGateways/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-ApplicationGateway",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.0165369Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.0165369Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-avdscalingplans": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.6678411Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DesktopVirtualization/scalingplans",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Autoscale",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-AVDScalingPlans",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.6115001Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.6115001Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-bastion": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.3220309Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/bastionHosts",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "BastionAuditLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/bastionHosts/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-Bastion",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.2222162Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.2222162Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-cdnendpoints": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.033049Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Cdn/profiles/endpoints",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('fullName')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "CoreAnalytics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-CDNEndpoints",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.9259372Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.9259372Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-cognitiveservices": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.977218Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.CognitiveServices/accounts",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Audit",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "RequestResponse",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Trace",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.CognitiveServices/accounts/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-CognitiveServices",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.9228482Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.9228482Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-cosmosdb": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.9634992Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DocumentDB/databaseAccounts",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "DataPlaneRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "MongoRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "QueryRuntimeStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "PartitionKeyStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "PartitionKeyRUConsumption",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ControlPlaneRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "CassandraRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "GremlinRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TableApiRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "Requests",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-CosmosDB",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.9109377Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.9109377Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-databricks": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.3.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.7353382Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Databricks/workspaces",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "dbfs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "clusters",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "accounts",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "jobs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "notebook",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ssh",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "workspace",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "secrets",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "sqlPermissions",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "instancePools",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "sqlanalytics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "genie",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "globalInitScripts",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "iamRole",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "mlflowExperiment",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "featureStore",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "RemoteHistoryService",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "mlflowAcledArtifact",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "databrickssql",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "deltaPipelines",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "modelRegistry",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "repos",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "unityCatalog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "gitCredentials",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "webTerminal",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "serverlessRealTimeInference",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "clusterLibraries",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "partnerHub",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "clamAVScan",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "capsule8Dataplane",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Databricks/workspaces/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-Databricks",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.7078486Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.7078486Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-dataexplorercluster": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.0836324Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Kusto/Clusters",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "SucceededIngestion",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "FailedIngestion",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "IngestionBatching",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Command",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Query",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TableUsageStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TableDetails",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Kusto/Clusters/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-DataExplorerCluster",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.8733213Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.8733213Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-datafactory": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.1269326Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DataFactory/factories",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "ActivityRuns",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "PipelineRuns",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TriggerRuns",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SSISPackageEventMessages",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SSISPackageExecutableStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SSISPackageEventMessageContext",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SSISPackageExecutionComponentPhases",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SSISPackageExecutionDataStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SSISIntegrationRuntimeLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SandboxPipelineRuns",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SandboxActivityRuns",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DataFactory/factories/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-DataFactory",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.0107636Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.0107636Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-dlanalytics": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.8109171Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DataLakeAnalytics/accounts",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Audit",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Requests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-DLAnalytics",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.7859397Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.7859397Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventgridsub": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.3280168Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.EventGrid/eventSubscriptions",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-EventGridSub",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.2796167Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.2796167Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventgridsystemtopic": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.6467192Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.EventGrid/systemTopics",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "DeliveryFailures",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.EventGrid/systemTopics/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-EventGridSystemTopic",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.6043115Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.6043115Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventgridtopic": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:01.4701544Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.EventGrid/topics",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "DeliveryFailures",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "PublishFailures",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataPlaneRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.EventGrid/topics/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-EventGridTopic",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:01.3376981Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:01.3376981Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-expressroute": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.9676414Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/expressRouteCircuits",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "PeeringRouteLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-ExpressRoute",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.9007438Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.9007438Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-firewall": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.456424Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logAnalyticsDestinationType": {
                  "type": "String",
                  "metadata": {
                    "description": "Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'",
                    "displayName": "Log Analytics destination type"
                  },
                  "allowedValues": [
                    "AzureDiagnostics",
                    "Dedicated"
                  ],
                  "defaultValue": "AzureDiagnostics"
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/azureFirewalls",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logAnalyticsDestinationType": {
                            "value": "[parameters('logAnalyticsDestinationType')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logAnalyticsDestinationType": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logAnalyticsDestinationType": "[parameters('logAnalyticsDestinationType')]",
                                "logs": [
                                  {
                                    "category": "AzureFirewallApplicationRule",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AzureFirewallNetworkRule",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AzureFirewallDnsProxy",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWNetworkRule",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWApplicationRule",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWNatRule",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWThreatIntel",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWIdpsSignature",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWDnsQuery",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWFqdnResolveFailure",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWApplicationRuleAggregation",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWNetworkRuleAggregation",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWNatRuleAggregation",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWFatFlow",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AZFWFlowTrace",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/azureFirewalls/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-Firewall",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.4118232Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.4118232Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-frontdoor": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.8215955Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/frontDoors",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "FrontdoorAccessLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "FrontdoorWebApplicationFirewallLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/frontDoors/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-FrontDoor",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.7436444Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.7436444Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-function": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.9944812Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "contains": "functionapp",
                      "value": "[field('kind')]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "FunctionAppLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Web/sites/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-Function",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.9432596Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.9432596Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-hdinsight": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.9726113Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.HDInsight/clusters",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.HDInsight/clusters/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-HDInsight",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.9368434Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.9368434Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-iothub": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.2352265Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Devices/IotHubs",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Connections",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DeviceTelemetry",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "C2DCommands",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DeviceIdentityOperations",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "FileUploadOperations",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Routes",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "D2CTwinOperations",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "C2DTwinOperations",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TwinQueries",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "JobsOperations",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DirectMethods",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DistributedTracing",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Configurations",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DeviceStreams",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Devices/IotHubs/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-iotHub",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.192223Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.192223Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-loadbalancer": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.2224774Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/loadBalancers",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "LoadBalancerAlertEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "LoadBalancerProbeHealthStatus",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/loadBalancers/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-LoadBalancer",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.1774315Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.1774315Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-loganalytics": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Log Analytics workspaces to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.7497938Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "microsoft.operationalinsights/workspaces",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Audit",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "microsoft.operationalinsights/workspaces/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.3484424Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.3484424Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-logicappsise": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.3206059Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Logic/integrationAccounts",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "IntegrationAccountTrackingEvents",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Logic/integrationAccounts/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-LogicAppsISE",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.1502427Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.1502427Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mariadb": {
            "properties": {
              "displayName": "[Deprecated] Diagnostic Settings for MariaDB to Log Analytics Workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled. Deprecating due to service retirement, https://learn.microsoft.com/en-us/azure/mariadb/whats-happening-to-mariadb",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.8841689Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DBforMariaDB/servers",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "MySqlSlowLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "MySqlAuditLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DBforMariaDB/servers/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-MariaDB",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.7196794Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.7196794Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mediaservice": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.3255795Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Media/mediaServices",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "KeyDeliveryRequests",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Media/mediaServices/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-MediaService",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.2834424Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.2834424Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mlworkspace": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.5504529Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.MachineLearningServices/workspaces",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "AmlComputeClusterEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AmlComputeClusterNodeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AmlComputeJobEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AmlComputeCpuGpuUtilization",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AmlRunStatusChangedEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ModelsChangeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ModelsReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ModelsActionEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DeploymentReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DeploymentEventACI",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DeploymentEventAKS",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "InferencingOperationAKS",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "InferencingOperationACI",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataLabelChangeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataLabelReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ComputeInstanceEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataStoreChangeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataStoreReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataSetChangeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DataSetReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "PipelineChangeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "PipelineReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "RunEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "RunReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "EnvironmentChangeEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "EnvironmentReadEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    }
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-MlWorkspace",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.5106124Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.5106124Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mysql": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.1893527Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DBforMySQL/servers",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "MySqlSlowLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "MySqlAuditLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DBforMySQL/servers/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-MySQL",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.1556485Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.1556485Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-networksecuritygroups": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.2438144Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/networkSecurityGroups",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "NetworkSecurityGroupEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "NetworkSecurityGroupRuleCounter",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-NetworkSecurityGroups",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.2197194Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.2197194Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-nic": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.6484954Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/networkInterfaces",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/networkInterfaces/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-NIC",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.5482138Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.5482138Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-postgresql": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.6574872Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "anyOf": [
                    {
                      "equals": "Microsoft.DBforPostgreSQL/flexibleServers",
                      "field": "type"
                    },
                    {
                      "equals": "Microsoft.DBforPostgreSQL/servers",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          },
                          "resourceType": {
                            "value": "[field('type')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            },
                            "resourceType": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2021-05-01-preview",
                              "condition": "[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/flexibleServers')]",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "PostgreSQLLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DBforPostgreSQL/flexibleServers/providers/diagnosticSettings"
                            },
                            {
                              "apiVersion": "2021-05-01-preview",
                              "condition": "[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/servers')]",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "PostgreSQLLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "QueryStoreRuntimeStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "QueryStoreWaitStatistics",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-PostgreSQL",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.6296881Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.6296881Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-powerbiembedded": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.8000769Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.PowerBIDedicated/capacities",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Engine",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-PowerBIEmbedded",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.7291019Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.7291019Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-rediscache": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.0491476Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Cache/redis",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Cache/redis/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-RedisCache",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.9324858Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.9324858Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-relay": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Relay to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.0763785Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Relay/namespaces",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "HybridConnectionsEvent",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Relay/namespaces/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-Relay",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.0306132Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.0306132Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-signalr": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.5954887Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.SignalRService/SignalR",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "AllLogs",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.SignalRService/SignalR/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-SignalR",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.5525609Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.5525609Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-sqlelasticpools": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.1000468Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Sql/servers/elasticPools",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('fullName')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-SQLElasticPools",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.9788549Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.9788549Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-sqlmi": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:09.8783557Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Sql/managedInstances",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "ResourceUsageStats",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SQLSecurityAuditEvents",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "DevOpsOperationsAudit",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Sql/managedInstances/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-SQLMI",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:09.8183766Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:09.8183766Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-timeseriesinsights": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.2418977Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.TimeSeriesInsights/environments",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Ingress",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Management",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-TimeSeriesInsights",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.172845Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.172845Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-trafficmanager": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.4536071Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/trafficManagerProfiles",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "ProbeHealthStatusEvents",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-TrafficManager",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.4041461Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.4041461Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-virtualnetwork": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.6907755Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/virtualNetworks",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "VMProtectionAlerts",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    }
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/virtualNetworks/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-VirtualNetwork",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.6392855Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.6392855Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vm": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:01.5638897Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Compute/virtualMachines",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    }
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Compute/virtualMachines/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-VM",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:01.5322046Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:01.5322046Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vmss": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.8814405Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Compute/virtualMachineScaleSets",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    }
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-VMSS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.8015531Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.8015531Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vnetgw": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.9247216Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/virtualNetworkGateways",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "GatewayDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "IKEDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "P2SDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "RouteDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TunnelDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-VNetGW",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.9009718Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.9009718Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vwans2svpngw": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for VWAN S2S VPN Gateway to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for VWAN S2S VPN Gateway to stream to a Log Analytics workspace when any VWAN S2S VPN Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:07.1842576Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/vpnGateways",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "GatewayDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "IKEDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "RouteDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "TunnelDiagnosticLog",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Network/vpnGateways/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-VWanS2SVPNGW",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:07.0746267Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:07.0746267Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-webserverfarm": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.6195849Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Web/serverfarms",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [],
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Web/serverfarms/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-WebServerFarm",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.5678742Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.5678742Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-website": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for App Service to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:05.5411831Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "metricsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable metrics stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable metrics"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "notContains": "functionapp",
                      "value": "[field('kind')]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "metricsEnabled": {
                            "value": "[parameters('metricsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          },
                          "serverFarmId": {
                            "value": "[field('Microsoft.Web/sites/serverFarmId')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {
                            "policy": {
                              "type": "string",
                              "value": "[concat(parameters('logAnalytics'), 'configured for diagnostic logs for ', ': ', parameters('resourceName'))]"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "metricsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            },
                            "serverFarmId": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": "[if(startsWith(reference(parameters('serverFarmId'), '2021-03-01', 'Full').sku.tier, 'Premium'), variables('logs').premiumTierLogs, variables('logs').otherTierLogs)]",
                                "metrics": [
                                  {
                                    "category": "AllMetrics",
                                    "enabled": "[parameters('metricsEnabled')]",
                                    "retentionPolicy": {
                                      "days": 0,
                                      "enabled": false
                                    },
                                    "timeGrain": null
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.Web/sites/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {
                            "logs": {
                              "otherTierLogs": [
                                {
                                  "category": "AppServiceHTTPLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceConsoleLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceAppLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceAuditLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceIPSecAuditLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServicePlatformLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                }
                              ],
                              "premiumTierLogs": [
                                {
                                  "category": "AppServiceAntivirusScanAuditLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceHTTPLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceConsoleLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceAppLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceFileAuditLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceAuditLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServiceIPSecAuditLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                },
                                {
                                  "category": "AppServicePlatformLogs",
                                  "enabled": "[parameters('logsEnabled')]"
                                }
                              ]
                            }
                          }
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('logsEnabled')]",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('metricsEnabled')]",
                          "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-Website",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:05.5056301Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:05.5056301Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-wvdappgroup": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.4118Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DesktopVirtualization/applicationGroups",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Checkpoint",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Error",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Management",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-WVDAppGroup",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.3354294Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.3354294Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-wvdhostpools": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.3.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.653675Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DesktopVirtualization/hostpools",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Checkpoint",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Error",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Management",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Connection",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "HostRegistration",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "AgentHealthStatus",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "NetworkData",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "SessionHostManagement",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "ConnectionGraphicsData",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-WVDHostPools",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.6296365Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.6296365Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-wvdworkspace": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.9923328Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "logsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Whether to enable logs stream to the Log Analytics workspace - True or False",
                    "displayName": "Enable logs"
                  },
                  "allowedValues": [
                    "True",
                    "False"
                  ],
                  "defaultValue": "True"
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.DesktopVirtualization/workspaces",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "logsEnabled": {
                            "value": "[parameters('logsEnabled')]"
                          },
                          "profileName": {
                            "value": "[parameters('profileName')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "logsEnabled": {
                              "type": "String"
                            },
                            "profileName": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-05-01-preview",
                              "dependsOn": [],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                              "properties": {
                                "logs": [
                                  {
                                    "category": "Checkpoint",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Error",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Management",
                                    "enabled": "[parameters('logsEnabled')]"
                                  },
                                  {
                                    "category": "Feed",
                                    "enabled": "[parameters('logsEnabled')]"
                                  }
                                ],
                                "workspaceId": "[parameters('logAnalytics')]"
                              },
                              "type": "Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Insights/diagnosticSettings/logs.enabled"
                        },
                        {
                          "equals": "[parameters('logAnalytics')]",
                          "field": "Microsoft.Insights/diagnosticSettings/workspaceId"
                        }
                      ]
                    },
                    "name": "[parameters('profileName')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/diagnosticSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Diagnostics-WVDWorkspace",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.9369867Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.9369867Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-firewallpolicy": {
            "properties": {
              "displayName": "Deploy Azure Firewall Manager policy in the subscription",
              "policyType": "Custom",
              "mode": "All",
              "description": "Deploys Azure Firewall Manager policy in subscription where the policy is assigned.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.3441834Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "fwPolicyRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Azure region for Azure Firewall Policy",
                    "displayName": "fwPolicyRegion",
                    "strongType": "location"
                  }
                },
                "fwpolicy": {
                  "type": "Object",
                  "metadata": {
                    "description": "Object describing Azure Firewall Policy",
                    "displayName": "fwpolicy"
                  },
                  "defaultValue": {}
                },
                "rgName": {
                  "type": "String",
                  "metadata": {
                    "description": "Provide name for resource group.",
                    "displayName": "rgName"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Resources/subscriptions",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "northeurope",
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "fwPolicy": {
                            "value": "[parameters('fwPolicy')]"
                          },
                          "fwPolicyRegion": {
                            "value": "[parameters('fwPolicyRegion')]"
                          },
                          "rgName": {
                            "value": "[parameters('rgName')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "fwPolicy": {
                              "type": "object"
                            },
                            "fwPolicyRegion": {
                              "type": "String"
                            },
                            "rgName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2018-05-01",
                              "location": "[deployment().location]",
                              "name": "[parameters('rgName')]",
                              "properties": {},
                              "type": "Microsoft.Resources/resourceGroups"
                            },
                            {
                              "apiVersion": "2018-05-01",
                              "dependsOn": [
                                "[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]"
                              ],
                              "name": "fwpolicies",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json",
                                  "contentVersion": "1.0.0.0",
                                  "outputs": {},
                                  "parameters": {},
                                  "resources": [
                                    {
                                      "apiVersion": "2019-09-01",
                                      "dependsOn": [],
                                      "location": "[parameters('fwpolicy').location]",
                                      "name": "[parameters('fwpolicy').firewallPolicyName]",
                                      "properties": {},
                                      "resources": [
                                        {
                                          "apiVersion": "2019-09-01",
                                          "dependsOn": [
                                            "[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]"
                                          ],
                                          "name": "[parameters('fwpolicy').ruleGroups.name]",
                                          "properties": {
                                            "priority": "[parameters('fwpolicy').ruleGroups.properties.priority]",
                                            "rules": "[parameters('fwpolicy').ruleGroups.properties.rules]"
                                          },
                                          "type": "ruleGroups"
                                        }
                                      ],
                                      "tags": {},
                                      "type": "Microsoft.Network/firewallPolicies"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[parameters('rgName')]",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ]
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceScope": "resourceGroup",
                    "resourceGroupName": "[parameters('rgName')]",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Network/firewallPolicies"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-FirewallPolicy",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:56.3015424Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:56.3015424Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-logicapp-tls": {
            "properties": {
              "displayName": "Configure Logic apps to use the latest TLS version",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Logic Apps",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.2189001Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Web/sites",
                      "field": "type"
                    },
                    {
                      "contains": "workflowapp",
                      "field": "kind"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "siteName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "siteName": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2021-02-01",
                              "name": "[concat(parameters('siteName'), '/web')]",
                              "properties": {
                                "minTlsVersion": "1.2"
                              },
                              "type": "Microsoft.Web/sites/config"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "equals": "1.2",
                      "field": "Microsoft.Web/sites/config/minTlsVersion"
                    },
                    "name": "web",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772"
                    ],
                    "type": "Microsoft.Web/sites/config"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-LogicApp-TLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.1858825Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.1858825Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-mdfc-arc-sql-dcr-association": {
            "properties": {
              "displayName": "[Deprecated]: Configure Arc-enabled SQL Servers with DCR Association to Microsoft Defender for SQL user-defined DCR",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/2227e1f1-23dd-4c3a-85a9-7024a401d8b2.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "2227e1f1-23dd-4c3a-85a9-7024a401d8b2",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:54.9274312Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "dcrId": {
                  "type": "String",
                  "metadata": {
                    "description": "Id of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Id"
                  }
                },
                "dcrName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Name"
                  }
                },
                "dcrResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "Resource Group of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Resource Group"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "workspaceRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Region of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace region",
                    "strongType": "location"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.HybridCompute/machines",
                      "field": "type"
                    },
                    {
                      "equals": "Windows",
                      "field": "Microsoft.HybridCompute/machines/osName"
                    },
                    {
                      "equals": "true",
                      "field": "Microsoft.HybridCompute/machines/mssqlDiscovered"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "dcrId": {
                            "value": "[parameters('dcrId')]"
                          },
                          "dcrName": {
                            "value": "[parameters('dcrName')]"
                          },
                          "dcrResourceGroup": {
                            "value": "[parameters('dcrResourceGroup')]"
                          },
                          "resourceGroup": {
                            "value": "[parameters('dcrResourceGroup')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          },
                          "workspaceRegion": {
                            "value": "[parameters('workspaceRegion')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "dcrId": {
                              "type": "string"
                            },
                            "dcrName": {
                              "type": "string"
                            },
                            "dcrResourceGroup": {
                              "type": "string"
                            },
                            "resourceGroup": {
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            },
                            "workspaceRegion": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2021-04-01",
                              "name": "[variables('dcraName')]",
                              "properties": {
                                "dataCollectionRuleId": "[variables('dcrId')]",
                                "description": "Configure association between Arc-enabled SQL Server and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this Arc-enabled SQL Server."
                              },
                              "type": "Microsoft.HybridCompute/machines/providers/dataCollectionRuleAssociations"
                            }
                          ],
                          "variables": {
                            "dcrId": "[parameters('dcrId')]",
                            "dcrName": "[parameters('dcrName')]",
                            "dcraName": "[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]",
                            "defaultRGName": "[parameters('resourceGroup')]",
                            "locationCode": "[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]",
                            "locationLongNameToShortMap": {
                              "australiacentral": "CAU",
                              "australiaeast": "EAU",
                              "australiasoutheast": "SEAU",
                              "brazilsouth": "CQ",
                              "canadacentral": "CCA",
                              "canadaeast": "CCA",
                              "centralindia": "CIN",
                              "centralus": "CUS",
                              "eastasia": "EA",
                              "eastus": "EUS",
                              "eastus2": "EUS2",
                              "eastus2euap": "eus2p",
                              "francecentral": "PAR",
                              "germanywestcentral": "DEWC",
                              "japaneast": "EJP",
                              "jioindiawest": "CIN",
                              "koreacentral": "SE",
                              "koreasouth": "SE",
                              "northcentralus": "NCUS",
                              "northeurope": "NEU",
                              "norwayeast": "NOE",
                              "southafricanorth": "JNB",
                              "southcentralus": "SCUS",
                              "southeastasia": "SEA",
                              "southindia": "CIN",
                              "swedencentral": "SEC",
                              "switzerlandnorth": "CHN",
                              "switzerlandwest": "CHW",
                              "uaenorth": "DXB",
                              "uksouth": "SUK",
                              "ukwest": "WUK",
                              "westcentralus": "WCUS",
                              "westeurope": "WEU",
                              "westindia": "CIN",
                              "westus": "WUS",
                              "westus2": "WUS2"
                            },
                            "subscriptionId": "[subscription().subscriptionId]"
                          }
                        }
                      }
                    },
                    "name": "MicrosoftDefenderForSQL-RulesAssociation",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Insights/dataCollectionRuleAssociations"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-MDFC-Arc-SQL-DCR-Association",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:54.8796516Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:54.8796516Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-mdfc-arc-sql-defendersql-dcr": {
            "properties": {
              "displayName": "[Deprecated]: Configure Arc-enabled SQL Servers to auto install Microsoft Defender for SQL and DCR with a user-defined LAW",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/63d03cbd-47fd-4ee1-8a1c-9ddf07303de0.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "63d03cbd-47fd-4ee1-8a1c-9ddf07303de0",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:03.4934869Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "dcrId": {
                  "type": "String",
                  "metadata": {
                    "description": "Id of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Id"
                  }
                },
                "dcrName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Name"
                  }
                },
                "dcrResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "Resource Group of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Resource Group"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableCollectionOfSqlQueriesForSecurityResearch": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "Enable or disable the collection of SQL queries for security research.",
                    "displayName": "Enable collection of SQL queries for security research"
                  },
                  "allowedValues": [
                    true,
                    false
                  ],
                  "defaultValue": false
                },
                "userWorkspaceResourceId": {
                  "type": "String",
                  "metadata": {
                    "description": "Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace Resource Id",
                    "strongType": "omsWorkspace"
                  }
                },
                "workspaceRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Region of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace region",
                    "strongType": "location"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.HybridCompute/machines",
                      "field": "type"
                    },
                    {
                      "equals": "Windows",
                      "field": "Microsoft.HybridCompute/machines/osName"
                    },
                    {
                      "equals": "true",
                      "field": "Microsoft.HybridCompute/machines/mssqlDiscovered"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "eastus",
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "dcrId": {
                            "value": "[parameters('dcrId')]"
                          },
                          "dcrName": {
                            "value": "[parameters('dcrName')]"
                          },
                          "dcrResourceGroup": {
                            "value": "[parameters('dcrResourceGroup')]"
                          },
                          "enableCollectionOfSqlQueriesForSecurityResearch": {
                            "value": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                          },
                          "resourceGroup": {
                            "value": "[parameters('dcrResourceGroup')]"
                          },
                          "userWorkspaceResourceId": {
                            "value": "[parameters('userWorkspaceResourceId')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          },
                          "workspaceRegion": {
                            "value": "[parameters('workspaceRegion')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "dcrId": {
                              "type": "string"
                            },
                            "dcrName": {
                              "type": "string"
                            },
                            "dcrResourceGroup": {
                              "type": "string"
                            },
                            "enableCollectionOfSqlQueriesForSecurityResearch": {
                              "type": "bool"
                            },
                            "resourceGroup": {
                              "type": "string"
                            },
                            "userWorkspaceResourceId": {
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            },
                            "workspaceRegion": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2022-09-01",
                              "condition": "[empty(parameters('dcrResourceGroup'))]",
                              "location": "[variables('defaultRGLocation')]",
                              "name": "[variables('defaultRGName')]",
                              "tags": {
                                "createdBy": "MicrosoftDefenderForSQL"
                              },
                              "type": "Microsoft.Resources/resourceGroups"
                            },
                            {
                              "apiVersion": "2022-09-01",
                              "condition": "[empty(parameters('dcrId'))]",
                              "dependsOn": [
                                "[variables('defaultRGName')]"
                              ],
                              "name": "[variables('deployDataCollectionRules')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "dcrId": {
                                    "value": "[variables('dcrId')]"
                                  },
                                  "dcrName": {
                                    "value": "[variables('dcrName')]"
                                  },
                                  "defaultRGLocation": {
                                    "value": "[variables('defaultRGLocation')]"
                                  },
                                  "enableCollectionOfSqlQueriesForSecurityResearch": {
                                    "value": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                                  },
                                  "workspaceResourceId": {
                                    "value": "[parameters('userWorkspaceResourceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "dcrId": {
                                      "type": "string"
                                    },
                                    "dcrName": {
                                      "type": "string"
                                    },
                                    "defaultRGLocation": {
                                      "type": "string"
                                    },
                                    "enableCollectionOfSqlQueriesForSecurityResearch": {
                                      "type": "bool"
                                    },
                                    "workspaceResourceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2021-04-01",
                                      "location": "[parameters('defaultRGLocation')]",
                                      "name": "[parameters('dcrName')]",
                                      "properties": {
                                        "dataFlows": [
                                          {
                                            "destinations": [
                                              "LogAnalyticsDest"
                                            ],
                                            "streams": [
                                              "Microsoft-DefenderForSqlAlerts",
                                              "Microsoft-DefenderForSqlLogins",
                                              "Microsoft-DefenderForSqlTelemetry",
                                              "Microsoft-DefenderForSqlScanEvents",
                                              "Microsoft-DefenderForSqlScanResults"
                                            ]
                                          }
                                        ],
                                        "dataSources": {
                                          "extensions": [
                                            {
                                              "extensionName": "MicrosoftDefenderForSQL",
                                              "extensionSettings": {
                                                "enableCollectionOfSqlQueriesForSecurityResearch": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                                              },
                                              "name": "MicrosoftDefenderForSQL",
                                              "streams": [
                                                "Microsoft-DefenderForSqlAlerts",
                                                "Microsoft-DefenderForSqlLogins",
                                                "Microsoft-DefenderForSqlTelemetry",
                                                "Microsoft-DefenderForSqlScanEvents",
                                                "Microsoft-DefenderForSqlScanResults"
                                              ]
                                            }
                                          ]
                                        },
                                        "description": "Data collection rule for Microsoft Defender for SQL. Deleting this rule will break the detection of security vulnerabilities.",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "name": "LogAnalyticsDest",
                                              "workspaceResourceId": "[parameters('workspaceResourceId')]"
                                            }
                                          ]
                                        }
                                      },
                                      "tags": {
                                        "createdBy": "MicrosoftDefenderForSQL"
                                      },
                                      "type": "Microsoft.Insights/dataCollectionRules"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[variables('defaultRGName')]",
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2022-09-01",
                              "dependsOn": [
                                "[variables('deployDataCollectionRules')]"
                              ],
                              "name": "[variables('deployDataCollectionRulesAssociation')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "dcrId": {
                                    "value": "[variables('dcrId')]"
                                  },
                                  "dcraName": {
                                    "value": "[variables('dcraName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "dcrId": {
                                      "type": "string"
                                    },
                                    "dcraName": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2021-04-01",
                                      "name": "[parameters('dcraName')]",
                                      "properties": {
                                        "dataCollectionRuleId": "[parameters('dcrId')]",
                                        "description": "Configure association between Arc-enabled SQL Server and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this Arc-enabled SQL Server."
                                      },
                                      "type": "Microsoft.HybridCompute/machines/providers/dataCollectionRuleAssociations"
                                    }
                                  ]
                                }
                              },
                              "resourceGroup": "[parameters('resourceGroup')]",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ],
                          "variables": {
                            "dcrId": "[parameters('dcrId')]",
                            "dcrName": "[parameters('dcrName')]",
                            "dcraName": "[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]",
                            "defaultRGLocation": "[parameters('workspaceRegion')]",
                            "defaultRGName": "[parameters('resourceGroup')]",
                            "deployDataCollectionRules": "[concat('deployDataCollectionRules-', uniqueString(deployment().name))]",
                            "deployDataCollectionRulesAssociation": "[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]",
                            "locationCode": "[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]",
                            "locationLongNameToShortMap": {
                              "australiacentral": "CAU",
                              "australiaeast": "EAU",
                              "australiasoutheast": "SEAU",
                              "brazilsouth": "CQ",
                              "canadacentral": "CCA",
                              "canadaeast": "CCA",
                              "centralindia": "CIN",
                              "centralus": "CUS",
                              "eastasia": "EA",
                              "eastus": "EUS",
                              "eastus2": "EUS2",
                              "eastus2euap": "eus2p",
                              "francecentral": "PAR",
                              "germanywestcentral": "DEWC",
                              "japaneast": "EJP",
                              "jioindiawest": "CIN",
                              "koreacentral": "SE",
                              "koreasouth": "SE",
                              "northcentralus": "NCUS",
                              "northeurope": "NEU",
                              "norwayeast": "NOE",
                              "southafricanorth": "JNB",
                              "southcentralus": "SCUS",
                              "southeastasia": "SEA",
                              "southindia": "CIN",
                              "swedencentral": "SEC",
                              "switzerlandnorth": "CHN",
                              "switzerlandwest": "CHW",
                              "uaenorth": "DXB",
                              "uksouth": "SUK",
                              "ukwest": "WUK",
                              "westcentralus": "WCUS",
                              "westeurope": "WEU",
                              "westindia": "CIN",
                              "westus": "WUS",
                              "westus2": "WUS2"
                            },
                            "subscriptionId": "[subscription().subscriptionId]"
                          }
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('workspaceRegion')]",
                          "field": "location"
                        },
                        {
                          "equals": "[parameters('dcrName')]",
                          "field": "name"
                        }
                      ]
                    },
                    "existenceScope": "subscription",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Insights/dataCollectionRules"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:03.4072353Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:03.4072353Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-mdfc-sql-ama": {
            "properties": {
              "displayName": "[Deprecated]: Configure SQL Virtual Machines to automatically install Azure Monitor Agent",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/f91991d1-5383-4c95-8ee5-5ac423dd8bb1.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "f91991d1-5383-4c95-8ee5-5ac423dd8bb1",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.8646925Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "identityResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "The name of the resource group created by the policy.",
                    "displayName": "Identity Resource Group"
                  },
                  "defaultValue": ""
                },
                "userAssignedIdentityName": {
                  "type": "String",
                  "metadata": {
                    "description": "The name of the user assigned managed identity.",
                    "displayName": "User Assigned Managed Identity Name"
                  },
                  "defaultValue": ""
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Compute/virtualMachines",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType",
                      "like": "Windows*"
                    },
                    {
                      "equals": "microsoftsqlserver",
                      "field": "Microsoft.Compute/imagePublisher"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "identityResourceGroup": {
                            "value": "[parameters('identityResourceGroup')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "userAssignedIdentityName": {
                            "value": "[parameters('userAssignedIdentityName')]"
                          },
                          "userAssignedManagedIdentity": {
                            "value": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('userAssignedIdentityName')))]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "identityResourceGroup": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string"
                            },
                            "userAssignedIdentityName": {
                              "type": "string"
                            },
                            "userAssignedManagedIdentity": {
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2023-03-01",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('vmName'), '/', variables('extensionName'))]",
                              "properties": {
                                "autoUpgradeMinorVersion": true,
                                "enableAutomaticUpgrade": true,
                                "publisher": "[variables('extensionPublisher')]",
                                "settings": {
                                  "authentication": {
                                    "managedIdentity": {
                                      "identifier-name": "mi_res_id",
                                      "identifier-value": "[parameters('userAssignedManagedIdentity')]"
                                    }
                                  }
                                },
                                "type": "[variables('extensionType')]",
                                "typeHandlerVersion": "[variables('extensionTypeHandlerVersion')]"
                              },
                              "tags": {
                                "createdBy": "MicrosoftDefenderForSQL"
                              },
                              "type": "Microsoft.Compute/virtualMachines/extensions"
                            }
                          ],
                          "variables": {
                            "extensionName": "AzureMonitorWindowsAgent",
                            "extensionPublisher": "Microsoft.Azure.Monitor",
                            "extensionType": "AzureMonitorWindowsAgent",
                            "extensionTypeHandlerVersion": "1.2"
                          }
                        }
                      }
                    },
                    "evaluationDelay": "AfterProvisioning",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "AzureMonitorWindowsAgent",
                          "field": "Microsoft.Compute/virtualMachines/extensions/type"
                        },
                        {
                          "equals": "Microsoft.Azure.Monitor",
                          "field": "Microsoft.Compute/virtualMachines/extensions/publisher"
                        },
                        {
                          "field": "Microsoft.Compute/virtualMachines/extensions/provisioningState",
                          "in": [
                            "Succeeded",
                            "Provisioning succeeded"
                          ]
                        }
                      ]
                    },
                    "name": "[concat(field('fullName'), '/AzureMonitorWindowsAgent')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
                    ],
                    "type": "Microsoft.Compute/virtualMachines/extensions"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-MDFC-SQL-AMA",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.793353Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.793353Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-mdfc-sql-defendersql": {
            "properties": {
              "displayName": "[Deprecated]: Configure SQL Virtual Machines to automatically install Microsoft Defender for SQL",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/ddca0ddc-4e9d-4bbb-92a1-f7c4dd7ef7ce.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "ddca0ddc-4e9d-4bbb-92a1-f7c4dd7ef7ce",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:01.4837959Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "dcrId": {
                  "type": "String",
                  "metadata": {
                    "description": "Id of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Id"
                  }
                },
                "dcrName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Name"
                  }
                },
                "dcrResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "Resource Group of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Resource Group"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "workspaceRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Region of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace region",
                    "strongType": "location"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Compute/virtualMachines",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType",
                      "like": "Windows*"
                    },
                    {
                      "equals": "microsoftsqlserver",
                      "field": "Microsoft.Compute/imagePublisher"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "dcrId": {
                            "value": "[parameters('dcrId')]"
                          },
                          "dcrName": {
                            "value": "[parameters('dcrName')]"
                          },
                          "dcrResourceGroup": {
                            "value": "[parameters('dcrResourceGroup')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          },
                          "workspaceRegion": {
                            "value": "[parameters('workspaceRegion')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "dcrId": {
                              "type": "string"
                            },
                            "dcrName": {
                              "type": "string"
                            },
                            "dcrResourceGroup": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            },
                            "workspaceRegion": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2023-03-01",
                              "dependsOn": [
                                "[extensionResourceId(concat('/subscriptions/', variables('subscriptionId'), '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName')), 'Microsoft.Insights/dataCollectionRuleAssociations','MicrosoftDefenderForSQL-RulesAssociation')]"
                              ],
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('vmName'), '/', 'MicrosoftDefenderForSQL')]",
                              "properties": {
                                "autoUpgradeMinorVersion": true,
                                "enableAutomaticUpgrade": true,
                                "publisher": "Microsoft.Azure.AzureDefenderForSQL",
                                "type": "AdvancedThreatProtection.Windows",
                                "typeHandlerVersion": "2.0"
                              },
                              "tags": {
                                "createdBy": "MicrosoftDefenderForSQL"
                              },
                              "type": "Microsoft.Compute/virtualMachines/extensions"
                            },
                            {
                              "apiVersion": "2021-04-01",
                              "name": "[variables('dcraName')]",
                              "properties": {
                                "dataCollectionRuleId": "[variables('dcrId')]",
                                "description": "Configure association between SQL Virtual Machine and the Microsoft Defender for SQL DCR. Deleting this association will break the detection of security vulnerabilities for this SQL Virtual Machine."
                              },
                              "type": "Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations"
                            }
                          ],
                          "variables": {
                            "actualLocation": "[if(empty(parameters('workspaceRegion')), parameters('location'), parameters('workspaceRegion'))]",
                            "dcrId": "[parameters('dcrId')]",
                            "dcrName": "[parameters('dcrName')]",
                            "dcraName": "[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]",
                            "defaultRGName": "[parameters('dcrResourceGroup')]",
                            "locationCode": "[if(contains(variables('locationLongNameToShortMap'), variables('actualLocation')), variables('locationLongNameToShortMap')[variables('actualLocation')], variables('actualLocation'))]",
                            "locationLongNameToShortMap": {
                              "australiacentral": "CAU",
                              "australiaeast": "EAU",
                              "australiasoutheast": "SEAU",
                              "brazilsouth": "CQ",
                              "canadacentral": "CCA",
                              "canadaeast": "CCA",
                              "centralindia": "CIN",
                              "centralus": "CUS",
                              "eastasia": "EA",
                              "eastus": "EUS",
                              "eastus2": "EUS2",
                              "eastus2euap": "eus2p",
                              "francecentral": "PAR",
                              "germanywestcentral": "DEWC",
                              "japaneast": "EJP",
                              "jioindiawest": "CIN",
                              "koreacentral": "SE",
                              "koreasouth": "SE",
                              "northcentralus": "NCUS",
                              "northeurope": "NEU",
                              "norwayeast": "NOE",
                              "southafricanorth": "JNB",
                              "southcentralus": "SCUS",
                              "southeastasia": "SEA",
                              "southindia": "CIN",
                              "swedencentral": "SEC",
                              "switzerlandnorth": "CHN",
                              "switzerlandwest": "CHW",
                              "uaenorth": "DXB",
                              "uksouth": "SUK",
                              "ukwest": "WUK",
                              "westcentralus": "WCUS",
                              "westeurope": "WEU",
                              "westindia": "CIN",
                              "westus": "WUS",
                              "westus2": "WUS2"
                            },
                            "subscriptionId": "[subscription().subscriptionId]"
                          }
                        }
                      }
                    },
                    "evaluationDelay": "AfterProvisioning",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "AdvancedThreatProtection.Windows",
                          "field": "Microsoft.Compute/virtualMachines/extensions/type"
                        },
                        {
                          "equals": "Microsoft.Azure.AzureDefenderForSQL",
                          "field": "Microsoft.Compute/virtualMachines/extensions/publisher"
                        },
                        {
                          "field": "Microsoft.Compute/virtualMachines/extensions/provisioningState",
                          "in": [
                            "Succeeded",
                            "Provisioning succeeded"
                          ]
                        }
                      ]
                    },
                    "name": "[concat(field('fullName'), '/MicrosoftDefenderForSQL')]",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Compute/virtualMachines/extensions"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-MDFC-SQL-DefenderSQL",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:01.4384586Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:01.4384586Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-mdfc-sql-defendersql-dcr": {
            "properties": {
              "displayName": "[Deprecated]: Configure SQL Virtual Machines to auto install Microsoft Defender for SQL and DCR with a user-defined LAW",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/04754ef9-9ae3-4477-bf17-86ef50026304.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "04754ef9-9ae3-4477-bf17-86ef50026304",
                "version": "1.0.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.5967657Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "dcrId": {
                  "type": "String",
                  "metadata": {
                    "description": "Id of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Id"
                  }
                },
                "dcrName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Name"
                  }
                },
                "dcrResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "Resource Group of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Resource Group"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableCollectionOfSqlQueriesForSecurityResearch": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "Enable or disable the collection of SQL queries for security research.",
                    "displayName": "Enable collection of SQL queries for security research"
                  },
                  "allowedValues": [
                    true,
                    false
                  ],
                  "defaultValue": false
                },
                "userWorkspaceResourceId": {
                  "type": "String",
                  "metadata": {
                    "description": "Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace Resource Id",
                    "strongType": "omsWorkspace"
                  }
                },
                "workspaceRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Region of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace region",
                    "strongType": "location"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Compute/virtualMachines",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType",
                      "like": "Windows*"
                    },
                    {
                      "equals": "microsoftsqlserver",
                      "field": "Microsoft.Compute/imagePublisher"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "eastus",
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "dcrId": {
                            "value": "[parameters('dcrId')]"
                          },
                          "dcrName": {
                            "value": "[parameters('dcrName')]"
                          },
                          "dcrResourceGroup": {
                            "value": "[parameters('dcrResourceGroup')]"
                          },
                          "enableCollectionOfSqlQueriesForSecurityResearch": {
                            "value": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "resourceGroup": {
                            "value": "[resourceGroup().name]"
                          },
                          "userWorkspaceResourceId": {
                            "value": "[parameters('userWorkspaceResourceId')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          },
                          "workspaceRegion": {
                            "value": "[parameters('workspaceRegion')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "dcrId": {
                              "type": "string"
                            },
                            "dcrName": {
                              "type": "string"
                            },
                            "dcrResourceGroup": {
                              "type": "string"
                            },
                            "enableCollectionOfSqlQueriesForSecurityResearch": {
                              "type": "bool"
                            },
                            "location": {
                              "type": "string"
                            },
                            "resourceGroup": {
                              "type": "string"
                            },
                            "userWorkspaceResourceId": {
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            },
                            "workspaceRegion": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2022-09-01",
                              "condition": "[empty(parameters('dcrResourceGroup'))]",
                              "location": "[variables('defaultRGLocation')]",
                              "name": "[variables('defaultRGName')]",
                              "tags": {
                                "createdBy": "MicrosoftDefenderForSQL"
                              },
                              "type": "Microsoft.Resources/resourceGroups"
                            },
                            {
                              "apiVersion": "2022-09-01",
                              "name": "[variables('deployDefenderForSQL')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "vmName": {
                                    "value": "[parameters('vmName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "vmName": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2023-03-01",
                                      "location": "[parameters('location')]",
                                      "name": "[concat(parameters('vmName'), '/', 'MicrosoftDefenderForSQL')]",
                                      "properties": {
                                        "autoUpgradeMinorVersion": true,
                                        "enableAutomaticUpgrade": true,
                                        "publisher": "Microsoft.Azure.AzureDefenderForSQL",
                                        "type": "AdvancedThreatProtection.Windows",
                                        "typeHandlerVersion": "2.0"
                                      },
                                      "tags": {
                                        "createdBy": "MicrosoftDefenderForSQL"
                                      },
                                      "type": "Microsoft.Compute/virtualMachines/extensions"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[parameters('resourceGroup')]",
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2022-09-01",
                              "condition": "[empty(parameters('dcrId'))]",
                              "dependsOn": [
                                "[variables('defaultRGName')]"
                              ],
                              "name": "[variables('deployDataCollectionRules')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "dcrId": {
                                    "value": "[variables('dcrId')]"
                                  },
                                  "dcrName": {
                                    "value": "[variables('dcrName')]"
                                  },
                                  "defaultRGLocation": {
                                    "value": "[variables('defaultRGLocation')]"
                                  },
                                  "enableCollectionOfSqlQueriesForSecurityResearch": {
                                    "value": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                                  },
                                  "workspaceResourceId": {
                                    "value": "[parameters('userWorkspaceResourceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "dcrId": {
                                      "type": "string"
                                    },
                                    "dcrName": {
                                      "type": "string"
                                    },
                                    "defaultRGLocation": {
                                      "type": "string"
                                    },
                                    "enableCollectionOfSqlQueriesForSecurityResearch": {
                                      "type": "bool"
                                    },
                                    "workspaceResourceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2021-04-01",
                                      "location": "[parameters('defaultRGLocation')]",
                                      "name": "[parameters('dcrName')]",
                                      "properties": {
                                        "dataFlows": [
                                          {
                                            "destinations": [
                                              "LogAnalyticsDest"
                                            ],
                                            "streams": [
                                              "Microsoft-DefenderForSqlAlerts",
                                              "Microsoft-DefenderForSqlLogins",
                                              "Microsoft-DefenderForSqlTelemetry",
                                              "Microsoft-DefenderForSqlScanEvents",
                                              "Microsoft-DefenderForSqlScanResults"
                                            ]
                                          }
                                        ],
                                        "dataSources": {
                                          "extensions": [
                                            {
                                              "extensionName": "MicrosoftDefenderForSQL",
                                              "extensionSettings": {
                                                "enableCollectionOfSqlQueriesForSecurityResearch": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                                              },
                                              "name": "MicrosoftDefenderForSQL",
                                              "streams": [
                                                "Microsoft-DefenderForSqlAlerts",
                                                "Microsoft-DefenderForSqlLogins",
                                                "Microsoft-DefenderForSqlTelemetry",
                                                "Microsoft-DefenderForSqlScanEvents",
                                                "Microsoft-DefenderForSqlScanResults"
                                              ]
                                            }
                                          ]
                                        },
                                        "description": "Data collection rule for Microsoft Defender for SQL. Deleting this rule will break the detection of security vulnerabilities.",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "name": "LogAnalyticsDest",
                                              "workspaceResourceId": "[parameters('workspaceResourceId')]"
                                            }
                                          ]
                                        }
                                      },
                                      "tags": {
                                        "createdBy": "MicrosoftDefenderForSQL"
                                      },
                                      "type": "Microsoft.Insights/dataCollectionRules"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[variables('defaultRGName')]",
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2022-09-01",
                              "dependsOn": [
                                "[variables('deployDataCollectionRules')]"
                              ],
                              "name": "[variables('deployDataCollectionRulesAssociation')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "dcrId": {
                                    "value": "[variables('dcrId')]"
                                  },
                                  "dcraName": {
                                    "value": "[variables('dcraName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "dcrId": {
                                      "type": "string"
                                    },
                                    "dcraName": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2021-04-01",
                                      "name": "[parameters('dcraName')]",
                                      "properties": {
                                        "dataCollectionRuleId": "[parameters('dcrId')]",
                                        "description": "Configure association between SQL Virtual Machine and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this SQL Virtual Machine."
                                      },
                                      "type": "Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations"
                                    }
                                  ]
                                }
                              },
                              "resourceGroup": "[parameters('resourceGroup')]",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ],
                          "variables": {
                            "dcrId": "[parameters('dcrId')]",
                            "dcrName": "[parameters('dcrName')]",
                            "dcraName": "[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]",
                            "defaultRGLocation": "[parameters('workspaceRegion')]",
                            "defaultRGName": "[parameters('dcrResourceGroup')]",
                            "deployDataCollectionRules": "[concat('deployDataCollectionRules-', uniqueString(deployment().name))]",
                            "deployDataCollectionRulesAssociation": "[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]",
                            "deployDefenderForSQL": "[concat('deployDefenderForSQL-', uniqueString(deployment().name))]",
                            "locationCode": "[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]",
                            "locationLongNameToShortMap": {
                              "australiacentral": "CAU",
                              "australiaeast": "EAU",
                              "australiasoutheast": "SEAU",
                              "brazilsouth": "CQ",
                              "canadacentral": "CCA",
                              "canadaeast": "CCA",
                              "centralindia": "CIN",
                              "centralus": "CUS",
                              "eastasia": "EA",
                              "eastus": "EUS",
                              "eastus2": "EUS2",
                              "eastus2euap": "eus2p",
                              "francecentral": "PAR",
                              "germanywestcentral": "DEWC",
                              "japaneast": "EJP",
                              "jioindiawest": "CIN",
                              "koreacentral": "SE",
                              "koreasouth": "SE",
                              "northcentralus": "NCUS",
                              "northeurope": "NEU",
                              "norwayeast": "NOE",
                              "southafricanorth": "JNB",
                              "southcentralus": "SCUS",
                              "southeastasia": "SEA",
                              "southindia": "CIN",
                              "swedencentral": "SEC",
                              "switzerlandnorth": "CHN",
                              "switzerlandwest": "CHW",
                              "uaenorth": "DXB",
                              "uksouth": "SUK",
                              "ukwest": "WUK",
                              "westcentralus": "WCUS",
                              "westeurope": "WEU",
                              "westindia": "CIN",
                              "westus": "WUS",
                              "westus2": "WUS2"
                            },
                            "subscriptionId": "[subscription().subscriptionId]"
                          }
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "evaluationDelay": "AfterProvisioning",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('workspaceRegion')]",
                          "field": "location"
                        },
                        {
                          "equals": "[parameters('dcrName')]",
                          "field": "name"
                        }
                      ]
                    },
                    "existenceScope": "subscription",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Insights/dataCollectionRules"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-MDFC-SQL-DefenderSQL-DCR",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.5360521Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.5360521Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-mysql-sslenforcement": {
            "properties": {
              "displayName": "Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.6870284Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server",
                    "displayName": "Effect minimum TLS version Azure Database for MySQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.DBforMySQL/servers",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.DBforMySQL/servers/sslEnforcement",
                          "notEquals": "Enabled"
                        },
                        {
                          "field": "Microsoft.DBforMySQL/servers/minimalTlsVersion",
                          "less": "[parameters('minimalTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "minimalTlsVersion": {
                            "value": "[parameters('minimalTlsVersion')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "minimalTlsVersion": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-12-01",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'))]",
                              "properties": {
                                "minimalTlsVersion": "[parameters('minimalTlsVersion')]",
                                "sslEnforcement": "[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]"
                              },
                              "type": "Microsoft.DBforMySQL/servers"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "Enabled",
                          "field": "Microsoft.DBforMySQL/servers/sslEnforcement"
                        },
                        {
                          "equals": "[parameters('minimalTlsVersion')]",
                          "field": "Microsoft.DBforMySQL/servers/minimalTlsVersion"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.DBforMySQL/servers"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-MySQL-sslEnforcement",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.6562676Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.6562676Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-nsg-flowlogs": {
            "properties": {
              "displayName": "[Deprecated] Deploys NSG flow logs and traffic analytics",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to a storageaccountid with a specified retention period. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/e920df7f-9a64-4066-9b58-52684c02a091.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "e920df7f-9a64-4066-9b58-52684c02a091",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.7593989Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "flowAnalyticsEnabled": {
                  "type": "Boolean",
                  "metadata": {
                    "displayName": "Enable Traffic Analytics"
                  },
                  "defaultValue": false
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Resource ID of Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  },
                  "defaultValue": ""
                },
                "retention": {
                  "type": "Integer",
                  "metadata": {
                    "displayName": "Retention"
                  },
                  "defaultValue": 5
                },
                "storageAccountResourceId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "Storage Account Resource Id",
                    "strongType": "Microsoft.Storage/storageAccounts"
                  }
                },
                "trafficAnalyticsInterval": {
                  "type": "Integer",
                  "metadata": {
                    "displayName": "Traffic Analytics processing interval mins (10/60)"
                  },
                  "defaultValue": 60
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Network/networkSecurityGroups",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "flowAnalyticsEnabled": {
                            "value": "[parameters('flowAnalyticsEnabled')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "logAnalytics": {
                            "value": "[parameters('logAnalytics')]"
                          },
                          "networkSecurityGroupName": {
                            "value": "[field('name')]"
                          },
                          "resourceGroupName": {
                            "value": "[resourceGroup().name]"
                          },
                          "retention": {
                            "value": "[parameters('retention')]"
                          },
                          "storageAccountResourceId": {
                            "value": "[parameters('storageAccountResourceId')]"
                          },
                          "trafficAnalyticsInterval": {
                            "value": "[parameters('trafficAnalyticsInterval')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "flowAnalyticsEnabled": {
                              "type": "bool"
                            },
                            "location": {
                              "type": "String"
                            },
                            "logAnalytics": {
                              "type": "String"
                            },
                            "networkSecurityGroupName": {
                              "type": "String"
                            },
                            "resourceGroupName": {
                              "type": "String"
                            },
                            "retention": {
                              "type": "int"
                            },
                            "storageAccountResourceId": {
                              "type": "String"
                            },
                            "trafficAnalyticsInterval": {
                              "type": "int"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2020-05-01",
                              "location": "[parameters('location')]",
                              "name": "[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]",
                              "properties": {
                                "enabled": true,
                                "flowAnalyticsConfiguration": {
                                  "networkWatcherFlowAnalyticsConfiguration": {
                                    "enabled": "[bool(parameters('flowAnalyticsEnabled'))]",
                                    "trafficAnalyticsInterval": "[parameters('trafficAnalyticsInterval')]",
                                    "workspaceId": "[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]",
                                    "workspaceRegion": "[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]",
                                    "workspaceResourceId": "[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]"
                                  }
                                },
                                "format": {
                                  "type": "JSON",
                                  "version": 2
                                },
                                "retentionPolicy": {
                                  "days": "[parameters('retention')]",
                                  "enabled": true
                                },
                                "storageId": "[parameters('storageAccountResourceId')]",
                                "targetResourceId": "[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]"
                              },
                              "type": "Microsoft.Network/networkWatchers/flowLogs"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Network/networkWatchers/flowLogs/enabled"
                        },
                        {
                          "equals": "[parameters('flowAnalyticsEnabled')]",
                          "field": "Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled"
                        }
                      ]
                    },
                    "resourceGroupName": "NetworkWatcherRG",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
                    ],
                    "type": "Microsoft.Network/networkWatchers/flowLogs"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Nsg-FlowLogs",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.6793959Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.6793959Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-nsg-flowlogs-to-la": {
            "properties": {
              "displayName": "[Deprecated] Deploys NSG flow logs and traffic analytics to Log Analytics",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to Log Analytics with a specified retention period. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/e920df7f-9a64-4066-9b58-52684c02a091.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "e920df7f-9a64-4066-9b58-52684c02a091",
                "version": "1.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.7837275Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "interval": {
                  "type": "Integer",
                  "metadata": {
                    "displayName": "Traffic Analytics processing interval mins (10/60)"
                  },
                  "defaultValue": 60
                },
                "retention": {
                  "type": "Integer",
                  "metadata": {
                    "displayName": "Retention"
                  },
                  "defaultValue": 5
                },
                "workspace": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Resource ID of Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  },
                  "defaultValue": "<workspace resource ID>"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/networkSecurityGroups",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "northeurope",
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "interval": {
                            "value": "[parameters('interval')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "networkSecurityGroup": {
                            "value": "[field('id')]"
                          },
                          "retention": {
                            "value": "[parameters('retention')]"
                          },
                          "workspace": {
                            "value": "[parameters('workspace')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "interval": {
                              "type": "int"
                            },
                            "location": {
                              "type": "String"
                            },
                            "networkSecurityGroup": {
                              "type": "String"
                            },
                            "retention": {
                              "type": "int"
                            },
                            "time": {
                              "defaultValue": "[utcNow()]",
                              "type": "String"
                            },
                            "workspace": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2019-10-01",
                              "name": "[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": [
                                    {
                                      "apiVersion": "2019-06-01",
                                      "kind": "StorageV2",
                                      "location": "[parameters('location')]",
                                      "name": "[variables('storageAccountName')]",
                                      "properties": {},
                                      "sku": {
                                        "name": "Standard_LRS",
                                        "tier": "Standard"
                                      },
                                      "type": "Microsoft.Storage/storageAccounts"
                                    }
                                  ]
                                }
                              },
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2019-10-01",
                              "dependsOn": [
                                "[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]"
                              ],
                              "name": "[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": [
                                    {
                                      "apiVersion": "2020-05-01",
                                      "location": "[parameters('location')]",
                                      "name": "[concat('NetworkWatcher_', toLower(parameters('location')))]",
                                      "properties": {},
                                      "resources": [
                                        {
                                          "apiVersion": "2019-11-01",
                                          "dependsOn": [
                                            "[concat('NetworkWatcher_', toLower(parameters('location')))]"
                                          ],
                                          "location": "[parameters('location')]",
                                          "name": "[concat(variables('securityGroupName'), '-Network-flowlog')]",
                                          "properties": {
                                            "enabled": true,
                                            "flowAnalyticsConfiguration": {
                                              "networkWatcherFlowAnalyticsConfiguration": {
                                                "enabled": true,
                                                "trafficAnalyticsInterval": "[parameters('interval')]",
                                                "workspaceResourceId": "[parameters('workspace')]"
                                              }
                                            },
                                            "format": {
                                              "type": "JSON",
                                              "version": 2
                                            },
                                            "retentionPolicy": {
                                              "days": "[parameters('retention')]",
                                              "enabled": true
                                            },
                                            "storageId": "[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]",
                                            "targetResourceId": "[parameters('networkSecurityGroup')]"
                                          },
                                          "type": "flowLogs"
                                        }
                                      ],
                                      "type": "Microsoft.Network/networkWatchers"
                                    }
                                  ]
                                }
                              },
                              "resourceGroup": "NetworkWatcherRG",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ],
                          "variables": {
                            "resourceGroupName": "[split(parameters('networkSecurityGroup'), '/')[4]]",
                            "securityGroupName": "[split(parameters('networkSecurityGroup'), '/')[8]]",
                            "storageAccountName": "[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]"
                          }
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Network/networkWatchers/flowLogs/enabled"
                        }
                      ]
                    },
                    "existenceScope": "resourceGroup",
                    "name": "[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]",
                    "resourceGroupName": "[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
                      "/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12",
                      "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                      "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab",
                      "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Network/networkWatchers/flowlogs"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Nsg-FlowLogs-to-LA",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.693015Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.693015Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-postgresql-sslenforcement": {
            "properties": {
              "displayName": "Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL ",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:56.0033237Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server",
                    "displayName": "Effect Azure Database for PostgreSQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version Azure Database for PostgreSQL server to enforce",
                    "displayName": "Select version for PostgreSQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.DBforPostgreSQL/servers",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.DBforPostgreSQL/servers/sslEnforcement",
                          "notEquals": "Enabled"
                        },
                        {
                          "field": "Microsoft.DBforPostgreSQL/servers/minimalTlsVersion",
                          "less": "[parameters('minimalTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "minimalTlsVersion": {
                            "value": "[parameters('minimalTlsVersion')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "minimalTlsVersion": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-12-01",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'))]",
                              "properties": {
                                "minimalTlsVersion": "[parameters('minimalTlsVersion')]",
                                "sslEnforcement": "[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]"
                              },
                              "type": "Microsoft.DBforPostgreSQL/servers"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "Enabled",
                          "field": "Microsoft.DBforPostgreSQL/servers/sslEnforcement"
                        },
                        {
                          "equals": "[parameters('minimalTlsVersion')]",
                          "field": "Microsoft.DBforPostgreSQL/servers/minimalTlsVersion"
                        }
                      ]
                    },
                    "name": "current",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.DBforPostgreSQL/servers"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-PostgreSQL-sslEnforcement",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.9733743Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.9733743Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-private-dns-generic": {
            "properties": {
              "displayName": "Deploy-Private-DNS-Generic",
              "policyType": "Custom",
              "mode": "All",
              "description": "Configure private DNS zone group to override the DNS resolution for PaaS services private endpoint. See https://aka.ms/pepdnszones for information on values to provide to parameters in this policy.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Networking",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.1449331Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "evaluationDelay": {
                  "type": "String",
                  "metadata": {
                    "description": "The delay in evaluation of the policy. Review delay options at https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effect-deploy-if-not-exists",
                    "displayName": "Evaluation Delay"
                  },
                  "defaultValue": "PT10M"
                },
                "groupId": {
                  "type": "String",
                  "metadata": {
                    "description": "The group ID of the PaaS private endpoint. Also referred to as subresource.",
                    "displayName": "PaaS Private endpoint group ID (subresource)"
                  }
                },
                "location": {
                  "type": "String",
                  "metadata": {
                    "description": "Specify the Private Endpoint location",
                    "displayName": "Location (Specify the Private Endpoint location)",
                    "strongType": "location"
                  },
                  "defaultValue": "northeurope"
                },
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "assignPermissions": true,
                    "description": "The private DNS zone name required for specific PaaS Services to resolve a private DNS Zone.",
                    "displayName": "Private DNS Zone ID for PaaS services",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                },
                "resourceType": {
                  "type": "String",
                  "metadata": {
                    "description": "The PaaS endpoint resource type.",
                    "displayName": "PaaS private endpoint resource type"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "[parameters('location')]",
                      "field": "location"
                    },
                    {
                      "equals": "Microsoft.Network/privateEndpoints",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]",
                        "where": {
                          "allOf": [
                            {
                              "contains": "[parameters('resourceType')]",
                              "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId"
                            },
                            {
                              "equals": "[parameters('groupId')]",
                              "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"
                            }
                          ]
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "privateDnsZoneId": {
                              "type": "string"
                            },
                            "privateEndpointName": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2020-03-01",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "PaaS-Service-Private-DNS-Zone-Config",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              },
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups"
                            }
                          ]
                        }
                      }
                    },
                    "evaluationDelay": "[parameters('evaluationDelay')]",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Private-DNS-Generic",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Private-DNS-Generic",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.0930812Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.0930812Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sql-auditingsettings": {
            "properties": {
              "displayName": "Deploy SQL database auditing settings",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:00.9515505Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Sql/servers/databases",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "sqlServerDataBaseName": {
                            "value": "[field('name')]"
                          },
                          "sqlServerName": {
                            "value": "[first(split(field('fullname'),'/'))]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "sqlServerDataBaseName": {
                              "type": "String"
                            },
                            "sqlServerName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-03-01-preview",
                              "name": "[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]",
                              "properties": {
                                "auditActionsAndGroups": [
                                  "BATCH_COMPLETED_GROUP",
                                  "DATABASE_OBJECT_CHANGE_GROUP",
                                  "SCHEMA_OBJECT_CHANGE_GROUP",
                                  "BACKUP_RESTORE_GROUP",
                                  "APPLICATION_ROLE_CHANGE_PASSWORD_GROUP",
                                  "DATABASE_PRINCIPAL_CHANGE_GROUP",
                                  "DATABASE_PRINCIPAL_IMPERSONATION_GROUP",
                                  "DATABASE_ROLE_MEMBER_CHANGE_GROUP",
                                  "USER_CHANGE_PASSWORD_GROUP",
                                  "DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP",
                                  "DATABASE_OBJECT_PERMISSION_CHANGE_GROUP",
                                  "DATABASE_PERMISSION_CHANGE_GROUP",
                                  "SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP",
                                  "SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP",
                                  "FAILED_DATABASE_AUTHENTICATION_GROUP"
                                ],
                                "isAzureMonitorTargetEnabled": true,
                                "state": "enabled"
                              },
                              "type": "Microsoft.Sql/servers/databases/auditingSettings"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "enabled",
                          "field": "Microsoft.Sql/servers/databases/auditingSettings/state"
                        },
                        {
                          "equals": "true",
                          "field": "Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled"
                        }
                      ]
                    },
                    "name": "default",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
                    ],
                    "type": "Microsoft.Sql/servers/databases/auditingSettings"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Sql-AuditingSettings",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:00.7315045Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:00.7315045Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sql-mintls": {
            "properties": {
              "displayName": "SQL servers deploys a specific min TLS version requirement.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.7883047Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version SQL servers",
                    "displayName": "Effect SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version SQL servers to enforce",
                    "displayName": "Select version for SQL server"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Sql/servers",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Sql/servers/minimalTlsVersion",
                      "less": "[parameters('minimalTlsVersion')]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "minimalTlsVersion": {
                            "value": "[parameters('minimalTlsVersion')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "minimalTlsVersion": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2019-06-01-preview",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'))]",
                              "properties": {
                                "minimalTlsVersion": "[parameters('minimalTlsVersion')]"
                              },
                              "type": "Microsoft.Sql/servers"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('minimalTlsVersion')]",
                          "field": "Microsoft.Sql/servers/minimalTlsVersion"
                        }
                      ]
                    },
                    "name": "current",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437"
                    ],
                    "type": "Microsoft.Sql/servers"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-SQL-minTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.7356919Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.7356919Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sql-securityalertpolicies": {
            "properties": {
              "displayName": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.1",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:04.8332318Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "emailAddresses": {
                  "type": "Array",
                  "defaultValue": [
                    "admin@contoso.com",
                    "admin@fabrikam.com"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Sql/servers/databases",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "emailAddresses": {
                            "value": "[parameters('emailAddresses')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "sqlServerDataBaseName": {
                            "value": "[field('name')]"
                          },
                          "sqlServerName": {
                            "value": "[first(split(field('fullname'),'/'))]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "emailAddresses": {
                              "type": "Array"
                            },
                            "location": {
                              "type": "String"
                            },
                            "sqlServerDataBaseName": {
                              "type": "String"
                            },
                            "sqlServerName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2018-06-01-preview",
                              "name": "[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]",
                              "properties": {
                                "disabledAlerts": [
                                  ""
                                ],
                                "emailAccountAdmins": true,
                                "emailAddresses": "[parameters('emailAddresses')]",
                                "retentionDays": 0,
                                "state": "Enabled",
                                "storageAccountAccessKey": "",
                                "storageEndpoint": null
                              },
                              "type": "Microsoft.Sql/servers/databases/securityAlertPolicies"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "Enabled",
                          "field": "Microsoft.Sql/servers/databases/securityAlertPolicies/state"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
                    ],
                    "type": "Microsoft.Sql/servers/databases/securityAlertPolicies"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Sql-SecurityAlertPolicies",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:04.6663709Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:04.6663709Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sql-tde": {
            "properties": {
              "displayName": "[Deprecated] Deploy SQL Database Transparent Data Encryption",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment. Please use this policy instead https://www.azadvertizer.net/azpolicyadvertizer/86a912f6-9a06-4e26-b447-11b16ba8659f.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "86a912f6-9a06-4e26-b447-11b16ba8659f",
                "version": "1.1.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.9042856Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "excludedDatabases": {
                  "type": "Array",
                  "metadata": {
                    "description": "Array of databases that are excluded from this policy",
                    "displayName": "Excluded Databases"
                  },
                  "defaultValue": [
                    "master",
                    "model",
                    "tempdb",
                    "msdb",
                    "resource"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Sql/servers/databases",
                      "field": "type"
                    },
                    {
                      "field": "name",
                      "notIn": "[parameters('excludedDatabases')]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "sqlServerDataBaseName": {
                            "value": "[field('name')]"
                          },
                          "sqlServerName": {
                            "value": "[first(split(field('fullname'),'/'))]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "sqlServerDataBaseName": {
                              "type": "String"
                            },
                            "sqlServerName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2014-04-01",
                              "name": "[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]",
                              "properties": {
                                "status": "Enabled"
                              },
                              "type": "Microsoft.Sql/servers/databases/transparentDataEncryption"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "Enabled",
                          "field": "Microsoft.Sql/transparentDataEncryption.status"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
                    ],
                    "type": "Microsoft.Sql/servers/databases/transparentDataEncryption"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Sql-Tde",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.8490396Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.8490396Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sql-vulnerabilityassessments": {
            "properties": {
              "displayName": "[Deprecated]: Deploy SQL Database vulnerability Assessments",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deploy-Sql-vulnerabilityAssessments_20230706.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Deploy-Sql-vulnerabilityAssessments_20230706",
                "version": "1.0.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.6554152Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "vulnerabilityAssessmentsEmail": {
                  "type": "String",
                  "metadata": {
                    "description": "The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'",
                    "displayName": "The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'"
                  }
                },
                "vulnerabilityAssessmentsStorageID": {
                  "type": "String",
                  "metadata": {
                    "assignPermissions": true,
                    "description": "The storage account ID to store assessments",
                    "displayName": "The storage account ID to store assessments"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Sql/servers/databases",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "sqlServerDataBaseName": {
                            "value": "[field('name')]"
                          },
                          "sqlServerName": {
                            "value": "[first(split(field('fullname'),'/'))]"
                          },
                          "vulnerabilityAssessmentsEmail": {
                            "value": "[parameters('vulnerabilityAssessmentsEmail')]"
                          },
                          "vulnerabilityAssessmentsStorageID": {
                            "value": "[parameters('vulnerabilityAssessmentsStorageID')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "sqlServerDataBaseName": {
                              "type": "String"
                            },
                            "sqlServerName": {
                              "type": "String"
                            },
                            "vulnerabilityAssessmentsEmail": {
                              "type": "String"
                            },
                            "vulnerabilityAssessmentsStorageID": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-03-01-preview",
                              "name": "[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]",
                              "properties": {
                                "recurringScans": {
                                  "emailSubscriptionAdmins": false,
                                  "emails": [
                                    "[parameters('vulnerabilityAssessmentsEmail')]"
                                  ],
                                  "isEnabled": true
                                },
                                "storageAccountAccessKey": "[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]",
                                "storageContainerPath": "[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]"
                              },
                              "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('vulnerabilityAssessmentsEmail')]",
                          "field": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails"
                        },
                        {
                          "equals": true,
                          "field": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                      "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"
                    ],
                    "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Sql-vulnerabilityAssessments",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.5916216Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.5916216Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sql-vulnerabilityassessments_20230706": {
            "properties": {
              "displayName": "Deploy SQL Database Vulnerability Assessments",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy SQL Database Vulnerability Assessments when it does not exist in the deployment, and save results to the storage account specified in the parameters.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "replacesPolicy": "Deploy-Sql-vulnerabilityAssessments",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:06.3856464Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "vulnerabilityAssessmentsEmail": {
                  "type": "Array",
                  "metadata": {
                    "description": "The email address(es) to send alerts.",
                    "displayName": "The email address(es) to send alerts."
                  }
                },
                "vulnerabilityAssessmentsStorageID": {
                  "type": "String",
                  "metadata": {
                    "assignPermissions": true,
                    "description": "The storage account ID to store assessments",
                    "displayName": "The storage account ID to store assessments"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Sql/servers/databases",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "sqlServerDataBaseName": {
                            "value": "[field('name')]"
                          },
                          "sqlServerName": {
                            "value": "[first(split(field('fullname'),'/'))]"
                          },
                          "vulnerabilityAssessmentsEmail": {
                            "value": "[parameters('vulnerabilityAssessmentsEmail')]"
                          },
                          "vulnerabilityAssessmentsStorageID": {
                            "value": "[parameters('vulnerabilityAssessmentsStorageID')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "sqlServerDataBaseName": {
                              "type": "String"
                            },
                            "sqlServerName": {
                              "type": "String"
                            },
                            "vulnerabilityAssessmentsEmail": {
                              "type": "Array"
                            },
                            "vulnerabilityAssessmentsStorageID": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2017-03-01-preview",
                              "name": "[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]",
                              "properties": {
                                "recurringScans": {
                                  "emailSubscriptionAdmins": false,
                                  "emails": "[parameters('vulnerabilityAssessmentsEmail')]",
                                  "isEnabled": true
                                },
                                "storageAccountAccessKey": "[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]",
                                "storageContainerPath": "[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]"
                              },
                              "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "count": {
                            "field": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*]",
                            "where": {
                              "notIn": "[parameters('vulnerabilityAssessmentsEmail')]",
                              "value": "current(Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*])"
                            }
                          },
                          "greater": 0
                        },
                        {
                          "equals": true,
                          "field": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                      "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                      "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"
                    ],
                    "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Sql-vulnerabilityAssessments_20230706",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:06.327568Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:06.327568Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-sqlmi-mintls": {
            "properties": {
              "displayName": "SQL managed instances deploy a specific min TLS version requirement.",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.3.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.1735327Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version SQL servers",
                    "displayName": "Effect SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "minimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version SQL servers to enforce",
                    "displayName": "Select version for SQL server"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Sql/managedInstances",
                      "field": "type"
                    },
                    {
                      "field": "Microsoft.Sql/managedInstances/minimalTlsVersion",
                      "less": "[parameters('minimalTlsVersion')]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "minimalTlsVersion": {
                            "value": "[parameters('minimalTlsVersion')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "minimalTlsVersion": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2020-02-02-preview",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'))]",
                              "properties": {
                                "minimalTlsVersion": "[parameters('minimalTlsVersion')]"
                              },
                              "type": "Microsoft.Sql/managedInstances"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "evaluationDelay": "AfterProvisioningSuccess",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "[parameters('minimalTlsVersion')]",
                          "field": "Microsoft.Sql/managedInstances/minimalTlsVersion"
                        }
                      ]
                    },
                    "name": "current",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/4939a1f6-9ae0-4e48-a1e0-f2cbe897382d"
                    ],
                    "type": "Microsoft.Sql/managedInstances"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-SqlMi-minTLS",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.1452733Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.1452733Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-storage-sslenforcement": {
            "properties": {
              "displayName": "Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS ",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.3.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:58.7707793Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy minimum TLS version Azure STorage",
                    "displayName": "Effect Azure Storage"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "minimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version minimum TLS version Azure STorage to enforce",
                    "displayName": "Select TLS version for Azure Storage server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_1",
                    "TLS1_0"
                  ],
                  "defaultValue": "TLS1_2"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Storage/storageAccounts",
                      "field": "type"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly",
                          "notEquals": "true"
                        },
                        {
                          "field": "Microsoft.Storage/storageAccounts/minimumTlsVersion",
                          "less": "[parameters('minimumTlsVersion')]"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[field('location')]"
                          },
                          "minimumTlsVersion": {
                            "value": "[parameters('minimumTlsVersion')]"
                          },
                          "resourceName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "location": {
                              "type": "String"
                            },
                            "minimumTlsVersion": {
                              "type": "String"
                            },
                            "resourceName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2019-06-01",
                              "location": "[parameters('location')]",
                              "name": "[concat(parameters('resourceName'))]",
                              "properties": {
                                "minimumTlsVersion": "[parameters('minimumTlsVersion')]",
                                "supportsHttpsTrafficOnly": true
                              },
                              "type": "Microsoft.Storage/storageAccounts"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "true",
                          "field": "Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly"
                        },
                        {
                          "equals": "[parameters('minimumTlsVersion')]",
                          "field": "Microsoft.Storage/storageAccounts/minimumTlsVersion"
                        }
                      ]
                    },
                    "name": "current",
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"
                    ],
                    "type": "Microsoft.Storage/storageAccounts"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Storage-sslEnforcement",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:58.7302605Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:58.7302605Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-userassignedmanagedidentity-vminsights": {
            "properties": {
              "displayName": "[Deprecated]: Deploy User Assigned Managed Identity for VM Insights",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Policy is deprecated as it's no longer required. User-Assigned Management Identity is now centralized and deployed by Azure Landing Zones to the Management Subscription.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Managed Identity",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:59.3590019Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "bringYourOwnUserAssignedManagedIdentity": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "Enable this to use your pre-created user-assigned managed identity. The pre-created identity MUST exist within the subscription otherwise the policy deployment will fail. If enabled, ensure that the User-Assigned Identity Name and Identity Resource Group Name parameters match the pre-created identity. If not enabled, the policy will create per subscription, per resource user-assigned managed identities in a new resource group named 'Built-In-Identity-RG'.",
                    "displayName": "Bring Your Own User-Assigned Identity"
                  },
                  "allowedValues": [
                    true,
                    false
                  ]
                },
                "builtInIdentityResourceGroupLocation": {
                  "type": "String",
                  "metadata": {
                    "description": "The location of the resource group 'Built-In-Identity-RG' created by the policy. This parameter is only used when 'Bring Your Own User Assigned Identity' parameter is false.",
                    "displayName": "Built-In-Identity-RG Location"
                  },
                  "defaultValue": "eastus"
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "The effect determines what happens when the policy rule is evaluated to match.",
                    "displayName": "Policy Effect"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "identityResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "The resource group in which the pre-created user-assigned managed identity resides.",
                    "displayName": "User-Assigned Managed Identity Resource Group Name"
                  },
                  "defaultValue": ""
                },
                "userAssignedIdentityName": {
                  "type": "String",
                  "metadata": {
                    "description": "The name of the pre-created user-assigned managed identity.",
                    "displayName": "User-Assigned Managed Identity Name"
                  },
                  "defaultValue": ""
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Compute/virtualMachines",
                      "field": "type"
                    },
                    {
                      "greaterOrEquals": "2018-10-01",
                      "value": "[requestContext().apiVersion]"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "location": "eastus",
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "bringYourOwnUserAssignedManagedIdentity": {
                            "value": "[parameters('bringYourOwnUserAssignedManagedIdentity')]"
                          },
                          "builtInIdentityResourceGroupLocation": {
                            "value": "[parameters('builtInIdentityResourceGroupLocation')]"
                          },
                          "identityResourceGroup": {
                            "value": "[if(parameters('bringYourOwnUserAssignedManagedIdentity'), parameters('identityResourceGroup'), 'Built-In-Identity-RG')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "resourceId": {
                            "value": "[field('id')]"
                          },
                          "uaName": {
                            "value": "[if(parameters('bringYourOwnUserAssignedManagedIdentity'), parameters('userAssignedIdentityName'), 'Built-In-Identity')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          },
                          "vmResourceGroup": {
                            "value": "[resourceGroup().name]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.1",
                          "parameters": {
                            "bringYourOwnUserAssignedManagedIdentity": {
                              "type": "bool"
                            },
                            "builtInIdentityResourceGroupLocation": {
                              "type": "string"
                            },
                            "identityResourceGroup": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string"
                            },
                            "resourceId": {
                              "type": "string"
                            },
                            "uaName": {
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            },
                            "vmResourceGroup": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2020-06-01",
                              "location": "[parameters('builtInIdentityResourceGroupLocation')]",
                              "name": "[parameters('identityResourceGroup')]",
                              "type": "Microsoft.Resources/resourceGroups"
                            },
                            {
                              "apiVersion": "2020-06-01",
                              "condition": "[parameters('bringYourOwnUserAssignedManagedIdentity')]",
                              "dependsOn": [
                                "[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]"
                              ],
                              "name": "[variables('deployUALockName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "uaName": {
                                    "value": "[parameters('uaName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "uaName": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2018-11-30",
                                      "location": "[parameters('location')]",
                                      "name": "[parameters('uaName')]",
                                      "type": "Microsoft.ManagedIdentity/userAssignedIdentities"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[parameters('identityResourceGroup')]",
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2020-06-01",
                              "condition": "[not(parameters('bringYourOwnUserAssignedManagedIdentity'))]",
                              "dependsOn": [
                                "[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]"
                              ],
                              "name": "[variables('deployUAName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "uaName": {
                                    "value": "[variables('uaNameWithLocation')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "uaName": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2018-11-30",
                                      "location": "[parameters('location')]",
                                      "name": "[parameters('uaName')]",
                                      "type": "Microsoft.ManagedIdentity/userAssignedIdentities"
                                    },
                                    {
                                      "apiVersion": "2016-09-01",
                                      "dependsOn": [
                                        "[parameters('uaName')]"
                                      ],
                                      "name": "[concat(parameters('uaName'), '/Microsoft.Authorization/', 'CanNotDeleteLock-', parameters('uaName'))]",
                                      "properties": {
                                        "level": "CanNotDelete",
                                        "notes": "Please do not delete this User-Assigned Identity since extensions enabled by Azure Policy are relying on their existence."
                                      },
                                      "type": "Microsoft.ManagedIdentity/userAssignedIdentities/providers/locks"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[parameters('identityResourceGroup')]",
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2020-06-01",
                              "dependsOn": [
                                "[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]",
                                "[variables('deployUAName')]"
                              ],
                              "location": "[parameters('location')]",
                              "name": "[variables('deployGetResourceProperties')]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "outputs": {
                                    "resource": {
                                      "type": "object",
                                      "value": "[reference(parameters('resourceId'), '2019-07-01', 'Full')]"
                                    }
                                  },
                                  "resources": []
                                }
                              },
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2020-06-01",
                              "dependsOn": [
                                "[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]",
                                "[variables('deployUAName')]",
                                "[variables('deployGetResourceProperties')]"
                              ],
                              "name": "[concat(variables('deployAssignUAName'))]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "identityType": {
                                    "value": "[if(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.type, '')]"
                                  },
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "uaId": {
                                    "value": "[if(parameters('bringYourOwnUserAssignedManagedIdentity'), variables('precreatedUaId'), variables('autocreatedUaId'))]"
                                  },
                                  "userAssignedIdentities": {
                                    "value": "[if(and(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), contains(reference(variables('deployGetResourceProperties')).outputs.resource.value.identity, 'userAssignedIdentities')), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.userAssignedIdentities, createObject())]"
                                  },
                                  "vmName": {
                                    "value": "[parameters('vmName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "parameters": {
                                    "identityType": {
                                      "type": "string"
                                    },
                                    "location": {
                                      "type": "string"
                                    },
                                    "uaId": {
                                      "type": "string"
                                    },
                                    "userAssignedIdentities": {
                                      "type": "object"
                                    },
                                    "vmName": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "apiVersion": "2019-07-01",
                                      "condition": "[not(variables('resourceWithSingleUAI'))]",
                                      "identity": {
                                        "type": "[variables('identityTypeValue')]",
                                        "userAssignedIdentities": "[variables('userAssignedIdentitiesValue')]"
                                      },
                                      "location": "[parameters('location')]",
                                      "name": "[parameters('vmName')]",
                                      "type": "Microsoft.Compute/virtualMachines"
                                    }
                                  ],
                                  "variables": {
                                    "identityTypeValue": "[if(contains(parameters('identityType'), 'SystemAssigned'), 'SystemAssigned,UserAssigned', 'UserAssigned')]",
                                    "resourceWithSingleUAI": "[and(equals(parameters('identityType'), 'UserAssigned'), equals(string(length(parameters('userAssignedIdentities'))), '1'))]",
                                    "userAssignedIdentitiesValue": "[union(parameters('userAssignedIdentities'), createObject(parameters('uaId'), createObject()))]"
                                  }
                                }
                              },
                              "resourceGroup": "[parameters('vmResourceGroup')]",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ],
                          "variables": {
                            "autocreatedUaId": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')), '-', parameters('location'))]",
                            "deployAssignUAName": "[concat('deployAssignUA-', uniqueString(deployment().name))]",
                            "deployGetResourceProperties": "[concat('deployGetResourceProperties-', uniqueString(deployment().name))]",
                            "deployUALockName": "[concat('deployUALock-', uniqueString(deployment().name))]",
                            "deployUAName": "[concat('deployUA-', uniqueString(deployment().name))]",
                            "precreatedUaId": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')))]",
                            "uaNameWithLocation": "[concat(parameters('uaName'),'-', parameters('location'))]"
                          }
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "evaluationDelay": "AfterProvisioning",
                    "existenceCondition": {
                      "anyOf": [
                        {
                          "allOf": [
                            {
                              "contains": "UserAssigned",
                              "field": "identity.type"
                            },
                            {
                              "containsKey": "[if(parameters('bringYourOwnUserAssignedManagedIdentity'), concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('userAssignedIdentityName'))), concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/Built-In-Identity-RG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/Built-In-Identity-', field('location')))]",
                              "field": "identity.userAssignedIdentities"
                            }
                          ]
                        },
                        {
                          "allOf": [
                            {
                              "equals": "UserAssigned",
                              "field": "identity.type"
                            },
                            {
                              "equals": "1",
                              "value": "[string(length(field('identity.userAssignedIdentities')))]"
                            }
                          ]
                        }
                      ]
                    },
                    "name": "[field('name')]",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Compute/virtualMachines"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-UserAssignedManagedIdentity-VMInsights",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-UserAssignedManagedIdentity-VMInsights",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:59.3084885Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:59.3084885Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-vm-autoshutdown": {
            "properties": {
              "displayName": "Deploy Virtual Machine Auto Shutdown Schedule",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploys an auto shutdown schedule to a virtual machine",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Compute",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:57.2285632Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "EnableNotification": {
                  "type": "string",
                  "metadata": {
                    "description": "If notifications are enabled for this schedule (i.e. Enabled, Disabled).",
                    "displayName": "Send Notification before auto-shutdown"
                  },
                  "allowedValues": [
                    "Disabled",
                    "Enabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "NotificationEmailRecipient": {
                  "type": "string",
                  "metadata": {
                    "description": "Email address to be used for notification",
                    "displayName": "Email Address"
                  },
                  "defaultValue": ""
                },
                "NotificationWebhookUrl": {
                  "type": "string",
                  "metadata": {
                    "description": "A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.",
                    "displayName": "Webhook URL"
                  },
                  "defaultValue": ""
                },
                "time": {
                  "type": "String",
                  "metadata": {
                    "description": "Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM",
                    "displayName": "Scheduled Shutdown Time"
                  },
                  "defaultValue": "0000"
                },
                "timeZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "The time zone ID (e.g. Pacific Standard time).",
                    "displayName": "Time zone"
                  },
                  "defaultValue": "UTC"
                }
              },
              "policyRule": {
                "if": {
                  "equals": "Microsoft.Compute/virtualMachines",
                  "field": "type"
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "incremental",
                        "parameters": {
                          "EnableNotification": {
                            "value": "[parameters('EnableNotification')]"
                          },
                          "NotificationEmailRecipient": {
                            "value": "[parameters('NotificationEmailRecipient')]"
                          },
                          "NotificationWebhookUrl": {
                            "value": "[parameters('NotificationWebhookUrl')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "time": {
                            "value": "[parameters('time')]"
                          },
                          "timeZoneId": {
                            "value": "[parameters('timeZoneId')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "EnableNotification": {
                              "defaultValue": "",
                              "metadata": {
                                "description": "If notifications are enabled for this schedule (i.e. Enabled, Disabled)."
                              },
                              "type": "string"
                            },
                            "NotificationEmailRecipient": {
                              "defaultValue": "",
                              "metadata": {
                                "description": "Email address to be used for notification"
                              },
                              "type": "string"
                            },
                            "NotificationWebhookUrl": {
                              "defaultValue": "",
                              "metadata": {
                                "description": "A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen."
                              },
                              "type": "string"
                            },
                            "location": {
                              "type": "string"
                            },
                            "time": {
                              "defaultValue": "",
                              "metadata": {
                                "description": "Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM"
                              },
                              "type": "string"
                            },
                            "timeZoneId": {
                              "defaultValue": "",
                              "metadata": {
                                "description": "The time zone ID (e.g. Pacific Standard time)."
                              },
                              "type": "string"
                            },
                            "vmName": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2018-09-15",
                              "location": "[parameters('location')]",
                              "name": "[concat('shutdown-computevm-',parameters('vmName'))]",
                              "properties": {
                                "dailyRecurrence": {
                                  "time": "[parameters('time')]"
                                },
                                "notificationSettings": {
                                  "emailRecipient": "[parameters('NotificationEmailRecipient')]",
                                  "notificationLocale": "en",
                                  "status": "[parameters('EnableNotification')]",
                                  "timeInMinutes": 30,
                                  "webhookUrl": "[parameters('NotificationWebhookUrl')]"
                                },
                                "status": "Enabled",
                                "targetResourceId": "[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))]",
                                "taskType": "ComputeVmShutdownTask",
                                "timeZoneId": "[parameters('timeZoneId')]"
                              },
                              "type": "Microsoft.DevTestLab/schedules"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "ComputeVmShutdownTask",
                          "field": "Microsoft.DevTestLab/schedules/taskType"
                        },
                        {
                          "equals": "[concat(resourceGroup().id,'/providers/Microsoft.Compute/virtualMachines/',field('name'))]",
                          "field": "Microsoft.DevTestLab/schedules/targetResourceId"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
                    ],
                    "type": "Microsoft.DevTestLab/schedules"
                  },
                  "effect": "deployIfNotExists"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Vm-autoShutdown",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:57.1921377Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:57.1921377Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-vnet-hubspoke": {
            "properties": {
              "displayName": "Deploy Virtual Network with peering to the hub",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy deploys virtual network and peer to the hub",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:36:55.8156859Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "dnsServers": {
                  "type": "Array",
                  "metadata": {
                    "description": "Default domain servers for the vNET.",
                    "displayName": "DNSServers"
                  },
                  "defaultValue": []
                },
                "hubResourceId": {
                  "type": "String",
                  "metadata": {
                    "description": "Resource ID for the HUB vNet",
                    "displayName": "hubResourceId"
                  }
                },
                "vNetCidrRange": {
                  "type": "String",
                  "metadata": {
                    "description": "CIDR Range for the vNet",
                    "displayName": "vNetCidrRange"
                  }
                },
                "vNetLocation": {
                  "type": "String",
                  "metadata": {
                    "description": "Location for the vNet",
                    "displayName": "vNetLocation"
                  }
                },
                "vNetName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the landing zone vNet",
                    "displayName": "vNetName"
                  }
                },
                "vNetPeerUseRemoteGateway": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "Enable gateway transit for the LZ network",
                    "displayName": "vNetPeerUseRemoteGateway"
                  },
                  "defaultValue": false
                },
                "vNetRgName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the landing zone vNet RG",
                    "displayName": "vNetRgName"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Resources/subscriptions",
                      "field": "type"
                    }
                  ]
                },
                "then": {
                  "details": {
                    "ResourceGroupName": "[parameters('vNetRgName')]",
                    "deployment": {
                      "location": "northeurope",
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "dnsServers": {
                            "value": "[parameters('dnsServers')]"
                          },
                          "hubResourceId": {
                            "value": "[parameters('hubResourceId')]"
                          },
                          "vNetCidrRange": {
                            "value": "[parameters('vNetCidrRange')]"
                          },
                          "vNetLocation": {
                            "value": "[parameters('vNetLocation')]"
                          },
                          "vNetName": {
                            "value": "[parameters('vNetName')]"
                          },
                          "vNetPeerUseRemoteGateway": {
                            "value": "[parameters('vNetPeerUseRemoteGateway')]"
                          },
                          "vNetRgName": {
                            "value": "[parameters('vNetRgName')]"
                          }
                        },
                        "template": {
                          "$schema": "http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "dnsServers": {
                              "defaultValue": [],
                              "type": "Array"
                            },
                            "hubResourceId": {
                              "type": "String"
                            },
                            "vNetCidrRange": {
                              "type": "String"
                            },
                            "vNetLocation": {
                              "type": "String"
                            },
                            "vNetName": {
                              "type": "String"
                            },
                            "vNetPeerUseRemoteGateway": {
                              "defaultValue": false,
                              "type": "bool"
                            },
                            "vNetRgName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2021-04-01",
                              "dependsOn": [],
                              "location": "[parameters('vNetLocation')]",
                              "name": "[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "outputs": {},
                                  "parameters": {},
                                  "resources": [
                                    {
                                      "apiVersion": "2021-04-01",
                                      "location": "[parameters('vNetLocation')]",
                                      "name": "[parameters('vNetRgName')]",
                                      "properties": {},
                                      "type": "Microsoft.Resources/resourceGroups"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "type": "Microsoft.Resources/deployments"
                            },
                            {
                              "apiVersion": "2021-04-01",
                              "dependsOn": [
                                "[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]"
                              ],
                              "name": "[concat('alz-vnet-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "outputs": {},
                                  "parameters": {},
                                  "resources": [
                                    {
                                      "apiVersion": "2021-02-01",
                                      "dependsOn": [],
                                      "location": "[parameters('vNetLocation')]",
                                      "name": "[parameters('vNetName')]",
                                      "properties": {
                                        "addressSpace": {
                                          "addressPrefixes": [
                                            "[parameters('vNetCidrRange')]"
                                          ]
                                        },
                                        "dhcpOptions": {
                                          "dnsServers": "[parameters('dnsServers')]"
                                        }
                                      },
                                      "type": "Microsoft.Network/virtualNetworks"
                                    },
                                    {
                                      "apiVersion": "2021-02-01",
                                      "dependsOn": [
                                        "[parameters('vNetName')]"
                                      ],
                                      "name": "[concat(parameters('vNetName'), '/peerToHub')]",
                                      "properties": {
                                        "allowForwardedTraffic": true,
                                        "allowGatewayTransit": false,
                                        "allowVirtualNetworkAccess": true,
                                        "remoteVirtualNetwork": {
                                          "id": "[parameters('hubResourceId')]"
                                        },
                                        "useRemoteGateways": "[parameters('vNetPeerUseRemoteGateway')]"
                                      },
                                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings"
                                    },
                                    {
                                      "apiVersion": "2021-04-01",
                                      "dependsOn": [
                                        "[parameters('vNetName')]"
                                      ],
                                      "name": "[concat('alz-hub-peering-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "hubName": {
                                            "value": "[split(parameters('hubResourceId'),'/')[8]]"
                                          },
                                          "remoteVirtualNetwork": {
                                            "value": "[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "outputs": {},
                                          "parameters": {
                                            "hubName": {
                                              "defaultValue": false,
                                              "type": "String"
                                            },
                                            "remoteVirtualNetwork": {
                                              "defaultValue": false,
                                              "type": "String"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "apiVersion": "2021-02-01",
                                              "name": "[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]",
                                              "properties": {
                                                "allowForwardedTraffic": true,
                                                "allowGatewayTransit": true,
                                                "allowVirtualNetworkAccess": true,
                                                "remoteVirtualNetwork": {
                                                  "id": "[[parameters('remoteVirtualNetwork')]"
                                                },
                                                "useRemoteGateways": false
                                              },
                                              "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings"
                                            }
                                          ],
                                          "variables": {}
                                        }
                                      },
                                      "resourceGroup": "[split(parameters('hubResourceId'),'/')[4]]",
                                      "subscriptionId": "[split(parameters('hubResourceId'),'/')[2]]",
                                      "type": "Microsoft.Resources/deployments"
                                    }
                                  ],
                                  "variables": {}
                                }
                              },
                              "resourceGroup": "[parameters('vNetRgName')]",
                              "type": "Microsoft.Resources/deployments"
                            }
                          ],
                          "variables": {}
                        }
                      }
                    },
                    "deploymentScope": "subscription",
                    "existenceCondition": {
                      "allOf": [
                        {
                          "field": "name",
                          "like": "[parameters('vNetName')]"
                        },
                        {
                          "equals": "[parameters('vNetLocation')]",
                          "field": "location"
                        }
                      ]
                    },
                    "existenceScope": "resourceGroup",
                    "name": "[parameters('vNetName')]",
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                    ],
                    "type": "Microsoft.Network/virtualNetworks"
                  },
                  "effect": "deployIfNotExists"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-VNET-HubSpoke",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:36:55.7927081Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:36:55.7927081Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/deploy-windows-domainjoin": {
            "properties": {
              "displayName": "Deploy Windows Domain Join Extension with keyvault configuration",
              "policyType": "Custom",
              "mode": "Indexed",
              "description": "Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Guest Configuration",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:08.2873327Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "domainFQDN": {
                  "type": "String",
                  "metadata": {
                    "displayName": "domainFQDN"
                  }
                },
                "domainOUPath": {
                  "type": "String",
                  "metadata": {
                    "displayName": "domainOUPath"
                  }
                },
                "domainPassword": {
                  "type": "String",
                  "metadata": {
                    "displayName": "domainPassword"
                  }
                },
                "domainUsername": {
                  "type": "String",
                  "metadata": {
                    "displayName": "domainUsername"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "keyVaultResourceId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "keyVaultResourceId"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Compute/virtualMachines",
                      "field": "type"
                    },
                    {
                      "equals": "MicrosoftWindowsServer",
                      "field": "Microsoft.Compute/imagePublisher"
                    },
                    {
                      "equals": "WindowsServer",
                      "field": "Microsoft.Compute/imageOffer"
                    },
                    {
                      "anyOf": [
                        {
                          "field": "Microsoft.Compute/imageSku",
                          "like": "2008-R2-SP1*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSku",
                          "like": "2012-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSku",
                          "like": "2016-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSku",
                          "like": "2019-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSku",
                          "like": "2022-*"
                        },
                        {
                          "field": "Microsoft.Compute/imageSku",
                          "like": "2025-*"
                        }
                      ]
                    }
                  ]
                },
                "then": {
                  "details": {
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "parameters": {
                          "domainFQDN": {
                            "value": "[parameters('domainFQDN')]"
                          },
                          "domainOUPath": {
                            "value": "[parameters('domainOUPath')]"
                          },
                          "domainPassword": {
                            "reference": {
                              "keyVault": {
                                "id": "[parameters('keyVaultResourceId')]"
                              },
                              "secretName": "[parameters('domainPassword')]"
                            }
                          },
                          "domainUsername": {
                            "reference": {
                              "keyVault": {
                                "id": "[parameters('keyVaultResourceId')]"
                              },
                              "secretName": "[parameters('domainUsername')]"
                            }
                          },
                          "keyVaultResourceId": {
                            "value": "[parameters('keyVaultResourceId')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          },
                          "vmName": {
                            "value": "[field('name')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "outputs": {},
                          "parameters": {
                            "domainFQDN": {
                              "type": "String"
                            },
                            "domainOUPath": {
                              "type": "String"
                            },
                            "domainPassword": {
                              "type": "securestring"
                            },
                            "domainUsername": {
                              "type": "String"
                            },
                            "keyVaultResourceId": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            },
                            "vmName": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "apiVersion": "2015-06-15",
                              "location": "[resourceGroup().location]",
                              "name": "[concat(variables('vmName'),'/joindomain')]",
                              "properties": {
                                "autoUpgradeMinorVersion": true,
                                "protectedSettings": {
                                  "Password": "[parameters('domainPassword')]"
                                },
                                "publisher": "Microsoft.Compute",
                                "settings": {
                                  "Name": "[parameters('domainFQDN')]",
                                  "OUPath": "[parameters('domainOUPath')]",
                                  "Options": "[variables('domainJoinOptions')]",
                                  "Restart": "true",
                                  "User": "[parameters('domainUserName')]"
                                },
                                "type": "JsonADDomainExtension",
                                "typeHandlerVersion": "1.3"
                              },
                              "type": "Microsoft.Compute/virtualMachines/extensions"
                            }
                          ],
                          "variables": {
                            "domainJoinOptions": 3,
                            "vmName": "[parameters('vmName')]"
                          }
                        }
                      }
                    },
                    "existenceCondition": {
                      "allOf": [
                        {
                          "equals": "JsonADDomainExtension",
                          "field": "Microsoft.Compute/virtualMachines/extensions/type"
                        },
                        {
                          "equals": "Microsoft.Compute",
                          "field": "Microsoft.Compute/virtualMachines/extensions/publisher"
                        }
                      ]
                    },
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                      "/providers/Microsoft.Authorization/roleDefinitions/4633458b-17de-408a-b874-0445c86b69e6"
                    ],
                    "type": "Microsoft.Compute/virtualMachines/extensions"
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Deploy-Windows-DomainJoin",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:08.080267Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:08.080267Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/modify-nsg": {
            "properties": {
              "displayName": "Enforce specific configuration of Network Security Groups (NSG)",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy enforces the configuration of Network Security Groups (NSG).",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:01.3433917Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "nsgRuleAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Allow",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "nsgRuleDescription": {
                  "type": "string",
                  "defaultValue": "Deny any outbound traffic to the Internet"
                },
                "nsgRuleDestinationAddressPrefix": {
                  "type": "string",
                  "defaultValue": "Internet"
                },
                "nsgRuleDestinationPortRange": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "nsgRuleDirection": {
                  "type": "string",
                  "allowedValues": [
                    "Inbound",
                    "Outbound"
                  ],
                  "defaultValue": "Outbound"
                },
                "nsgRuleName": {
                  "type": "string",
                  "defaultValue": "DenyAnyInternetOutbound"
                },
                "nsgRulePriority": {
                  "type": "integer",
                  "defaultValue": 1000
                },
                "nsgRuleProtocol": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "nsgRuleSourceAddressPrefix": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "nsgRuleSourcePortRange": {
                  "type": "string",
                  "defaultValue": "*"
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/networkSecurityGroups",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*]"
                      },
                      "equals": 0
                    }
                  ]
                },
                "then": {
                  "details": {
                    "conflictEffect": "audit",
                    "operations": [
                      {
                        "field": "Microsoft.Network/networkSecurityGroups/securityRules[*]",
                        "operation": "add",
                        "value": {
                          "name": "[parameters('nsgRuleName')]",
                          "properties": {
                            "access": "[parameters('nsgRuleAccess')]",
                            "description": "[parameters('nsgRuleDescription')]",
                            "destinationAddressPrefix": "[parameters('nsgRuleDestinationAddressPrefix')]",
                            "destinationPortRange": "[parameters('nsgRuleDestinationPortRange')]",
                            "direction": "[parameters('nsgRuleDirection')]",
                            "priority": "[parameters('nsgRulePriority')]",
                            "protocol": "[parameters('nsgRuleProtocol')]",
                            "sourceAddressPrefix": "[parameters('nsgRuleSourceAddressPrefix')]",
                            "sourcePortRange": "[parameters('nsgRuleSourcePortRange')]"
                          }
                        }
                      }
                    ],
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ]
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Modify-NSG",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:01.2928846Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:01.2928846Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policydefinitions/modify-udr": {
            "properties": {
              "displayName": "Enforce specific configuration of User-Defined Routes (UDR)",
              "policyType": "Custom",
              "mode": "All",
              "description": "This policy enforces the configuration of User-Defined Routes (UDR) within a subnet.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:02.7840772Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "addressPrefix": {
                  "type": "string",
                  "metadata": {
                    "description": "The destination IP address range in CIDR notation that this Policy checks for within the UDR. Example: 0.0.0.0/0 to check for the presence of a default route.",
                    "displayName": "Address Prefix"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "nextHopIpAddress": {
                  "type": "string",
                  "metadata": {
                    "description": "The IP address packets should be forwarded to.",
                    "displayName": "Next Hop IP Address"
                  }
                },
                "nextHopType": {
                  "type": "string",
                  "metadata": {
                    "description": "The next hope type that the policy checks for within the inspected route. The value can be Virtual Network, Virtual Network Gateway, Internet, Virtual Appliance, or None.",
                    "displayName": "Next Hop Type"
                  },
                  "allowedValues": [
                    "VnetLocal",
                    "VirtualNetworkGateway",
                    "Internet",
                    "VirtualAppliance",
                    "None"
                  ]
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "equals": "Microsoft.Network/routeTables",
                      "field": "type"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/routeTables/routes[*]"
                      },
                      "equals": 0
                    }
                  ]
                },
                "then": {
                  "details": {
                    "conflictEffect": "audit",
                    "operations": [
                      {
                        "field": "Microsoft.Network/routeTables/routes[*]",
                        "operation": "add",
                        "value": {
                          "name": "default",
                          "properties": {
                            "addressPrefix": "[parameters('addressPrefix')]",
                            "nextHopIpAddress": "[parameters('nextHopIpAddress')]",
                            "nextHopType": "[parameters('nextHopType')]"
                          }
                        }
                      }
                    ],
                    "roleDefinitionIds": [
                      "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ]
                  },
                  "effect": "[parameters('effect')]"
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "Modify-UDR",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:02.7496303Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:02.7496303Z"
            }
          }
        },
        "PolicySetDefinitionsCustom": {
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/audit-trustedlaunch": {
            "properties": {
              "displayName": "Audit virtual machines for Trusted Launch support",
              "policyType": "Custom",
              "description": "Trusted Launch improves security of a Virtual Machine which requires VM SKU, OS Disk & OS Image to support it (Gen 2). To learn more about Trusted Launch, visit https://aka.ms/trustedlaunch.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Trusted Launch",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.8983675Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AuditDisksOsTrustedLaunch",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b03bb370-5249-4ea4-9fce-2552e87e45fa",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AuditTrustedLaunchEnabled",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c95b54ad-0614-4633-ab29-104b01235cbf",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Audit-TrustedLaunch",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.8538691Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.8538691Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/audit-unusedresourcescostoptimization": {
            "properties": {
              "displayName": "Unused resources driving cost should be avoided",
              "policyType": "Custom",
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Azure Policy Initiative as a cost control tool to reveal orphaned resources that are contributing cost.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cost Optimization",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.2654198Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effectDisks": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy for Microsoft.Compute/disks",
                    "displayName": "Disks Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectPublicIpAddresses": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy for Microsoft.Network/publicIpAddresses",
                    "displayName": "PublicIpAddresses Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectServerFarms": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy for Microsoft.Web/serverfarms",
                    "displayName": "ServerFarms Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AuditDisksUnusedResourcesCostOptimization",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectDisks')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AuditPublicIpAddressesUnusedResourcesCostOptimization",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectPublicIpAddresses')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AuditServerFarmsUnusedResourcesCostOptimization",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectServerFarms')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AuditAzureHybridBenefitUnusedResourcesCostOptimization",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
                  "parameters": {
                    "effect": {
                      "value": "Audit"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Audit-UnusedResourcesCostOptimization",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.2115076Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.2115076Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deny-publicpaasendpoints": {
            "properties": {
              "displayName": "Public network access should be disabled for PaaS services",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "5.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.4422551Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "ACRPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies the creation of Azure Container Registries with exposed public endpoints ",
                    "displayName": "Public network access on Azure Container Registry disabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AFSPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies the creation of Azure File Sync instances with exposed public endpoints ",
                    "displayName": "Public network access on Azure File Sync disabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AKSPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies  the creation of  Azure Kubernetes Service non-private clusters",
                    "displayName": "Public network access on AKS API should be disabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "ApiManPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of API Management services with exposed public endpoints",
                    "displayName": "Public network access should be disabled for API Management services"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "AppConfigPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of App Configuration with exposed public endpoints",
                    "displayName": "Public network access should be disabled for App Configuration"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AsPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of App Service apps with exposed public endpoints",
                    "displayName": "Public network access should be disabled for App Service apps"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AsePublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of App Service Environment apps with exposed public endpoints",
                    "displayName": "Public network access should be disabled for App Service Environment apps"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AsrVaultDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Azure Recovery Services vaults with exposed public endpoints",
                    "displayName": "Azure Recovery Services vaults should disable public network access"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AutomationPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Automation accounts with exposed public endpoints. Bots should be set to 'isolated only' mode",
                    "displayName": "Public network access should be disabled for Automation accounts"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "BatchPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Azure Batch Instances with exposed public endpoints",
                    "displayName": "Public network access should be disabled for Azure Batch Instances"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "BotServicePublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Bot Service with exposed public endpoints. Bots should be set to 'isolated only' mode",
                    "displayName": "Public network access should be disabled for Bot Service"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "ContainerAppsEnvironmentDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Container Apps Environment with exposed public endpoints",
                    "displayName": "Container Apps environment should disable public network access"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "CosmosPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies that Cosmos database accounts  are created with out public network access is disabled.",
                    "displayName": "Public network access should be disabled for CosmosDB"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "FunctionAppSlotPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Function apps with exposed public endpoints",
                    "displayName": "Public network access should be disabled for Function apps"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "FunctionPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Function apps with exposed public endpoints",
                    "displayName": "Public network access should be disabled for Function apps"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "KeyVaultPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints",
                    "displayName": "Public network access should be disabled for KeyVault"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "MariaDbPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Azure MariaDB with exposed public endpoints",
                    "displayName": "Public network access should be disabled for Azure MariaDB"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "MlPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Azure Machine Learning with exposed public endpoints",
                    "displayName": "Public network access should be disabled for Azure Machine Learning"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "MySQLFlexPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints",
                    "displayName": "Public network access should be disabled for MySQL Flexible Server"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "PostgreSQLFlexPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of PostgreSQL Flexible DB accounts with exposed public endpoints",
                    "displayName": "Public network access should be disabled for PostgreSql Flexible Server"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "RedisCachePublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Azure Cache for Redis with exposed public endpoints",
                    "displayName": "Public network access should be disabled for Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "SqlServerPublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of Sql servers with exposed public endpoints",
                    "displayName": "Public network access on Azure SQL Database should be disabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "StoragePublicIpDenyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints",
                    "displayName": "Public network access onStorage accounts should be disabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adfPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adxPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appSlotsPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "avdHostPoolPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "avdWorkspacePublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveSearchPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerAppsPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventGridPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventGridTopicPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubNamespacesPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "grafanaPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultManagedHsmDisablePublicNetwork": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "logicAppPublicNetworkAccessEffect": {
                  "type": "String",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "managedDiskPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "mySqlPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "postgreSqlPublicNetworkAccess": {
                  "type": "string",
                  "metadata": {
                    "description": "This policy denies creation of PostgreSQL DB accounts with exposed public endpoints",
                    "displayName": "Public network access should be disabled for PostgreSQL servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "serviceBusDisablePublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlManagedPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsPublicAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "synapsePublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "CosmosDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('CosmosPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KeyVaultDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('KeyVaultPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlServerDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlServerPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StoragePublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AKSDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AKSPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ACRDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ACRPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AFSDenyPaasPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AFSPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLFlexDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLFlexPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-PostgreSql-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('postgreSqlPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLFlexDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLFlexPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BatchDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('BatchPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MariaDbDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MariaDbPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MlDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MlPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisCacheDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisCachePublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BotServiceDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e8168db-69e3-4beb-9822-57cb59202a9d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('BotServicePublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AutomationDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AutomationPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AppConfigDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppConfigPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionAppSlotsDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/11c82d0c-db9f-4d7b-97c5-f3f9aa957da2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionAppSlotPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AseDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AsePublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AsDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AsPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ApiManDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ApiManPublicIpDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ContainerAppsEnvironmentDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d074ddf8-01a5-4b5e-a2b8-964aed452c0a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ContainerAppsEnvironmentDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerApps-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/783ea2a8-b8fd-46be-896a-9ae79643a0b1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerAppsPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AsrVaultDenyPublicIP",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9ebbbba3-4d65-4da9-bb67-b22cfaaff090",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AsrVaultDenyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-LogicApp-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('logicAppPublicNetworkAccessEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppSlots-Public",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/701a595d-38fb-4a66-ae6d-fb3735217622",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appSlotsPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-CognitiveSearch-PublicEndpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee980b6d-0eca-4501-8d54-f6290fd512c3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveSearchPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ManagedDisk-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8405fdab-1faf-48aa-b702-999c9c172094",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('managedDiskPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ADX-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/43bc7be6-5e69-4b0d-a2bb-e815557ca673",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adxPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Adf-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EventGrid-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8f774be-6aee-492a-9e29-486ef81f3a68",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EventGrid-Topic-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridTopicPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0602787f-9896-402a-a6e1-39ee63ee435e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubNamespacesPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Hms-PublicNetwork",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultManagedHsmDisablePublicNetwork')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-MySql-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mySqlPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sb-PublicEndpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cbd11fd3-3002-4907-b6c8-579f0e700e13",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('serviceBusDisablePublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Managed-Public-Endpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlManagedPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Public-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsPublicAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/38d8df46-cf4e-4073-8e03-48c24b29de0d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapsePublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Workspace-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/87ac3038-c07a-4b92-860d-29e270a4f3cd",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('avdWorkspacePublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Hostpool-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c25dcf31-878f-4eba-98eb-0818fdc6a334",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('avdHostPoolPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Grafana-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e8775d5a-73b7-4977-a39b-833ef0114628",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('grafanaPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deny-PublicPaaSEndpoints",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.2323324Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.2323324Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/denyaction-deleteprotection": {
            "properties": {
              "displayName": "DenyAction Delete - Activity Log Settings and Diagnostic Settings",
              "policyType": "Custom",
              "description": "Enforces DenyAction - Delete on Activity Log Settings and Diagnostic Settings.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Monitoring",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.6599321Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {},
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "DenyActionDelete-DiagnosticSettings",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DenyActionDelete-ActivityLogSettings",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs",
                  "parameters": {},
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/DenyAction-DeleteProtection",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "DenyAction-DeleteProtection",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.6229423Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.6229423Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-aum-checkupdates": {
            "properties": {
              "displayName": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines",
              "policyType": "Custom",
              "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Security Center",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:12.8291734Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "assessmentMode": {
                  "type": "String",
                  "metadata": {
                    "description": "Assessment mode for the machines.",
                    "displayName": "Assessment mode"
                  },
                  "allowedValues": [
                    "ImageDefault",
                    "AutomaticByPlatform"
                  ],
                  "defaultValue": "AutomaticByPlatform"
                },
                "locations": {
                  "type": "Array",
                  "metadata": {
                    "description": "The list of locations from which machines need to be targeted.",
                    "displayName": "Machines locations",
                    "strongType": "location"
                  },
                  "defaultValue": []
                },
                "tagOperator": {
                  "type": "String",
                  "metadata": {
                    "description": "Matching condition for resource tags",
                    "displayName": "Tag operator"
                  },
                  "allowedValues": [
                    "All",
                    "Any"
                  ],
                  "defaultValue": "Any"
                },
                "tagValues": {
                  "type": "Object",
                  "metadata": {
                    "description": "The list of tags that need to matched for getting target machines.",
                    "displayName": "Tags on machines"
                  },
                  "defaultValue": {}
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "azureUpdateManagerVmCheckUpdateWindows",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
                  "parameters": {
                    "assessmentMode": {
                      "value": "[parameters('assessmentMode')]"
                    },
                    "locations": {
                      "value": "[parameters('locations')]"
                    },
                    "osType": {
                      "value": "Windows"
                    },
                    "tagOperator": {
                      "value": "[parameters('tagOperator')]"
                    },
                    "tagValues": {
                      "value": "[parameters('tagValues')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "azureUpdateManagerVmCheckUpdateLinux",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
                  "parameters": {
                    "assessmentMode": {
                      "value": "[parameters('assessmentMode')]"
                    },
                    "locations": {
                      "value": "[parameters('locations')]"
                    },
                    "osType": {
                      "value": "Linux"
                    },
                    "tagOperator": {
                      "value": "[parameters('tagOperator')]"
                    },
                    "tagValues": {
                      "value": "[parameters('tagValues')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "azureUpdateManagerVmArcCheckUpdateWindows",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bfea026e-043f-4ff4-9d1b-bf301ca7ff46",
                  "parameters": {
                    "assessmentMode": {
                      "value": "[parameters('assessmentMode')]"
                    },
                    "locations": {
                      "value": "[parameters('locations')]"
                    },
                    "osType": {
                      "value": "Windows"
                    },
                    "tagOperator": {
                      "value": "[parameters('tagOperator')]"
                    },
                    "tagValues": {
                      "value": "[parameters('tagValues')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "azureUpdateManagerVmArcCheckUpdateLinux",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bfea026e-043f-4ff4-9d1b-bf301ca7ff46",
                  "parameters": {
                    "assessmentMode": {
                      "value": "[parameters('assessmentMode')]"
                    },
                    "locations": {
                      "value": "[parameters('locations')]"
                    },
                    "osType": {
                      "value": "Linux"
                    },
                    "tagOperator": {
                      "value": "[parameters('tagOperator')]"
                    },
                    "tagValues": {
                      "value": "[parameters('tagValues')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-AUM-CheckUpdates",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:12.536817Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:12.536817Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-diagnostics-loganalytics": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Diagnostic Settings to Azure Services",
              "policyType": "Custom",
              "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. This policy set is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Monitoring",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:14.4392567Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "ACILogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.",
                    "displayName": "Deploy Diagnostic Settings for Container Instances to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "ACRLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.",
                    "displayName": "Deploy Diagnostic Settings for Container Registry to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "AKSLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
                    "displayName": "Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "APIMgmtLogAnalyticsDestinationType": {
                  "type": "String",
                  "metadata": {
                    "description": "Destination table for the diagnostic setting for API Management to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'",
                    "displayName": "Destination table for the Diagnostic Setting for API Management to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "AzureDiagnostics",
                    "Dedicated"
                  ],
                  "defaultValue": "AzureDiagnostics"
                },
                "APIMgmtLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for API Management to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "APIforFHIRLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "AVDScalingPlansLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "AnalysisServiceLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "AppServiceLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "AppServiceWebappLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for App Service to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "ApplicationGatewayLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "AutomationLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Automation to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "BastionLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "BatchLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Batch to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "CDNEndpointsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "CognitiveServicesLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "CosmosLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "DataExplorerClusterLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "DataFactoryLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Data Factory to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "DataLakeAnalyticsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "DataLakeStoreLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "DatabricksLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Databricks to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "EventGridSubLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "EventGridTopicLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "EventHubLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "EventSystemTopicLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "ExpressRouteLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "FirewallLogAnalyticsDestinationType": {
                  "type": "String",
                  "metadata": {
                    "description": "Destination table for the diagnostic setting for Firewall to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'",
                    "displayName": "Destination table for the Diagnostic Setting for Firewall to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "AzureDiagnostics",
                    "Dedicated"
                  ],
                  "defaultValue": "AzureDiagnostics"
                },
                "FirewallLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Firewall to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "FrontDoorLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Front Door to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "FunctionAppLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "HDInsightLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for HDInsight to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "IotHubLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "KeyVaultLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Key Vault to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "LoadBalancerLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "LogAnalyticsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Log Analytics to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category Audit enabled",
                    "displayName": "Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "LogicAppsISELogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "LogicAppsWFLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MariaDBLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for MariaDB to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MediaServiceLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MlWorkspaceLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MySQLLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "NetworkNICLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "NetworkPublicIPNicLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "NetworkSecurityGroupsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "PostgreSQLLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "PowerBIEmbeddedLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "RedisCacheLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "RelayLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Relay to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLDBsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLElasticPoolsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLMLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SearchServicesLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Search Services to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "ServiceBusLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SignalRLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for SignalR to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "StorageAccountsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "StreamAnalyticsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "TimeSeriesInsightsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "TrafficManagerLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "VMSSLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "VNetGWLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
                    "displayName": "Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "VWanS2SVPNGWLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for VWAN S2S VPN gateway to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for VWAN S2S VPN gateway to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "VirtualMachinesLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "VirtualNetworkLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "WVDAppGroupsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "WVDHostPoolsLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "WVDWorkspaceLogAnalyticsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
                    "displayName": "Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "profileName": {
                  "type": "String",
                  "metadata": {
                    "description": "The diagnostic settings profile name",
                    "displayName": "Profile name"
                  },
                  "defaultValue": "setbypolicy"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "StorageAccountDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageAccountsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageAccountBlobServicesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageAccountsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageAccountFileServicesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageAccountsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageAccountQueueServicesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageAccountsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageAccountTableServicesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageAccountsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AVDScalingPlansLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WVDAppGroupsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WVDWorkspaceLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WVDHostPoolsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ACIDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ACILogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ACRDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ACRLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AKSDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
                  "parameters": {
                    "diagnosticsSettingNameToUse": {
                      "value": "[parameters('profileName')]"
                    },
                    "effect": {
                      "value": "[parameters('AKSLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AnalysisServiceLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('APIforFHIRLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "APIMgmtDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('APIMgmtLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "logAnalyticsDestinationType": {
                      "value": "[parameters('APIMgmtLogAnalyticsDestinationType')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ApplicationGatewayLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AutomationDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AutomationLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BastionDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('BastionLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BatchDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('BatchLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('CDNEndpointsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('CognitiveServicesLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "CosmosDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('CosmosLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DatabricksDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('DatabricksLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('DataExplorerClusterLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DataFactoryDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('DataFactoryLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('DataLakeStoreLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('DataLakeAnalyticsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "EventGridSubDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('EventGridSubLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('EventGridTopicLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "EventHubDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('EventHubLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('EventSystemTopicLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ExpressRouteLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FirewallDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FirewallLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "logAnalyticsDestinationType": {
                      "value": "[parameters('FirewallLogAnalyticsDestinationType')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FrontDoorDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FrontDoorLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionAppDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionAppLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "HDInsightDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('HDInsightLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "IotHubDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('IotHubLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KeyVaultDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('KeyVaultLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('LoadBalancerLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "LogAnalyticsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('LogAnalyticsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('LogicAppsISELogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('LogicAppsWFLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MariaDBDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MariaDBLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MediaServiceDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MediaServiceLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MlWorkspaceLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "NetworkNICDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('NetworkNICLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PowerBIEmbeddedLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('NetworkPublicIPNicLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "metricsEnabled": {
                      "value": "True"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
                  "parameters": {
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisCacheDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisCacheLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RelayDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RelayLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SearchServicesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SearchServicesLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ServiceBusDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ServiceBusLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SignalRDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SignalRLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
                  "parameters": {
                    "diagnosticsSettingNameToUse": {
                      "value": "[parameters('profileName')]"
                    },
                    "effect": {
                      "value": "[parameters('SQLDBsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLElasticPoolsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLMDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLMLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StreamAnalyticsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('TimeSeriesInsightsLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('TrafficManagerLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('VirtualNetworkLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('VirtualMachinesLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "VMSSDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('VMSSLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "VNetGWDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('VNetGWLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AppServiceDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceWebappLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "VWanS2SVPNGWDeployDiagnosticLogDeployLogAnalytics",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('VWanS2SVPNGWLogAnalyticsEffect')]"
                    },
                    "logAnalytics": {
                      "value": "[parameters('logAnalytics')]"
                    },
                    "profileName": {
                      "value": "[parameters('profileName')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:14.0792602Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:14.0792602Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-mdfc-config": {
            "properties": {
              "displayName": "[Deprecated]: Deploy Microsoft Defender for Cloud configuration",
              "policyType": "Custom",
              "description": "Deploy Microsoft Defender for Cloud configuration. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config_20240319.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Deploy-MDFC-Config_20240319",
                "version": "7.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:13.3621572Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "ascExportResourceGroupLocation": {
                  "type": "String",
                  "metadata": {
                    "description": "The location where the resource group and the export to Log Analytics workspace configuration are created.",
                    "displayName": "Resource Group location for the export to Log Analytics workspace configuration"
                  }
                },
                "ascExportResourceGroupName": {
                  "type": "String",
                  "metadata": {
                    "description": "The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.",
                    "displayName": "Resource Group name for the export to Log Analytics workspace configuration"
                  }
                },
                "emailSecurityContact": {
                  "type": "string",
                  "metadata": {
                    "description": "Provide email address for Microsoft Defender for Cloud contact details",
                    "displayName": "Security contacts email address"
                  }
                },
                "enableAscForApis": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForAppServices": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForArm": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForContainers": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForCosmosDbs": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForCspm": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForDns": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForKeyVault": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForOssDb": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForServers": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForServersVulnerabilityAssessments": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForSql": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForSqlOnVm": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForStorage": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Primary Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "minimalSeverity": {
                  "type": "string",
                  "metadata": {
                    "description": "Defines the minimal alert severity which will be sent as email notifications",
                    "displayName": "Minimal severity"
                  },
                  "allowedValues": [
                    "High",
                    "Medium",
                    "Low"
                  ],
                  "defaultValue": "High"
                },
                "vulnerabilityAssessmentProvider": {
                  "type": "String",
                  "metadata": {
                    "description": "Select the vulnerability assessment solution to provision to machines.",
                    "displayName": "Vulnerability assessment provider type"
                  },
                  "allowedValues": [
                    "default",
                    "mdeTvm"
                  ],
                  "defaultValue": "default"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "defenderForOssDb",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForOssDb')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForVM",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForServers')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForVMVulnerabilityAssessment",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForServersVulnerabilityAssessments')]"
                    },
                    "vaType": {
                      "value": "[parameters('vulnerabilityAssessmentProvider')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlServerVirtualMachines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForSqlOnVm')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForAppServices",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForAppServices')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForStorageAccountsV2",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForStorage')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderforContainers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForContainers')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderforKubernetes",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForContainers')]"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                      "value": "[parameters('logAnalytics')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "azurePolicyForKubernetes",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForContainers')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForKeyVaults",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForKeyVault')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForDns",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForDns')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForArm",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForArm')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlPaas",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForSql')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForCosmosDbs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForCosmosDbs')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForApis",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForApis')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForCspm",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForCspm')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "securityEmailContact",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                  "parameters": {
                    "emailSecurityContact": {
                      "value": "[parameters('emailSecurityContact')]"
                    },
                    "minimalSeverity": {
                      "value": "[parameters('minimalSeverity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ascExport",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                  "parameters": {
                    "resourceGroupLocation": {
                      "value": "[parameters('ascExportResourceGroupLocation')]"
                    },
                    "resourceGroupName": {
                      "value": "[parameters('ascExportResourceGroupName')]"
                    },
                    "workspaceResourceId": {
                      "value": "[parameters('logAnalytics')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "migrateToMdeTvm",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/766e621d-ba95-4e43-a6f2-e945db3d7888",
                  "parameters": {},
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-MDFC-Config",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:13.2873043Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:13.2873043Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-mdfc-config_20240319": {
            "properties": {
              "displayName": "Deploy Microsoft Defender for Cloud configuration",
              "policyType": "Custom",
              "description": "Deploy Microsoft Defender for Cloud configuration",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Security Center",
                "replacesPolicy": "Deploy-MDFC-Config",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.3.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:16.1188706Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "ascExportResourceGroupLocation": {
                  "type": "String",
                  "metadata": {
                    "description": "The location where the resource group and the export to Log Analytics workspace configuration are created.",
                    "displayName": "Resource Group location for the export to Log Analytics workspace configuration"
                  }
                },
                "ascExportResourceGroupName": {
                  "type": "String",
                  "metadata": {
                    "description": "The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.",
                    "displayName": "Resource Group name for the export to Log Analytics workspace configuration"
                  }
                },
                "ascForAIIsAIPromptEvidenceEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the AI Prompt Evidence add-on feature",
                    "displayName": "AI Prompt Evidence Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForArmSubPlan": {
                  "type": "String",
                  "metadata": {
                    "description": "Select a Defender for Resource Manager plan",
                    "displayName": "Defender for Resource Manager plans"
                  },
                  "allowedValues": [
                    "PerSubscription",
                    "PerApiCall"
                  ],
                  "defaultValue": "PerApiCall"
                },
                "ascForCspmIsAgentlessDiscoveryForKubernetesEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Agentless Discovery for Kubernetes add-on feature",
                    "displayName": "Agentless Discovery for Kubernetes Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForCspmIsAgentlessVmScanningEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Agentless VM Scanning add-on feature",
                    "displayName": "Agentless VM Scanning Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForCspmIsContainerRegistriesVulnerabilityAssessmentsEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Container Registries Vulnerability Assessments add-on feature",
                    "displayName": "Container Registries Vulnerability Assessments Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForCspmIsEntraPermissionsManagementEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Permissions Management add-on feature",
                    "displayName": "Permissions Management Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForCspmIsSensitiveDataDiscoveryEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Sensitive Data Discovery add-on feature",
                    "displayName": "Sensitive Data Discovery Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForKeyVaultSubPlan": {
                  "type": "String",
                  "metadata": {
                    "description": "Select a Defender for Key Vault plan",
                    "displayName": "Key Vaults bundle's sub plan"
                  },
                  "allowedValues": [
                    "PerTransaction",
                    "PerKeyVault"
                  ],
                  "defaultValue": "PerTransaction"
                },
                "ascForServersIsAgentlessVmScanningEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Agentless VM Scanning add-on feature",
                    "displayName": "Agentless VM Scanning Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForServersIsMdeDesignatedSubscriptionEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the MDE Designated Subscription add-on feature",
                    "displayName": "MDE Designated Subscription Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "false"
                },
                "ascForServersSubPlan": {
                  "type": "String",
                  "metadata": {
                    "description": "Select a Defender for Servers plan",
                    "displayName": "Defender for Servers plans"
                  },
                  "allowedValues": [
                    "P1",
                    "P2"
                  ],
                  "defaultValue": "P2"
                },
                "ascForStorageCapGBPerMonthPerStorageAccount": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Limit the GB scanned per month for each storage account within the subscription. Value must be an integer, 10GB or higher. Set to -1 for unlimited scanning",
                    "displayName": "Cap GB Per Month Per Storage Account"
                  },
                  "defaultValue": 5000
                },
                "ascForStorageIsOnUploadMalwareScanningEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Malware Scanning add-on feature",
                    "displayName": "Malware Scanning Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "ascForStorageIsSensitiveDataDiscoveryEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the Sensitive Data Threat Detection add-on feature",
                    "displayName": "Sensitive Data Threat Detection Enabled"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                },
                "createResourceGroup": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "If a resource group does not exists in the scope, a new resource group will be created. If the resource group exists and this flag is set to 'true' the policy will re-deploy the resource group. Please note this will reset any Azure Tag on the resource group.",
                    "displayName": "Create resource group"
                  },
                  "allowedValues": [
                    true,
                    false
                  ],
                  "defaultValue": true
                },
                "emailSecurityContact": {
                  "type": "string",
                  "metadata": {
                    "description": "Provide email address for Microsoft Defender for Cloud contact details",
                    "displayName": "Security contacts email address"
                  }
                },
                "enableAscForAI": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForAppServices": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForArm": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForContainers": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForCosmosDbs": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForCspm": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForKeyVault": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForOssDb": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForServers": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForServersVulnerabilityAssessments": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForSql": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForSqlOnVm": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableAscForStorage": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableTvmCheck": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "type": "String",
                  "metadata": {
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "displayName": "Primary Log Analytics workspace",
                    "strongType": "omsWorkspace"
                  }
                },
                "minimalSeverity": {
                  "type": "string",
                  "metadata": {
                    "description": "Defines the minimal alert severity which will be sent as email notifications",
                    "displayName": "Minimal severity"
                  },
                  "allowedValues": [
                    "High",
                    "Medium",
                    "Low"
                  ],
                  "defaultValue": "High"
                },
                "vulnerabilityAssessmentProvider": {
                  "type": "String",
                  "metadata": {
                    "description": "Select the vulnerability assessment solution to provision to machines.",
                    "displayName": "Vulnerability assessment provider type"
                  },
                  "allowedValues": [
                    "default",
                    "mdeTvm"
                  ],
                  "defaultValue": "mdeTvm"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "defenderForOssDb",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForOssDb')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForVM",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5eb6d64a-4086-4d7a-92da-ec51aed0332d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForServers')]"
                    },
                    "isAgentlessVmScanningEnabled": {
                      "value": "[parameters('ascForServersIsAgentlessVmScanningEnabled')]"
                    },
                    "isMdeDesignatedSubscriptionEnabled": {
                      "value": "[parameters('ascForServersIsMdeDesignatedSubscriptionEnabled')]"
                    },
                    "subPlan": {
                      "value": "[parameters('ascForServersSubPlan')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForVMVulnerabilityAssessment",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForServersVulnerabilityAssessments')]"
                    },
                    "vaType": {
                      "value": "[parameters('vulnerabilityAssessmentProvider')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlServerVirtualMachines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForSqlOnVm')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForAppServices",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForAppServices')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForStorageAccountsV2",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
                  "parameters": {
                    "capGBPerMonthPerStorageAccount": {
                      "value": "[parameters('ascForStorageCapGBPerMonthPerStorageAccount')]"
                    },
                    "effect": {
                      "value": "[parameters('enableAscForStorage')]"
                    },
                    "isOnUploadMalwareScanningEnabled": {
                      "value": "[parameters('ascForStorageIsOnUploadMalwareScanningEnabled')]"
                    },
                    "isSensitiveDataDiscoveryEnabled": {
                      "value": "[parameters('ascForStorageIsSensitiveDataDiscoveryEnabled')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderforContainers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForContainers')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderforKubernetes",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForContainers')]"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                      "value": "[parameters('logAnalytics')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "azurePolicyForKubernetes",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForContainers')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForKeyVaults",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForKeyVault')]"
                    },
                    "subPlan": {
                      "value": "[parameters('ascForKeyVaultSubPlan')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForArm",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForArm')]"
                    },
                    "subPlan": {
                      "value": "[parameters('ascForArmSubPlan')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlPaas",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForSql')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForCosmosDbs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForCosmosDbs')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForAI",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/359a48a3-351a-4618-bb32-f1628645694b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForAI')]"
                    },
                    "isAIPromptEvidenceEnabled": {
                      "value": "[parameters('ascForAIIsAIPromptEvidenceEnabled')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForCspm",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/72f8cee7-2937-403d-84a1-a4e3e57f3c21",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableAscForCspm')]"
                    },
                    "isAgentlessDiscoveryForKubernetesEnabled": {
                      "value": "[parameters('ascForCspmIsAgentlessDiscoveryForKubernetesEnabled')]"
                    },
                    "isAgentlessVmScanningEnabled": {
                      "value": "[parameters('ascForCspmIsAgentlessVmScanningEnabled')]"
                    },
                    "isContainerRegistriesVulnerabilityAssessmentsEnabled": {
                      "value": "[parameters('ascForCspmIsContainerRegistriesVulnerabilityAssessmentsEnabled')]"
                    },
                    "isEntraPermissionsManagementEnabled": {
                      "value": "[parameters('ascForCspmIsEntraPermissionsManagementEnabled')]"
                    },
                    "isSensitiveDataDiscoveryEnabled": {
                      "value": "[parameters('ascForCspmIsSensitiveDataDiscoveryEnabled')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "securityEmailContact",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                  "parameters": {
                    "emailSecurityContact": {
                      "value": "[parameters('emailSecurityContact')]"
                    },
                    "minimalSeverity": {
                      "value": "[parameters('minimalSeverity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ascExport",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                  "parameters": {
                    "createResourceGroup": {
                      "value": "[parameters('createResourceGroup')]"
                    },
                    "resourceGroupLocation": {
                      "value": "[parameters('ascExportResourceGroupLocation')]"
                    },
                    "resourceGroupName": {
                      "value": "[parameters('ascExportResourceGroupName')]"
                    },
                    "workspaceResourceId": {
                      "value": "[parameters('logAnalytics')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "migrateToMdeTvm",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/766e621d-ba95-4e43-a6f2-e945db3d7888",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('enableTvmCheck')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-MDFC-Config_20240319",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.0218429Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.0218429Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-mdfc-defendersql-ama": {
            "properties": {
              "displayName": "[Deprecated]: Configure SQL VM and Arc-enabled SQL Servers to install Microsoft Defender for SQL and AMA with a user-defined LAW",
              "policyType": "Custom",
              "description": "Initiative is deprecated as the built-in initiative now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/de01d381-bae9-4670-8870-786f89f49e26.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Security Center",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "de01d381-bae9-4670-8870-786f89f49e26",
                "version": "1.0.1-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:17.3243439Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "dcrId": {
                  "type": "String",
                  "metadata": {
                    "description": "Id of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Id"
                  }
                },
                "dcrName": {
                  "type": "String",
                  "metadata": {
                    "description": "Name of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Name"
                  }
                },
                "dcrResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "Resource Group of the Data Collection Rule.",
                    "displayName": "Data Collection Rule Resource Group"
                  }
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "enableCollectionOfSqlQueriesForSecurityResearch": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "Enable or disable the collection of SQL queries for security research.",
                    "displayName": "Enable collection of SQL queries for security research"
                  },
                  "allowedValues": [
                    true,
                    false
                  ],
                  "defaultValue": false
                },
                "identityResourceGroup": {
                  "type": "String",
                  "metadata": {
                    "description": "The name of the resource group created by the policy.",
                    "displayName": "Identity Resource Group"
                  },
                  "defaultValue": ""
                },
                "userAssignedIdentityName": {
                  "type": "String",
                  "metadata": {
                    "description": "The name of the user assigned managed identity.",
                    "displayName": "User Assigned Managed Identity Name"
                  },
                  "defaultValue": ""
                },
                "userWorkspaceResourceId": {
                  "type": "String",
                  "metadata": {
                    "description": "Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace Resource Id",
                    "strongType": "omsWorkspace"
                  }
                },
                "workspaceRegion": {
                  "type": "String",
                  "metadata": {
                    "description": "Region of the Log Analytics workspace destination for the Data Collection Rule.",
                    "displayName": "Workspace region",
                    "strongType": "location"
                  }
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "defenderForSqlArcAma",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3592ff98-9787-443a-af59-4505d0fe0786",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlArcMdsql",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/65503269-6a54-4553-8a28-0065a8e6d929",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlArcMdsqlDcr",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
                  "parameters": {
                    "dcrId": {
                      "value": "[parameters('dcrId')]"
                    },
                    "dcrName": {
                      "value": "[parameters('dcrName')]"
                    },
                    "dcrResourceGroup": {
                      "value": "[parameters('dcrResourceGroup')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "enableCollectionOfSqlQueriesForSecurityResearch": {
                      "value": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                    },
                    "userWorkspaceResourceId": {
                      "value": "[parameters('userWorkspaceResourceId')]"
                    },
                    "workspaceRegion": {
                      "value": "[parameters('workspaceRegion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlArcDcrAssociation",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association",
                  "parameters": {
                    "dcrId": {
                      "value": "[parameters('dcrId')]"
                    },
                    "dcrName": {
                      "value": "[parameters('dcrName')]"
                    },
                    "dcrResourceGroup": {
                      "value": "[parameters('dcrResourceGroup')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "workspaceRegion": {
                      "value": "[parameters('workspaceRegion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlAma",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "identityResourceGroup": {
                      "value": "[parameters('identityResourceGroup')]"
                    },
                    "userAssignedIdentityName": {
                      "value": "[parameters('userAssignedIdentityName')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlMdsql",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL",
                  "parameters": {
                    "dcrId": {
                      "value": "[parameters('dcrId')]"
                    },
                    "dcrName": {
                      "value": "[parameters('dcrName')]"
                    },
                    "dcrResourceGroup": {
                      "value": "[parameters('dcrResourceGroup')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "workspaceRegion": {
                      "value": "[parameters('workspaceRegion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "defenderForSqlMdsqlDcr",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR",
                  "parameters": {
                    "dcrId": {
                      "value": "[parameters('dcrId')]"
                    },
                    "dcrName": {
                      "value": "[parameters('dcrName')]"
                    },
                    "dcrResourceGroup": {
                      "value": "[parameters('dcrResourceGroup')]"
                    },
                    "effect": {
                      "value": "Disabled"
                    },
                    "enableCollectionOfSqlQueriesForSecurityResearch": {
                      "value": "[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
                    },
                    "userWorkspaceResourceId": {
                      "value": "[parameters('userWorkspaceResourceId')]"
                    },
                    "workspaceRegion": {
                      "value": "[parameters('workspaceRegion')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-DefenderSQL-AMA",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-MDFC-DefenderSQL-AMA",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:17.1726492Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:17.1726492Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-private-dns-zones": {
            "properties": {
              "displayName": "Configure Azure PaaS services to use private DNS zones",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.4.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:14.0311661Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "azureAcrPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureAcrPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureAppPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureAppPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureAppServicesPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureAppServicesPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureArcGuestconfigurationPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureArcGuestconfigurationPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureArcHybridResourceProviderPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureArcHybridResourceProviderPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureArcKubernetesConfigurationPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureArcKubernetesConfigurationPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureAsrPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureAsrPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureAutomationDSCHybridPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureAutomationDSCHybridPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureAutomationWebhookPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureAutomationWebhookPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureBatchPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureBatchPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureBotServicePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureBotServicePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCognitiveSearchPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCognitiveSearchPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCognitiveServicesPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCognitiveServicesPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCosmosCassandraPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCosmosCassandraPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCosmosGremlinPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCosmosGremlinPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCosmosMongoPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCosmosMongoPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCosmosSQLPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCosmosSQLPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureCosmosTablePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureCosmosTablePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureDataFactoryPortalPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureDataFactoryPortalPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureDataFactoryPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureDataFactoryPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureDatabricksPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureDatabricksPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureDiskAccessPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureDiskAccessPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureEventGridDomainsPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureEventGridDomainsPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureEventGridTopicsPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureEventGridTopicsPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureEventHubNamespacePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureEventHubNamespacePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureFilePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureFilePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureHDInsightPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureHDInsightPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureIotCentralPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureIotCentralPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureIotDeviceupdatePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureIotDeviceupdatePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureIotHubsPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureIotHubsPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureIotPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureIotPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureKeyVaultPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureKeyVaultPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMachineLearningWorkspacePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMachineLearningWorkspacePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMachineLearningWorkspaceSecondPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMachineLearningWorkspaceSecondPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureManagedGrafanaWorkspacePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureManagedGrafanaWorkspacePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMediaServicesKeyPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMediaServicesKeyPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMediaServicesLivePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMediaServicesLivePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMediaServicesStreamPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMediaServicesStreamPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMigratePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMigratePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMonitorPrivateDnsZoneId1": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMonitorPrivateDnsZoneId1",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMonitorPrivateDnsZoneId2": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMonitorPrivateDnsZoneId2",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMonitorPrivateDnsZoneId3": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMonitorPrivateDnsZoneId3",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMonitorPrivateDnsZoneId4": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMonitorPrivateDnsZoneId4",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureMonitorPrivateDnsZoneId5": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureMonitorPrivateDnsZoneId5",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureRedisCachePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureRedisCachePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureServiceBusNamespacePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureServiceBusNamespacePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSignalRPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSignalRPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSiteRecoveryBackupPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSiteRecoveryBackupPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSiteRecoveryBlobPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSiteRecoveryBlobPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSiteRecoveryQueuePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSiteRecoveryQueuePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageBlobPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageBlobPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageBlobSecPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageBlobSecPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageDFSPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageDFSPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageDFSSecPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageDFSSecPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageFilePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageFilePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageQueuePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageQueuePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageQueueSecPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageQueueSecPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageStaticWebPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageStaticWebPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageStaticWebSecPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageStaticWebSecPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageTablePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageTablePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureStorageTableSecondaryPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureStorageTableSecondaryPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSynapseDevPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSynapseDevPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSynapseSQLODPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSynapseSQLODPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureSynapseSQLPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureSynapseSQLPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureVirtualDesktopHostpoolPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureVirtualDesktopHostpoolPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureVirtualDesktopWorkspacePrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureVirtualDesktopWorkspacePrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "azureWebPrivateDnsZoneId": {
                  "type": "string",
                  "metadata": {
                    "description": "Private DNS Zone Identifier",
                    "displayName": "azureWebPrivateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  },
                  "defaultValue": ""
                },
                "dnsZoneNames": {
                  "type": "object",
                  "metadata": {
                    "description": "The list of private DNS zone names to be used for the Azure PaaS services.",
                    "displayName": "DNS Zone Names"
                  },
                  "defaultValue": {
                    "azureAcrDataPrivateDnsZoneId": "{regionName}.data.privatelink.azurecr.io",
                    "azureAcrPrivateDnsZoneId": "privatelink.azurecr.io",
                    "azureAppPrivateDnsZoneId": "privatelink.azconfig.io",
                    "azureAppServicesPrivateDnsZoneId": "privatelink.azurewebsites.net",
                    "azureArcGuestconfigurationPrivateDnsZoneId": "privatelink.guestconfiguration.azure.com",
                    "azureArcHybridResourceProviderPrivateDnsZoneId": "privatelink.his.arc.azure.com",
                    "azureArcKubernetesConfigurationPrivateDnsZoneId": "privatelink.dp.kubernetesconfiguration.azure.com",
                    "azureAsrPrivateDnsZoneId": "privatelink.siterecovery.windowsazure.com",
                    "azureAutomationDSCHybridPrivateDnsZoneId": "privatelink.azure-automation.net",
                    "azureAutomationWebhookPrivateDnsZoneId": "privatelink.azure-automation.net",
                    "azureBatchPrivateDnsZoneId": "privatelink.batch.azure.com",
                    "azureBotServicePrivateDnsZoneId": "privatelink.directline.botframework.com",
                    "azureCognitiveSearchPrivateDnsZoneId": "privatelink.search.windows.net",
                    "azureCognitiveServicesPrivateDnsZoneId": "privatelink.cognitiveservices.azure.com",
                    "azureCosmosCassandraPrivateDnsZoneId": "privatelink.cassandra.cosmos.azure.com",
                    "azureCosmosGremlinPrivateDnsZoneId": "privatelink.gremlin.cosmos.azure.com",
                    "azureCosmosMongoPrivateDnsZoneId": "privatelink.mongo.cosmos.azure.com",
                    "azureCosmosSQLPrivateDnsZoneId": "privatelink.documents.azure.com",
                    "azureCosmosTablePrivateDnsZoneId": "privatelink.table.cosmos.azure.com",
                    "azureDataExplorerPrivateDnsZoneId": "privatelink.{regionName}.kusto.windows.net",
                    "azureDataFactoryPortalPrivateDnsZoneId": "privatelink.adf.azure.com",
                    "azureDataFactoryPrivateDnsZoneId": "privatelink.datafactory.azure.net",
                    "azureDatabricksPrivateDnsZoneId": "privatelink.azuredatabricks.net",
                    "azureDiskAccessPrivateDnsZoneId": "privatelink.blob.core.windows.net",
                    "azureEventGridDomainsPrivateDnsZoneId": "privatelink.eventgrid.azure.net",
                    "azureEventGridTopicsPrivateDnsZoneId": "privatelink.eventgrid.azure.net",
                    "azureEventHubNamespacePrivateDnsZoneId": "privatelink.servicebus.windows.net",
                    "azureFilePrivateDnsZoneId": "privatelink.afs.azure.net",
                    "azureHDInsightPrivateDnsZoneId": "privatelink.azurehdinsight.net",
                    "azureIotCentralPrivateDnsZoneId": "privatelink.azureiotcentral.com",
                    "azureIotDeviceupdatePrivateDnsZoneId": "privatelink.azure-devices.net",
                    "azureIotHubsPrivateDnsZoneId": "privatelink.azure-devices.net",
                    "azureIotPrivateDnsZoneId": "privatelink.azure-devices-provisioning.net",
                    "azureKeyVaultPrivateDnsZoneId": "privatelink.vaultcore.azure.net",
                    "azureKubernetesManagementPrivateDnsZoneId": "privatelink.{regionName}.azmk8s.io",
                    "azureMachineLearningWorkspacePrivateDnsZoneId": "privatelink.api.azureml.ms",
                    "azureMachineLearningWorkspaceSecondPrivateDnsZoneId": "privatelink.notebooks.azure.net",
                    "azureManagedGrafanaWorkspacePrivateDnsZoneId": "privatelink.grafana.azure.com",
                    "azureMediaServicesKeyPrivateDnsZoneId": "privatelink.media.azure.net",
                    "azureMediaServicesLivePrivateDnsZoneId": "privatelink.media.azure.net",
                    "azureMediaServicesStreamPrivateDnsZoneId": "privatelink.media.azure.net",
                    "azureMigratePrivateDnsZoneId": "privatelink.prod.migration.windowsazure.com",
                    "azureMonitorPrivateDnsZoneId1": "privatelink.monitor.azure.com",
                    "azureMonitorPrivateDnsZoneId2": "privatelink.oms.opinsights.azure.com",
                    "azureMonitorPrivateDnsZoneId3": "privatelink.ods.opinsights.azure.com",
                    "azureMonitorPrivateDnsZoneId4": "privatelink.agentsvc.azure-automation.net",
                    "azureMonitorPrivateDnsZoneId5": "privatelink.blob.core.windows.net",
                    "azureRedisCachePrivateDnsZoneId": "privatelink.redis.cache.windows.net",
                    "azureServiceBusNamespacePrivateDnsZoneId": "privatelink.servicebus.windows.net",
                    "azureSignalRPrivateDnsZoneId": "privatelink.service.signalr.net",
                    "azureSiteRecoveryBackupPrivateDnsZoneId": "privatelink.{regionCode}.backup.windowsazure.com",
                    "azureSiteRecoveryBlobPrivateDnsZoneId": "privatelink.blob.core.windows.net",
                    "azureSiteRecoveryQueuePrivateDnsZoneId": "privatelink.queue.core.windows.net",
                    "azureStorageBlobPrivateDnsZoneId": "privatelink.blob.core.windows.net",
                    "azureStorageBlobSecPrivateDnsZoneId": "privatelink.blob.core.windows.net",
                    "azureStorageDFSPrivateDnsZoneId": "privatelink.dfs.core.windows.net",
                    "azureStorageDFSSecPrivateDnsZoneId": "privatelink.dfs.core.windows.net",
                    "azureStorageFilePrivateDnsZoneId": "privatelink.file.core.windows.net",
                    "azureStorageQueuePrivateDnsZoneId": "privatelink.queue.core.windows.net",
                    "azureStorageQueueSecPrivateDnsZoneId": "privatelink.queue.core.windows.net",
                    "azureStorageStaticWebPrivateDnsZoneId": "privatelink.web.core.windows.net",
                    "azureStorageStaticWebSecPrivateDnsZoneId": "privatelink.web.core.windows.net",
                    "azureStorageTablePrivateDnsZoneId": "privatelink.table.core.windows.net",
                    "azureStorageTableSecondaryPrivateDnsZoneId": "privatelink.table.core.windows.net",
                    "azureSynapseDevPrivateDnsZoneId": "privatelink.dev.azuresynapse.net",
                    "azureSynapseSQLODPrivateDnsZoneId": "privatelink.sql.azuresynapse.net",
                    "azureSynapseSQLPrivateDnsZoneId": "privatelink.sql.azuresynapse.net",
                    "azureVirtualDesktopHostpoolPrivateDnsZoneId": "privatelink.wvd.microsoft.com",
                    "azureVirtualDesktopWorkspacePrivateDnsZoneId": "privatelink.wvd.microsoft.com",
                    "azureWebPrivateDnsZoneId": "privatelink.webpubsub.azure.com"
                  }
                },
                "dnsZoneRegion": {
                  "type": "string",
                  "metadata": {
                    "description": "The region where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified.",
                    "displayName": "Region"
                  },
                  "defaultValue": "changeme"
                },
                "dnsZoneResourceGroupName": {
                  "type": "string",
                  "metadata": {
                    "description": "The resource group where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified.",
                    "displayName": "Resource Group Name"
                  },
                  "defaultValue": ""
                },
                "dnsZoneResourceType": {
                  "type": "string",
                  "metadata": {
                    "description": "The resource type where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified.",
                    "displayName": "Resource Type"
                  },
                  "defaultValue": "Microsoft.Network/privateDnsZones"
                },
                "dnsZoneSubscriptionId": {
                  "type": "string",
                  "metadata": {
                    "description": "The subscription id where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified.",
                    "displayName": "Subscription Id"
                  },
                  "defaultValue": ""
                },
                "dnzZoneRegionShortNames": {
                  "type": "object",
                  "metadata": {
                    "description": "Mapping of region to private DNS zone resource id. If the region is not specified, the default private DNS zone resource id will be used.",
                    "displayName": "Region Short Name Mapping"
                  },
                  "defaultValue": {
                    "australiacentral": "acl",
                    "australiacentral2": "acl2",
                    "australiaeast": "ae",
                    "australiasoutheast": "ase",
                    "brazilsouth": "brs",
                    "brazilsoutheast": "bse",
                    "canadacentral": "cnc",
                    "canadaeast": "cne",
                    "centralindia": "inc",
                    "centralus": "cus",
                    "centraluseuap": "ccy",
                    "changeme": "changeme",
                    "chilecentral": "clc",
                    "eastasia": "ea",
                    "eastus": "eus",
                    "eastus2": "eus2",
                    "eastus2euap": "ecy",
                    "francecentral": "frc",
                    "francesouth": "frs",
                    "germanynorth": "gn",
                    "germanywestcentral": "gwc",
                    "israelcentral": "ilc",
                    "italynorth": "itn",
                    "japaneast": "jpe",
                    "japanwest": "jpw",
                    "koreacentral": "krc",
                    "koreasouth": "krs",
                    "malaysiasouth": "mys",
                    "malaysiawest": "myw",
                    "mexicocentral": "mxc",
                    "newzealandnorth": "nzn",
                    "northcentralus": "ncus",
                    "northeurope": "ne",
                    "norwayeast": "nwe",
                    "norwaywest": "nww",
                    "polandcentral": "plc",
                    "qatarcentral": "qac",
                    "southafricanorth": "san",
                    "southafricawest": "saw",
                    "southcentralus": "scus",
                    "southeastasia": "sea",
                    "southindia": "ins",
                    "spaincentral": "spc",
                    "swedencentral": "sdc",
                    "swedensouth": "sds",
                    "switzerlandnorth": "szn",
                    "switzerlandwest": "szw",
                    "taiwannorth": "twn",
                    "uaecentral": "uac",
                    "uaenorth": "uan",
                    "uksouth": "uks",
                    "ukwest": "ukw",
                    "westcentralus": "wcus",
                    "westeurope": "we",
                    "westindia": "inw",
                    "westus": "wus",
                    "westus2": "wus2",
                    "westus3": "wus3"
                  }
                },
                "effect": {
                  "type": "string",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "effect1": {
                  "type": "string",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "deployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "deployIfNotExists"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-File-Sync",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureFilePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureFilePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Automation-Webhook",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAutomationWebhookPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAutomationWebhookPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "Webhook"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Automation-DSCHybrid",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAutomationDSCHybridPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAutomationDSCHybridPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "DSCAndHybridWorker"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-SQL",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosSQLPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosSQLPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "SQL"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-MongoDB",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosMongoPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosMongoPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "MongoDB"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-Cassandra",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosCassandraPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosCassandraPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "Cassandra"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-Gremlin",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosGremlinPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosGremlinPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "Gremlin"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-Table",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosTablePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosTablePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "Table"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-DataFactory",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "listOfGroupIds": {
                      "value": [
                        "dataFactory"
                      ]
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDataFactoryPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDataFactoryPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-DataFactory-Portal",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "listOfGroupIds": {
                      "value": [
                        "portal"
                      ]
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDataFactoryPortalPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDataFactoryPortalPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Databricks-UI-Api",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0eddd7f3-3d9b-4927-a07a-806e8ac9486c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "groupId": {
                      "value": "databricks_ui_api"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDatabricksPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDatabricksPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Databricks-Browser-AuthN",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0eddd7f3-3d9b-4927-a07a-806e8ac9486c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "groupId": {
                      "value": "browser_authentication"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDatabricksPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDatabricksPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-HDInsight",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "groupId": {
                      "value": "cluster"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureHDInsightPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureHDInsightPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Migrate",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMigratePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMigratePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Blob",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageBlobPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageBlobPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Blob-Sec",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageBlobSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageBlobSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Queue",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageQueuePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageQueuePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Queue-Sec",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageQueueSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageQueueSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-File",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageFilePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageFilePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-StaticWeb",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageStaticWebPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageStaticWebPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-StaticWeb-Sec",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageStaticWebSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageStaticWebSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-DFS",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageDFSPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageDFSPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-DFS-Sec",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageDFSSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageDFSSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Synapse-SQL",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSynapseSQLPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSynapseSQLPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "targetSubResource": {
                      "value": "Sql"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Synapse-SQL-OnDemand",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSynapseSQLODPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSynapseSQLODPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "targetSubResource": {
                      "value": "SqlOnDemand"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Synapse-Dev",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSynapseDevPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSynapseDevPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "targetSubResource": {
                      "value": "Dev"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MediaServices-Key",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "groupId": {
                      "value": "keydelivery"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMediaServicesKeyPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMediaServicesKeyPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MediaServices-Live",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "groupId": {
                      "value": "liveevent"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMediaServicesLivePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMediaServicesLivePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MediaServices-Stream",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "groupId": {
                      "value": "streamingendpoint"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMediaServicesStreamPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMediaServicesStreamPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Monitor",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId1": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId1'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId1, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZoneId2": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId2'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId2, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZoneId3": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId3'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId3, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZoneId4": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId4'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId4, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZoneId5": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId5'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId5, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Web",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureWebPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureWebPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Batch",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureBatchPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureBatchPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-App",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAppPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAppPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Site-Recovery",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAsrPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAsrPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoT",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-KeyVault",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureKeyVaultPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureKeyVaultPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-SignalR",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSignalRPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSignalRPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-AppServices",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAppServicesPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAppServicesPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-EventGridTopics",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect1')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureEventGridTopicsPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureEventGridTopicsPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-DiskAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDiskAccessPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDiskAccessPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-CognitiveServices",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCognitiveServicesPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCognitiveServicesPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoTHubs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect1')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotHubsPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotHubsPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-EventGridDomains",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect1')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureEventGridDomainsPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureEventGridDomainsPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-RedisCache",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureRedisCachePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureRedisCachePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-ACR",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAcrPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAcrPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-EventHubNamespace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureEventHubNamespacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureEventHubNamespacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MachineLearningWorkspace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMachineLearningWorkspacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMachineLearningWorkspacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "secondPrivateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMachineLearningWorkspaceSecondPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMachineLearningWorkspaceSecondPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-ServiceBusNamespace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureServiceBusNamespacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureServiceBusNamespacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-CognitiveSearch",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCognitiveSearchPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCognitiveSearchPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-BotService",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6a4e6f44-f2af-4082-9702-033c9e88b9f8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureBotServicePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureBotServicePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-ManagedGrafanaWorkspace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4c8537f8-cd1b-49ec-b704-18e82a42fd58",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureManagedGrafanaWorkspacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureManagedGrafanaWorkspacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-VirtualDesktopHostpool",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9427df23-0f42-4e1e-bf99-a6133d841c4a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureVirtualDesktopHostpoolPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureVirtualDesktopHostpoolPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "connection"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-VirtualDesktopWorkspace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34804460-d88b-4922-a7ca-537165e060ed",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureVirtualDesktopWorkspacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureVirtualDesktopWorkspacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateEndpointGroupId": {
                      "value": "feed"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoTDeviceupdate",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a222b93a-e6c2-4c01-817f-21e092455b2a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotDeviceupdatePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotDeviceupdatePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Arc",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55c4db33-97b0-437b-8469-c4f4498f5df9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneIDForGuestConfiguration": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureArcGuestconfigurationPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureArcGuestconfigurationPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZoneIDForHybridResourceProvider": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureArcHybridResourceProviderPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureArcHybridResourceProviderPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZoneIDForKubernetesConfiguration": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureArcKubernetesConfigurationPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureArcKubernetesConfigurationPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoTCentral",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d627d7c6-ded5-481a-8f2e-7e16b1e6faf6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotCentralPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotCentralPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Table",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/028bbd88-e9b5-461f-9424-a1b63a7bee1a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageTablePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageTablePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Table-Secondary",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c1d634a5-f73d-4cdd-889f-2cc7006eb47f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZoneId": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageTableSecondaryPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageTableSecondaryPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Site-Recovery-Backup",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/af783da1-4ad1-42be-800d-d19c70038820",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    },
                    "privateDnsZone-Backup": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSiteRecoveryBackupPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSiteRecoveryBackupPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZone-Blob": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSiteRecoveryBlobPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSiteRecoveryBlobPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    },
                    "privateDnsZone-Queue": {
                      "value": "[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSiteRecoveryQueuePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSiteRecoveryQueuePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
                    }
                  }
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-Private-DNS-Zones",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:13.8810851Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:13.8810851Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-sql-security": {
            "properties": {
              "displayName": "[Deprecated]: Deploy SQL Database built-in SQL security configuration",
              "policyType": "Custom",
              "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-Sql-Security_20240529.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Deploy-Sql-Security_20240529",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:19.1799292Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "SqlDbAuditingSettingsDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
                    "displayName": "Deploy SQL database auditing settings"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
                    "displayName": "Deploy SQL Database security Alert Policies configuration with email admin accounts"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SqlDbTdeDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment",
                    "displayName": "Deploy SQL Database Transparent Data Encryption "
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters",
                    "displayName": "Deploy SQL Database vulnerability Assessments"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "vulnerabilityAssessmentsEmail": {
                  "type": "String",
                  "metadata": {
                    "description": "The email address to send alerts",
                    "displayName": "The email address to send alerts"
                  }
                },
                "vulnerabilityAssessmentsStorageID": {
                  "type": "String",
                  "metadata": {
                    "description": "The storage account ID to store assessments",
                    "displayName": "The storage account ID to store assessments"
                  }
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "SqlDbTdeDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbTdeDeploySqlSecurityEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlDbSecurityAlertPoliciesDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlDbAuditingSettingsDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]"
                    },
                    "vulnerabilityAssessmentsEmail": {
                      "value": "[parameters('vulnerabilityAssessmentsEmail')]"
                    },
                    "vulnerabilityAssessmentsStorageID": {
                      "value": "[parameters('vulnerabilityAssessmentsStorageID')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-Sql-Security",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:19.0755118Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:19.0755118Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/deploy-sql-security_20240529": {
            "properties": {
              "displayName": "Deploy SQL Database built-in SQL security configuration",
              "policyType": "Custom",
              "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "replacesPolicy": "Deploy-Sql-Security",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:17.3145311Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "SqlDbAuditingSettingsDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
                    "displayName": "Deploy SQL database auditing settings"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
                    "displayName": "Deploy SQL Database security Alert Policies configuration with email admin accounts"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SqlDbTdeDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment",
                    "displayName": "Deploy SQL Database Transparent Data Encryption "
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters",
                    "displayName": "Deploy SQL Database vulnerability Assessments"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "vulnerabilityAssessmentsEmail": {
                  "type": "Array",
                  "metadata": {
                    "description": "The email address to send alerts",
                    "displayName": "The email address to send alerts"
                  }
                },
                "vulnerabilityAssessmentsStorageID": {
                  "type": "String",
                  "metadata": {
                    "description": "The storage account ID to store assessments",
                    "displayName": "The storage account ID to store assessments"
                  }
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "SqlDbTdeDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbTdeDeploySqlSecurityEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlDbSecurityAlertPoliciesDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlDbAuditingSettingsDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]"
                    },
                    "vulnerabilityAssessmentsEmail": {
                      "value": "[parameters('vulnerabilityAssessmentsEmail')]"
                    },
                    "vulnerabilityAssessmentsStorageID": {
                      "value": "[parameters('vulnerabilityAssessmentsStorageID')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security_20240529",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Deploy-Sql-Security_20240529",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:17.227158Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:17.227158Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-acsb": {
            "properties": {
              "displayName": "Enforce Azure Compute Security Benchmark compliance auditing",
              "policyType": "Custom",
              "description": "Enforce Azure Compute Security Benchmark compliance auditing for Windows and Linux virtual machines.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Guest Configuration",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.0460951Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "includeArcMachines": {
                  "type": "String",
                  "metadata": {
                    "description": "By selecting this option, you agree to be charged monthly per Arc connected machine.",
                    "displayName": "Include Arc connected servers"
                  },
                  "allowedValues": [
                    "true",
                    "false"
                  ],
                  "defaultValue": "true"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "GcIdentity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "GcLinux",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "GcWindows",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WinAcsb",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
                  "parameters": {
                    "IncludeArcMachines": {
                      "value": "[parameters('includeArcMachines')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "LinAcsb",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
                  "parameters": {
                    "IncludeArcMachines": {
                      "value": "[parameters('includeArcMachines')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-ACSB",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:10.8385895Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:10.8385895Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-alz-decomm": {
            "properties": {
              "displayName": "Enforce policies in the Decommissioned Landing Zone",
              "policyType": "Custom",
              "description": "Enforce policies in the Decommissioned Landing Zone.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Decommissioned",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:17.0079871Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "listOfResourceTypesAllowed": {
                  "type": "Array",
                  "metadata": {
                    "description": "Allowed resource types in the Decommissioned landing zone, default is none.",
                    "displayName": "Allowed resource types in the Decommissioned landing zone",
                    "strongType": "resourceTypes"
                  },
                  "defaultValue": []
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "DecomDenyResources",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c",
                  "parameters": {
                    "listOfResourceTypesAllowed": {
                      "value": "[parameters('listOfResourceTypesAllowed')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DecomShutdownMachines",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
                  "parameters": {},
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-ALZ-Decomm",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.8700052Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.8700052Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-alz-sandbox": {
            "properties": {
              "displayName": "Enforce policies in the Sandbox Landing Zone",
              "policyType": "Custom",
              "description": "Enforce policies in the Sandbox Landing Zone.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Sandbox",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:15.854479Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effectDenyVnetPeering": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "effectNotAllowedResources": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "listOfResourceTypesNotAllowed": {
                  "type": "Array",
                  "metadata": {
                    "description": "Not allowed resource types in the Sandbox landing zone, default is none.",
                    "displayName": "Not allowed resource types in the Sandbox landing zone",
                    "strongType": "resourceTypes"
                  },
                  "defaultValue": []
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "SandboxNotAllowed",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectNotAllowedResources')]"
                    },
                    "listOfResourceTypesNotAllowed": {
                      "value": "[parameters('listOfResourceTypesNotAllowed')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SandboxDenyVnetPeering",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectDenyVnetPeering')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-ALZ-Sandbox",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:15.8030839Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:15.8030839Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-backup": {
            "properties": {
              "displayName": "Enforce enhanced recovery and backup policies",
              "policyType": "Custom",
              "description": "Enforce enhanced recovery and backup policies on assigned scopes.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Backup",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:17.010032Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "checkAlwaysOnSoftDeleteOnly": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "This parameter checks if Soft Delete is 'Locked' for Backup Vaults in scope. Selecting 'true' will mark only vaults with Soft Delete 'AlwaysOn' as compliant. Selecting 'false' will mark vaults that have Soft Delete either 'On' or 'AlwaysOn' as compliant.",
                    "displayName": "CheckAlwaysOnSoftDeleteOnly"
                  },
                  "allowedValues": [
                    true,
                    false
                  ],
                  "defaultValue": false
                },
                "checkLockedImmutabilityOnly": {
                  "type": "Boolean",
                  "metadata": {
                    "description": "This parameter checks if Immutability is locked for Backup Vaults in scope. Selecting 'true' will mark only vaults with Immutability 'Locked' as compliant. Selecting 'false' will mark vaults that have Immutability either 'Enabled' or 'Locked' as compliant.",
                    "displayName": "checkLockedImmutabilityOnly"
                  },
                  "allowedValues": [
                    true,
                    false
                  ],
                  "defaultValue": false
                },
                "effect": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy.",
                    "displayName": "Effect"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "BackupBVault-Immutability",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2514263b-bc0d-4b06-ac3e-f262c0979018",
                  "parameters": {
                    "checkLockedImmutabiltyOnly": {
                      "value": "[parameters('checkLockedImmutabilityOnly')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BackupRVault-Immutability",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6f6f560-14b7-49a4-9fc8-d2c3a9807868",
                  "parameters": {
                    "checkLockedImmutabilityOnly": {
                      "value": "[parameters('checkLockedImmutabilityOnly')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BackupBVault-SoftDelete",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9798d31d-6028-4dee-8643-46102185c016",
                  "parameters": {
                    "checkAlwaysOnSoftDeleteOnly": {
                      "value": "[parameters('checkAlwaysOnSoftDeleteOnly')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BackupRVault-SoftDelete",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/31b8092a-36b8-434b-9af7-5ec844364148",
                  "parameters": {
                    "checkAlwaysOnSoftDeleteOnly": {
                      "value": "[parameters('checkAlwaysOnSoftDeleteOnly')]"
                    },
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BackupBVault-MUA",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c58e083e-7982-4e24-afdc-be14d312389e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "BackupRVault-MUA",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c7031eab-0fc0-4cd9-acd0-4497bd66d91a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effect')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Backup",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.4458533Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.4458533Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-encryption-cmk_20250218": {
            "properties": {
              "displayName": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
              "policyType": "Custom",
              "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud"
                ],
                "category": "Encryption",
                "replacesPolicy": "Enforce-Encryption-CMK",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:16.0960222Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "ACRCmkEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK.",
                    "displayName": "Container registries should be encrypted with a customer-managed key (CMK)"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AksCmkEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.",
                    "displayName": "Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AutomationAccountCmkEffect": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "AzureBatchCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK.",
                    "displayName": "Azure Batch account should use customer-managed keys to encrypt data"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "BackupCmkEffect": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "CognitiveServicesCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.",
                    "displayName": "Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "CosmosCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.",
                    "displayName": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest"
                  },
                  "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                  ],
                  "defaultValue": "deny"
                },
                "DataBoxCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.",
                    "displayName": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "EncryptedVMDisksEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.",
                    "displayName": "Disk encryption should be applied on virtual machines"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "HealthcareAPIsCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.",
                    "displayName": "Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest"
                  },
                  "allowedValues": [
                    "audit",
                    "disabled"
                  ],
                  "defaultValue": "audit"
                },
                "MySQLCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
                    "displayName": "Azure MySQL servers bring your own key data protection should be enabled"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "PostgreSQLCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
                    "displayName": "Azure PostgreSQL servers bring your own key data protection should be enabled"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "SqlServerTDECMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.",
                    "displayName": "SQL servers should use customer-managed keys to encrypt data at rest"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "StorageCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.",
                    "displayName": "Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "StreamAnalyticsCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.",
                    "displayName": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data"
                  },
                  "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                  ],
                  "defaultValue": "deny"
                },
                "SynapseWorkspaceCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.",
                    "displayName": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "WorkspaceCMKEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk.",
                    "displayName": "Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adfCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adxCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "botServiceCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveSearchCmk": {
                  "type": "string",
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "containerInstanceCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubNamespacesCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "eventHubPremiumCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "osAndDataDiskCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "serviceBusDenyCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "sqlManagedCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsEncryptionCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageQueueCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageTableCmk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "ACRCmkDeny",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ACRCmkEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AksCmkDeny",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AksCmkEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WorkspaceCMK",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WorkspaceCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "CognitiveServicesCMK",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('CognitiveServicesCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "CosmosCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('CosmosCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DataBoxCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('DataBoxCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StreamAnalyticsCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StreamAnalyticsCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SynapseWorkspaceCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SynapseWorkspaceCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SqlServerTDECMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SqlServerTDECMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "HealthcareAPIsCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('HealthcareAPIsCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AzureBatchCMKEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AzureBatchCMKEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "EncryptedVMDisksEffectWin",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('EncryptedVMDisksEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "EncryptedVMDisksEffectLin",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('EncryptedVMDisksEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aa-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AutomationAccountCmkEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Backup-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2e94d99a-8a36-4563-bc77-810d8893b671",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('BackupCmkEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-CognitiveSearch-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/76a56461-9dc0-40f0-82f5-2453283afa2f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveSearchCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-OsAndDataDisk-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/702dd420-7fcc-42c5-afe8-4026edd20fe0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('osAndDataDiskCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerInstance-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0aa61e00-0a01-4a3c-9945-e93cffedf0e6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerInstanceCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ADX-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/81e74cea-30fd-40d5-802f-d72103c2aaaa",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adxCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Adf-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a1ad735a-e96f-45d2-a7b2-9a4932cab7ec",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubNamespacesCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-Premium-CMK",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubPremiumCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sb-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/295fc8b1-dc9f-4f53-9c61-3f313ceab40a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('serviceBusDenyCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Managed-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlManagedCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Table-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c322315-e26d-4174-a99e-f49d351b4688",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageTableCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Encryption-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5ec538c-daa0-4006-8596-35468b9148e8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsEncryptionCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Queue-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e5abd0-2554-4736-b7c0-4ffef23475ef",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageQueueCmk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-BotService-Cmk",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/51522a96-0869-4791-82f3-981000c2c67f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('botServiceCmk')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK_20250218",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Encryption-CMK_20250218",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.005888Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.005888Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-encrypttransit": {
            "properties": {
              "displayName": "[Deprecated]: Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "policyType": "Custom",
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-EncryptTransit_20240509.html",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Encryption",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Enforce-EncryptTransit_20240509",
                "version": "2.1.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.2948854Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "AKSIngressHttpsOnlyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.",
                    "displayName": "AKS Service. Enforce HTTPS ingress in Kubernetes cluster"
                  },
                  "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                  ],
                  "defaultValue": "deny"
                },
                "APIAppServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "AppServiceHttpEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.",
                    "displayName": "App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "AppServiceTlsVersionEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
                    "displayName": "App Service. Appends the AppService WebApp, APIApp, Function App to enable https only"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "AppServiceminTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service. Select version  minimum TLS version for a  Web App config to enforce",
                    "displayName": "App Service. Select version minimum TLS Web App config"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "ContainerAppsHttpsOnlyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps.",
                    "displayName": "Container Apps should only be accessible over HTTPS"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "FunctionLatestTlsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.",
                    "displayName": "App Service Function App. Latest TLS version should be used in your Function App"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "FunctionServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "MySQLEnableSSLDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MySQLEnableSSLEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "MySQLminimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "MySQL database servers. Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "PostgreSQLEnableSSLDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "PostgreSQLEnableSSLEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "PostgreSQLminimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "PostgreSQL database servers. Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "RedisMinTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for a Azure Cache for Redis to enforce",
                    "displayName": "Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "RedisTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "RedisTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
                    "displayName": "Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLManagedInstanceMinTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for Azure Managed Instanceto to  enforce",
                    "displayName": "Azure Managed Instance.Select version minimum TLS for Azure Managed Instance"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "SQLManagedInstanceTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLManagedInstanceTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
                    "displayName": "SQL Managed Instance should have the minimal TLS version of 1.2"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLServerTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLServerTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
                    "displayName": "Azure SQL Database should have the minimal TLS version of 1.2"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLServerminTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for Azure SQL Database to enforce",
                    "displayName": "Azure SQL Database.Select version minimum TLS for Azure SQL Database"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "StorageDeployHttpsEnabledEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
                    "displayName": "Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "StorageHttpsEnabledEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
                    "displayName": "Azure Storage Account. Secure transfer to storage accounts should be enabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "StorageminimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version on Azure Storage Account to enforce",
                    "displayName": "Storage Account select minimum TLS version"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_1",
                    "TLS1_0"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "WebAppServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "WebAppServiceLatestTlsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.",
                    "displayName": "App Service Web App. Latest TLS version should be used in your Web App"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AppServiceHttpEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceHttpEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AppServiceminTlsVersion",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceTlsVersionEffect')]"
                    },
                    "minTlsVersion": {
                      "value": "[parameters('AppServiceminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionLatestTlsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionLatestTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WebAppServiceLatestTlsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WebAppServiceLatestTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "APIAppServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('APIAppServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WebAppServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WebAppServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AKSIngressHttpsOnlyEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AKSIngressHttpsOnlyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('MySQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLEnableSSLEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('MySQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSDeployEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('RedisMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisdisableNonSslPort",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSDeployEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisDenyhttps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('RedisMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLManagedInstanceTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLManagedInstanceTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLServerTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLServerTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLServerminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLServerTLSEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLServerTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLServerminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageHttpsEnabledEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageHttpsEnabledEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('StorageMinimumTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageDeployHttpsEnabledEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('StorageMinimumTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ContainerAppsHttpsOnlyEffect')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-EncryptTransit",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.1200509Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.1200509Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-encrypttransit_20240509": {
            "properties": {
              "displayName": "[Deprecated]: Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "policyType": "Custom",
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-EncryptTransit_20241211.html ",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Encryption",
                "deprecated": true,
                "replacesPolicy": "Enforce-EncryptTransit",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Enforce-EncryptTransit_20241211",
                "version": "1.0.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:12.8577529Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "AKSIngressHttpsOnlyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.",
                    "displayName": "AKS Service. Enforce HTTPS ingress in Kubernetes cluster"
                  },
                  "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                  ],
                  "defaultValue": "deny"
                },
                "APIAppServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "AppServiceHttpEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.",
                    "displayName": "App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "AppServiceTlsVersionEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
                    "displayName": "App Service. Appends the AppService WebApp, APIApp, Function App to enable https only"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "AppServiceminTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service. Select version  minimum TLS version for a  Web App config to enforce",
                    "displayName": "App Service. Select version minimum TLS Web App config"
                  },
                  "allowedValues": [
                    "1.3",
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                },
                "ContainerAppsHttpsOnlyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps.",
                    "displayName": "Container Apps should only be accessible over HTTPS"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "FunctionAppTlsEffect": {
                  "type": "string",
                  "metadata": {
                    "description": "App Service Function App. Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
                    "displayName": "App Service Function App. Configure Function apps to use the latest TLS version."
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "FunctionLatestTlsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.",
                    "displayName": "App Service Function App. Latest TLS version should be used in your Function App"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "FunctionServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "LogicAppTlsEffect": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MySQLEnableSSLDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MySQLEnableSSLEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "MySQLminimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "MySQL database servers. Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "PostgreSQLEnableSSLDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "PostgreSQLEnableSSLEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "PostgreSQLminimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "PostgreSQL database servers. Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "RedisMinTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for a Azure Cache for Redis to enforce",
                    "displayName": "Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "RedisTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "RedisTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
                    "displayName": "Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLManagedInstanceMinTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for Azure Managed Instanceto to  enforce",
                    "displayName": "Azure Managed Instance.Select version minimum TLS for Azure Managed Instance"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "SQLManagedInstanceTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLManagedInstanceTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
                    "displayName": "SQL Managed Instance should have the minimal TLS version of 1.2"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLServerTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLServerTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
                    "displayName": "Azure SQL Database should have the minimal TLS version of 1.2"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLServerminTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for Azure SQL Database to enforce",
                    "displayName": "Azure SQL Database.Select version minimum TLS for Azure SQL Database"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "StorageDeployHttpsEnabledEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
                    "displayName": "Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "StorageMinimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version on Azure Storage Account to enforce",
                    "displayName": "Storage Account select minimum TLS version"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_1",
                    "TLS1_0"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "WebAppServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "WebAppServiceLatestTlsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.",
                    "displayName": "App Service Web App. Latest TLS version should be used in your Web App"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "appServiceAppSlotTls": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceAppSlotsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceAppsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceAppsTls": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerAppsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubMinTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppSlotsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppSlotsTls": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logicAppHttpsEffect": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlDbTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlManagedTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "storageAccountsTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "synapseTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AppServiceHttpEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceHttpEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AppServiceminTlsVersion",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceTlsVersionEffect')]"
                    },
                    "minTlsVersion": {
                      "value": "[parameters('AppServiceminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionLatestTlsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionLatestTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WebAppServiceLatestTlsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WebAppServiceLatestTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "APIAppServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('APIAppServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WebAppServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WebAppServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AKSIngressHttpsOnlyEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AKSIngressHttpsOnlyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('MySQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLEnableSSLEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('MySQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSDeployEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('RedisMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisdisableNonSslPort",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSDeployEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisDenyhttps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('RedisMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLManagedInstanceTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLManagedInstanceTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLServerTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLServerTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLServerminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLServerTLSEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLServerTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLServerminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageDeployHttpsEnabledEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('StorageMinimumTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ContainerAppsHttpsOnlyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-FunctionApp-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionAppTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deploy-LogicApp-TLS",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('LogicAppTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-LogicApp-Without-Https",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('logicAppHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Function-Apps-Slots-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fa3a6357-c6d6-4120-8429-855577ec0063",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppSlotsTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-AppService-Apps-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Apps-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-AppService-AppSlotTls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/014664e7-e348-41a3-aeb9-566e4ff6a9df",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppSlotTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FuncAppSlots-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e5dbe3f-2702-4ffc-8b1e-0cae008a5c71",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppSlotsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FunctionApp-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Slots-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae1b9a8c-dfce-4605-bd91-69213b4a26fc",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppSlotsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerApps-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerAppsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-minTLS",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubMinTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Managed-Tls-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8793640-60f7-487c-b5c3-1d37215905c4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlManagedTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Db-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlDbTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Tls-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb3738a6-82a2-4a18-b87b-15217b9deff4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseTlsVersion')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20240509",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-EncryptTransit_20240509",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:12.7450177Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:12.7450177Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-encrypttransit_20241211": {
            "properties": {
              "displayName": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "policyType": "Custom",
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Encryption",
                "replacesPolicy": "Enforce-EncryptTransit_20240509",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.2",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.3696445Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "AKSIngressHttpsOnlyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.",
                    "displayName": "AKS Service. Enforce HTTPS ingress in Kubernetes cluster"
                  },
                  "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                  ],
                  "defaultValue": "deny"
                },
                "APIAppServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "AppServiceHttpEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.",
                    "displayName": "App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "AppServiceTlsVersionEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
                    "displayName": "App Service. Appends the AppService WebApp, APIApp, Function App to enable https only"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "AppServiceminTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service. Select version  minimum TLS version for a  Web App config to enforce",
                    "displayName": "App Service. Select version minimum TLS Web App config"
                  },
                  "allowedValues": [
                    "1.3",
                    "1.2",
                    "1.1",
                    "1.0"
                  ],
                  "defaultValue": "1.2"
                },
                "ContainerAppsHttpsOnlyEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps.",
                    "displayName": "Container Apps should only be accessible over HTTPS"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "FunctionAppTlsEffect": {
                  "type": "string",
                  "metadata": {
                    "description": "App Service Function App. Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
                    "displayName": "App Service Function App. Configure Function apps to use the latest TLS version."
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "FunctionLatestTlsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.",
                    "displayName": "App Service Function App. Latest TLS version should be used in your Function App"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "FunctionServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "LogicAppTlsEffect": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MySQLEnableSSLDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "MySQLEnableSSLEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "MySQLminimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "MySQL database servers. Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "PostgreSQLEnableSSLDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "PostgreSQLEnableSSLEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "PostgreSQLminimalTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce",
                    "displayName": "PostgreSQL database servers. Select version minimum TLS for MySQL server"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "RedisMinTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for a Azure Cache for Redis to enforce",
                    "displayName": "Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "RedisTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis"
                  },
                  "allowedValues": [
                    "Append",
                    "Disabled"
                  ],
                  "defaultValue": "Append"
                },
                "RedisTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
                    "displayName": "Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLManagedInstanceMinTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for Azure Managed Instanceto to  enforce",
                    "displayName": "Azure Managed Instance.Select version minimum TLS for Azure Managed Instance"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "SQLManagedInstanceTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLManagedInstanceTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
                    "displayName": "SQL Managed Instance should have the minimal TLS version of 1.2"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLServerTLSDeployEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
                    "displayName": "Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "SQLServerTLSEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
                    "displayName": "Azure SQL Database should have the minimal TLS version of 1.2"
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "SQLServerminTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version for Azure SQL Database to enforce",
                    "displayName": "Azure SQL Database.Select version minimum TLS for Azure SQL Database"
                  },
                  "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                  ],
                  "defaultValue": "1.2"
                },
                "StorageDeployHttpsEnabledEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
                    "displayName": "Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled"
                  },
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "StorageMinimumTlsVersion": {
                  "type": "String",
                  "metadata": {
                    "description": "Select version  minimum TLS version on Azure Storage Account to enforce",
                    "displayName": "Storage Account select minimum TLS version"
                  },
                  "allowedValues": [
                    "TLS1_2",
                    "TLS1_1",
                    "TLS1_0"
                  ],
                  "defaultValue": "TLS1_2"
                },
                "WebAppServiceHttpsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
                    "displayName": "App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy."
                  },
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Audit"
                },
                "WebAppServiceLatestTlsEffect": {
                  "type": "String",
                  "metadata": {
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.",
                    "displayName": "App Service Web App. Latest TLS version should be used in your Web App"
                  },
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "appServiceAppSlotTls": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceAppSlotsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceAppsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceAppsTls": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubMinTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppSlotsHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppSlotsTls": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "logicAppHttpsEffect": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlDbTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlManagedTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "storageAccountsTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "synapseTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AppServiceHttpEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceHttpEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AppServiceminTlsVersion",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AppServiceTlsVersionEffect')]"
                    },
                    "minTlsVersion": {
                      "value": "[parameters('AppServiceminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionLatestTlsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionLatestTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WebAppServiceLatestTlsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WebAppServiceLatestTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "APIAppServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('APIAppServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "FunctionServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "WebAppServiceHttpsEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('WebAppServiceHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "AKSIngressHttpsOnlyEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('AKSIngressHttpsOnlyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('MySQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "MySQLEnableSSLEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('MySQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('MySQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('PostgreSQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSDeployEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('RedisMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisdisableNonSslPort",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSDeployEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "RedisDenyhttps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('RedisTLSEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('RedisMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLManagedInstanceTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLManagedInstanceTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLServerTLSDeployEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLServerTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLServerminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "SQLServerTLSEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('SQLServerTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                      "value": "[parameters('SQLServerminTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('StorageDeployHttpsEnabledEffect')]"
                    },
                    "minimumTlsVersion": {
                      "value": "[parameters('StorageMinimumTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('ContainerAppsHttpsOnlyEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-FunctionApp-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('FunctionAppTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deploy-LogicApp-TLS",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('LogicAppTlsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-LogicApp-Without-Https",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('logicAppHttpsEffect')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Function-Apps-Slots-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fa3a6357-c6d6-4120-8429-855577ec0063",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppSlotsTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-AppService-Apps-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Apps-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-AppService-AppSlotTls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/014664e7-e348-41a3-aeb9-566e4ff6a9df",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppSlotTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FuncAppSlots-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e5dbe3f-2702-4ffc-8b1e-0cae008a5c71",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppSlotsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FunctionApp-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Slots-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae1b9a8c-dfce-4605-bd91-69213b4a26fc",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppSlotsHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-minTLS",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubMinTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Managed-Tls-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8793640-60f7-487c-b5c3-1d37215905c4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlManagedTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Db-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlDbTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Tls-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb3738a6-82a2-4a18-b87b-15217b9deff4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseTlsVersion')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20241211",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-EncryptTransit_20241211",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.2124354Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.2124354Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-apim": {
            "properties": {
              "displayName": "Enforce recommended guardrails for API Management",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures API Management is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "API Management",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.5644359Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "apiSubscriptionScope": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimApiBackendCertValidation": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimCallApiAuthn": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimDirectApiEndpoint": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimDisablePublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "apimEncryptedProtocols": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimSecrets": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimSkuVnet": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimTls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "apimVnetUsage": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "minimumApiVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Apim-without-Kv",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimSecrets')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-without-Vnet",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimVnetUsage')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-APIM-TLS",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimTls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-Protocols",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimEncryptedProtocols')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-Authn",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimCallApiAuthn')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-Direct-Endpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimDirectApiEndpoint')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-Cert-Validation",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimApiBackendCertValidation')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Apim-Public-NetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7ca8c8ac-3a6e-493d-99ba-c5fa35347ff2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimDisablePublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-Sku-Vnet",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/73ef9241-5d81-4cd4-b483-8443d1730fe5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apimSkuVnet')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Apim-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('minimumApiVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Api-subscription-scope",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('apiSubscriptionScope')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-APIM",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-APIM",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.222783Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.222783Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-appservices": {
            "properties": {
              "displayName": "Enforce recommended guardrails for App Service",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures App Service is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "App Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.1566298Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "appServiceAppHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "appServiceAppModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "appServiceAppSlotsRemoteDebugging": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceAppsModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "appServiceAppsRemoteDebugging": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceAppsRfc": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceAppsVnetRouting": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceByoc": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceDisableLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceDisableLocalAuthFtp": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceEnvLatestVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceRfc": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceRouting": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appServiceScmAuth": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "appServiceSkuPl": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "functionAppDebugging": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "functionAppSlotsModifyHttps": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "functionAppSlotsModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Byoc",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceByoc')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-AppService-Apps-Remote-Debugging",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a5e3fe8f-f6cd-4f1d-bbf6-c749754a724b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsRemoteDebugging')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Slots-Remote-Debugging",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cca5adfe-626b-4cc6-8522-f5b6ed2391bd",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppSlotsRemoteDebugging')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Latest-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb4d34ab-0929-491c-bbf3-61e13da19f9a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceEnvLatestVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Vnet-Routing",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/801543d1-1953-4a90-b8b0-8cf6d41473a5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsVnetRouting')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppService-Rfc",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f5c0bfb3-acea-47b1-b477-b0edcdf6edc1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceRfc')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppServiceApps-Rfc",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a691eacb-474d-47e4-b287-b4813ca44222",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsRfc')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-FuncApp-Debugging",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/70adbb40-e092-42d5-a6f8-71c540a5efdb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppDebugging')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-AppService-ScmAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e97b776-f380-4722-a9a3-e7f0be029e79",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceScmAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppServ-Routing",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5747353b-1ca9-42c1-a4dd-b874b894f3d4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceRouting')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppServ-FtpAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/572e342c-c920-4ef5-be2e-1ed3c6a51dc5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceDisableLocalAuthFtp')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppServ-SkuPl",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/546fe8d2-368d-4029-a418-6af48a7f61e5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceSkuPl')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-AppService-LocalAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2c034a29-2a5f-4857-b120-f800fe5549ae",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceDisableLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "DINE-AppService-Debugging",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25a5046c-c423-4805-9235-e844ae9ef49b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppDebugging')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Function-Apps-Slots-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08cf2974-d178-48a0-b26d-f6b8e555748b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppSlotsModifyHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-AppService-Https",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0f98368e-36bc-4716-8ac2-8f8067203b63",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppHttps')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Function-Apps-Slots-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/242222f3-4985-4e99-b5ef-086d6a6cb01c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('functionAppSlotsModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-AppService-Apps-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2374605e-3e0b-492b-9046-229af202562c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppsModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-AppService-App-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c6c3e00e-d414-4ca4-914f-406699bb8eee",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appServiceAppModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-AppServices",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-AppServices",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.0261786Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.0261786Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-automation": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Automation Account",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Automation Account is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Automation",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:12.0202504Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "aaLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "aaManagedIdentity": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "aaModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "aaModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "aaVariablesEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "autoHotPatch": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Windows-Vm-HotPatch",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d02d2f7-e38b-4bdc-96f3-adc0a8726abc",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('autoHotPatch')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aa-Managed-Identity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dea83a72-443c-4292-83d5-54a2f98749c0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aaManagedIdentity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aa-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/48c5f1cb-14ad-4797-8e3b-f78ab3f8d700",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aaLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aa-Variables-Encrypt",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aaVariablesEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Aa-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/30d1d58e-8f96-47a5-8564-499a3f3cca81",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aaModifyLocalAUth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Aa-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/23b36a7c-9d26-4288-a8fd-c1d2fa284d8c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aaModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Automation",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Automation",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.9481183Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.9481183Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-botservice": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Bot Service",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Bot Service is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Bot Service",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:12.8637386Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "botServiceIsolatedMode": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "botServiceLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "botServicePrivateLink": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "botServiceValidUri": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-BotService-Valid-Uri",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6164527b-e1ee-4882-8673-572f425f5e0a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('botServiceValidUri')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-BotService-Isolated-Mode",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/52152f42-0dda-40d9-976e-abb1acdd611e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('botServiceIsolatedMode')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-BotService-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ffea632e-4e3a-4424-bf78-10e179bb2e1a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('botServiceLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Audit-BotService-Private-Link",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ad5621d6-a877-4407-aa93-a950b428315e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('botServicePrivateLink')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-BotService",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-BotService",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:12.8185282Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:12.8185282Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-cognitiveservices": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Cognitive Services",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Cognitive Services is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cognitive Services",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.0046848Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "cognitiveSearchLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveSearchSku": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesCustomerStorage": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "cognitiveServicesManagedIdentity": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "cognitiveServicesResourceLogs": {
                  "type": "string",
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "modifyCognitiveSearchLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "modifyCognitiveSearchPublicEndpoint": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-CognitiveSearch-SKU",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a049bf77-880b-470f-ba6d-9f21c530cf83",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveSearchSku')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-CongitiveSearch-LocalAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6300012e-e9a4-4649-b41f-a85f5c43be91",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveSearchLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-CogntiveSearch-LocalAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4eb216f2-9dba-4979-86e6-5d7e63ce3b75",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifyCognitiveSearchLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-CogntiveSearch-PublicEndpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9cee519f-d9c1-4fd9-9f79-24ec3449ed30",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifyCognitiveSearchPublicEndpoint')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Cognitive-Services-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47ba1dd7-28d9-4b07-a8d5-9813bed64e0c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Managed-Identity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe3fd216-4f83-4fc1-8984-2bbec80a3418",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesManagedIdentity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Customer-Storage",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/46aa9b05-0e60-4eae-a88b-1e9d374fa515",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesCustomerStorage')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Cognitive-Services-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/14de9e63-1b31-492e-a5a3-c3f7fd57f555",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Aine-Cognitive-Services-Resource-Logs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesResourceLogs')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CognitiveServices",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-CognitiveServices",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:10.9324942Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:10.9324942Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-compute": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Compute",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Compute is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Compute",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:15.7435038Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "diskDoubleEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "vmAndVmssEncryptionHost": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-VmAndVmss-Encryption-Host",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('vmAndVmssEncryptionHost')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Disk-Double-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca91455f-eace-4f96-be59-e6e2c35b4816",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('diskDoubleEncryption')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Compute",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Compute",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:15.6149093Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:15.6149093Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-containerapps": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Container Apps",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Container Apps",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.8097327Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "containerAppsManagedIdentity": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerAppsVnetInjection": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-ContainerApp-Vnet-Injection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8b346db6-85af-419b-8557-92cee2c0f9bb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerAppsVnetInjection')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerApps-Managed-Identity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b874ab2d-72dd-47f1-8cb5-4a306478a4e7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerAppsManagedIdentity')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerApps",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-ContainerApps",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.7738571Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.7738571Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-containerinstance": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Container Instance",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Container Instances",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:17.0771145Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "containerInstanceVnet": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-ContainerInstance-Vnet",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8af8f826-edcb-4178-b35f-851ea6fea615",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerInstanceVnet')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerInstance",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-ContainerInstance",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.8551366Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.8551366Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-containerregistry": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Container Registry",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Container Registry",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:13.1237757Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "containerRegistryAnAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerRegistryArmAudience": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerRegistryExports": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerRegistryLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerRegistryModifyAnAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "containerRegistryModifyArmAudience": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "containerRegistryModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "containerRegistryModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "containerRegistryModifyRepositoryToken": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "containerRegistryRepositoryToken": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerRegistrySkuPrivateLink": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "containerRegistryUnrestrictedNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Modify-ContainerRegistry-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/79fdfe03-ffcb-4e55-b4d0-b925b8241759",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ContainerRegistry-Repo-Token",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9b426fe-8856-4945-8600-18c5dd1cca2a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryModifyRepositoryToken')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Arm-Audience",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/42781ec6-6127-4c30-bdfa-fb423a0047d3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryArmAudience')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ContainerRegistry-Arm-Audience",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/785596ed-054f-41bc-aaec-7f3d0ba05725",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryModifyArmAudience')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Sku-PrivateLink",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd560fc0-3c69-498a-ae9f-aa8eb7de0e13",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistrySkuPrivateLink')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ContainerRegistry-Anonymous-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cced2946-b08a-44fe-9fd9-e4ed8a779897",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryModifyAnAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Anonymous-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9f2dea28-e834-476c-99c5-3507b4728395",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryAnAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Exports",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/524b0254-c285-4903-bee6-bb8126cde579",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryExports')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dc921057-6b28-4fbe-9b83-f7bec05db6c2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Repo-Token",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ff05e24e-195c-447e-b322-5e90c9f9f366",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryRepositoryToken')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ContainerRegistry-Unrestricted-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryUnrestrictedNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ContainerRegistry-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a3701552-92ea-433e-9d17-33b7f1208fc9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('containerRegistryModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerRegistry",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-ContainerRegistry",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:13.0480004Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:13.0480004Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-cosmosdb": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Cosmos DB",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Cosmos DB is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cosmos DB",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:19.127604Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "cosmosDbAtp": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "cosmosDbFwRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cosmosDbLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cosmosDbModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "cosmosDbModifyPublicAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Modify-CosmosDb-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dc2d41d1-4ab1-4666-a3e1-3d51c43e0049",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cosmosDbModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-CosmosDb-Atp",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5f04e03-92a3-4b09-9410-2cc5e5047656",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cosmosDbAtp')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-CosmosDb-Fw-Rules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cosmosDbFwRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-CosmosDb-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cosmosDbLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Append-CosmosDb-Metadata",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4750c32b-89c0-46af-bfcb-2e4541a818d5",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-CosmosDb-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/da69ba51-aaf1-41e5-8651-607cd0b37088",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cosmosDbModifyPublicAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CosmosDb",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-CosmosDb",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:19.0333621Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:19.0333621Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-dataexplorer": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Data Explorer",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Data Explorer is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Azure Data Explorer",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:16.6396068Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "adxDoubleEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adxEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adxModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "adxSku": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-ADX-Sku-without-PL-Support",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1fec9658-933f-4b3e-bc95-913ed22d012b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adxSku')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ADX-Double-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ec068d99-e9c7-401f-8cef-5bdde4e6ccf1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adxDoubleEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ADX-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f4b53539-8df9-40e4-86c6-6b607703bd4e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adxEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ADX-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7b32f193-cb28-4e15-9a98-b9556db0bafa",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adxModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataExplorer",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-DataExplorer",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.3544152Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.3544152Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-datafactory": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Data Factory",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Data Factory is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Data Factory",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:15.8132641Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "adfGit": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adfLinkedServiceKeyVault": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adfManagedIdentity": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "adfModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "adfSqlIntegration": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Adf-Managed-Identity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f78ccdb4-7bf4-4106-8647-270491d2978a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfManagedIdentity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Adf-Git",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/77d40665-3120-4348-b539-3192ec808307",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfGit')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Adf-Linked-Service-Key-Vault",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/127ef6d7-242f-43b3-9eef-947faf1725d0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfLinkedServiceKeyVault')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Adf-Sql-Integration",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0088bc63-6dee-4a9c-9d29-91cfdc848952",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfSqlIntegration')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Adf-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08b1442b-7789-4130-8506-4f99a97226a7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('adfModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataFactory",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-DataFactory",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:15.755596Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:15.755596Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-eventgrid": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Event Grid",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Event Grid is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Event Grid",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.0505461Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "eventGridDomainModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "eventGridDomainModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "eventGridLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventGridPartnerNamespaceLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventGridPartnerNamespaceModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "eventGridTopicLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventGridTopicModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "eventGridTopicModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Modify-EventGrid-Partner-Namespace-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2dd0e8b9-4289-4bb0-b813-1883298e9924",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridPartnerNamespaceModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-EventGrid-Domain-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8ac2748f-3bf1-4c02-a3b6-92ae68cf75b1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridDomainModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EventGrid-Topic-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae9fb87f-8a17-4428-94a4-8135d431055c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridTopicLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-EventGrid-Topic-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c8144d9-746a-4501-b08c-093c8d29ad04",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridTopicModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EventGrid-Partner-Namespace-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8632b003-3545-4b29-85e6-b2b96773df1e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridPartnerNamespaceLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EventGrid-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8bfadddb-ee1c-4639-8911-a38cb8e0b3bd",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-EventGrid-Domain-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/898e9824-104c-4965-8e0e-5197588fa5d4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridDomainModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-EventGrid-Topic-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/36ea4b4b-0f7f-4a54-89fa-ab18f555a172",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventGridTopicModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventGrid",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-EventGrid",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:10.9798218Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:10.9798218Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-eventhub": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Event Hub",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Event Hub is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Event Hub",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.0054933Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "eventHubAuthRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubNamespacesDoubleEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubNamespacesLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "eventHubNamespacesModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-EH-Double-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/836cd60e-87f3-4e6a-a27c-29d687f01a4c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubNamespacesDoubleEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-EH-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/57f35901-8389-40bb-ac49-3ba4f86d889d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubNamespacesModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5d4e3c65-4873-47be-94f3-6f8b953a3598",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubNamespacesLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-EH-Auth-Rules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('eventHubAuthRules')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventHub",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-EventHub",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:10.9318662Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:10.9318662Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-keyvault": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Azure Key Vault",
              "policyType": "Custom",
              "description": "Enforce recommended guardrails for Azure Key Vault.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Key Vault",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:17.4664484Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "effectKvCertLifetime": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Certificate Lifetime"
                  },
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectKvFirewallEnabled": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Firewall Enabled"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectKvKeysExpire": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Keys Expiry"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectKvKeysLifetime": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Keys Lifetime"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectKvPurgeProtection": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Purge Protection"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "effectKvSecretsExpire": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Secrets Expiry"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectKvSecretsLifetime": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Secrets Lifetime"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "effectKvSoftDelete": {
                  "type": "String",
                  "metadata": {
                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect - KV Soft Delete"
                  },
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultArmRbac": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultCertKeyTypes": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultCertValidPeriod": {
                  "type": "integer",
                  "defaultValue": 12
                },
                "keyVaultCertificateNotExpireWithinSpecifiedNumberOfDays": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultCertificateNotExpireWithinSpecifiedNumberOfDaysValue": {
                  "type": "integer",
                  "defaultValue": 90
                },
                "keyVaultCertificatesPeriod": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "keyVaultCheckMinimumRSACertificateSize": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultCheckMinimumRSAKeySize": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultCryptographicType": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultEllipticCurve": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultHmsCurveNames": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultHmsCurveNamesValue": {
                  "type": "array",
                  "defaultValue": [
                    "P-256",
                    "P-256K",
                    "P-384",
                    "P-521"
                  ]
                },
                "keyVaultHmsKeysExpiration": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultHmsPurgeProtection": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultHsmMinimumDaysBeforeExpiration": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultHsmMinimumDaysBeforeExpirationValue": {
                  "type": "integer",
                  "defaultValue": 90
                },
                "keyVaultIntegratedCa": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultIntegratedCaValue": {
                  "type": "array",
                  "defaultValue": [
                    "DigiCert",
                    "GlobalSign"
                  ]
                },
                "keyVaultManagedHsmCheckMinimumRSAKeySize": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keyVaultManagedHsmMinimumRSAKeySizeValue": {
                  "type": "integer",
                  "allowedValues": [
                    2048,
                    3072,
                    4096
                  ],
                  "defaultValue": 2048
                },
                "keyVaultMinimumRSACertificateSizeValue": {
                  "type": "integer",
                  "allowedValues": [
                    2048,
                    3072,
                    4096
                  ],
                  "defaultValue": 2048
                },
                "keyVaultMinimumRSAKeySizeValue": {
                  "type": "integer",
                  "allowedValues": [
                    2048,
                    3072,
                    4096
                  ],
                  "defaultValue": 2048
                },
                "keyVaultNonIntegratedCa": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "keyVaultNonIntegratedCaValue": {
                  "type": "string",
                  "metadata": {
                    "description": "The common name (CN) of the Certificate Authority (CA) provider. For example, for an issuer CN = Contoso, OU = .., DC = .., you can specify Contoso",
                    "displayName": "The common name of the certificate authority"
                  },
                  "defaultValue": ""
                },
                "keyVaultSecretContentType": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keysActive": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "keysActiveInDays": {
                  "type": "integer",
                  "defaultValue": 90
                },
                "keysCurveNames": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "keysValidPeriod": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "keysValidityInDays": {
                  "type": "integer",
                  "defaultValue": 90
                },
                "maximumCertLifePercentageLife": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Enter the percentage of lifetime of the certificate when you want to trigger the policy action. For example, to trigger a policy action at 80% of the certificate's valid life, enter '80'.",
                    "displayName": "The maximum lifetime percentage"
                  },
                  "defaultValue": 80
                },
                "minimumCertLifeDaysBeforeExpiry": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.",
                    "displayName": "The minimum days before expiry"
                  },
                  "defaultValue": 90
                },
                "minimumKeysLifeDaysBeforeExpiry": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.",
                    "displayName": "The minimum days before expiry"
                  },
                  "defaultValue": 90
                },
                "minimumSecretsLifeDaysBeforeExpiry": {
                  "type": "Integer",
                  "metadata": {
                    "description": "Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.",
                    "displayName": "The minimum days before expiry"
                  },
                  "defaultValue": 90
                },
                "secretsActive": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "secretsActiveInDays": {
                  "type": "integer",
                  "defaultValue": 90
                },
                "secretsValidPeriod": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "secretsValidityInDays": {
                  "type": "integer",
                  "defaultValue": 90
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "KvSoftDelete",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvSoftDelete')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvPurgeProtection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvPurgeProtection')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvSecretsExpire",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvSecretsExpire')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvKeysExpire",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvKeysExpire')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvFirewallEnabled",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvFirewallEnabled')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvCertLifetime",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvCertLifetime')]"
                    },
                    "maximumPercentageLife": {
                      "value": "[parameters('maximumCertLifePercentageLife')]"
                    },
                    "minimumDaysBeforeExpiry": {
                      "value": "[parameters('minimumCertLifeDaysBeforeExpiry')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvKeysLifetime",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvKeysLifetime')]"
                    },
                    "minimumDaysBeforeExpiration": {
                      "value": "[parameters('minimumKeysLifeDaysBeforeExpiry')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "KvSecretsLifetime",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('effectKvSecretsLifetime')]"
                    },
                    "minimumDaysBeforeExpiration": {
                      "value": "[parameters('minimumSecretsLifeDaysBeforeExpiry')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-RSA-Keys-without-MinCertSize",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultCheckMinimumRSACertificateSize')]"
                    },
                    "minimumRSAKeySize": {
                      "value": "[parameters('keyVaultMinimumRSACertificateSizeValue')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-keyVaultManagedHsm-RSA-Keys-without-MinKeySize",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultManagedHsmCheckMinimumRSAKeySize')]"
                    },
                    "minimumRSAKeySize": {
                      "value": "[parameters('keyVaultManagedHsmMinimumRSAKeySizeValue')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-RSA-Keys-without-MinKeySize",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultCheckMinimumRSAKeySize')]"
                    },
                    "minimumRSAKeySize": {
                      "value": "[parameters('keyVaultMinimumRSAKeySizeValue')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-without-ArmRbac",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultArmRbac')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Hms-PurgeProtection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultHmsPurgeProtection')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Cert-Period",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultCertificatesPeriod')]"
                    },
                    "maximumValidityInMonths": {
                      "value": "[parameters('keyVaultCertValidPeriod')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Hms-Key-Expire",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultHmsKeysExpiration')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Keys-Expire",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keysValidPeriod')]"
                    },
                    "maximumValidityInDays": {
                      "value": "[parameters('keysValidityInDays')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Secrets-ValidityDays",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('secretsValidPeriod')]"
                    },
                    "maximumValidityInDays": {
                      "value": "[parameters('secretsValidityInDays')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Key-Types",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultCertKeyTypes')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Elliptic-Curve",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultEllipticCurve')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Cryptographic-Type",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultCryptographicType')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Key-Active",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keysActive')]"
                    },
                    "maximumValidityInDays": {
                      "value": "[parameters('keysActiveInDays')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Curve-Names",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keysCurveNames')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-KV-Secret-ActiveDays",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('secretsActive')]"
                    },
                    "maximumValidityInDays": {
                      "value": "[parameters('secretsActiveInDays')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Kv-Secret-Content-Type",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultSecretContentType')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Kv-Non-Integrated-Ca",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341",
                  "parameters": {
                    "caCommonName": {
                      "value": "[parameters('keyVaultNonIntegratedCaValue')]"
                    },
                    "effect": {
                      "value": "[parameters('keyVaultNonIntegratedCa')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Kv-Integrated-Ca",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82",
                  "parameters": {
                    "allowedCAs": {
                      "value": "[parameters('keyVaultIntegratedCaValue')]"
                    },
                    "effect": {
                      "value": "[parameters('keyVaultIntegratedCa')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Kv-Hsm-MinimumDays-Before-Expiration",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultHsmMinimumDaysBeforeExpiration')]"
                    },
                    "minimumDaysBeforeExpiration": {
                      "value": "[parameters('keyVaultHsmMinimumDaysBeforeExpirationValue')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Kv-Hsm-Curve-Names",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e",
                  "parameters": {
                    "allowedECNames": {
                      "value": "[parameters('keyVaultHmsCurveNamesValue')]"
                    },
                    "effect": {
                      "value": "[parameters('keyVaultHmsCurveNames')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Kv-Cert-Expiration-Within-Specific-Number-Days",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427",
                  "parameters": {
                    "daysToExpire": {
                      "value": "[parameters('keyVaultCertificateNotExpireWithinSpecifiedNumberOfDaysValue')]"
                    },
                    "effect": {
                      "value": "[parameters('keyVaultCertificateNotExpireWithinSpecifiedNumberOfDays')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-KeyVault",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:17.2293972Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:17.2293972Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-keyvault-sup": {
            "properties": {
              "displayName": "Enforce additional recommended guardrails for Key Vault",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Key Vault is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Key Vault",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.8252455Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "keyVaultManagedHsmDisablePublicNetworkModify": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "keyVaultModifyFw": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Modify-KV-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultManagedHsmDisablePublicNetworkModify')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-KV-Fw",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('keyVaultModifyFw')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault-Sup",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-KeyVault-Sup",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.7872194Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.7872194Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-kubernetes": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Kubernetes",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Kubernetes is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Kubernetes",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.6234602Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "aksAllowedCapabilities": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksCni": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "aksCommandInvoke": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "aksDefaultNamespace": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksInternalLb": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksKms": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "aksLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksNakedPods": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksPolicy": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "aksPrivContainers": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksPrivEscalation": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksPrivateCluster": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksReadinessOrLivenessProbes": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksShareHostProcessAndNamespace": {
                  "type": "string",
                  "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksTempDisk": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "aksWindowsContainerAdministrator": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Windows-Container-Administrator",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5485eac0-7e8f-4964-998b-a44f4f0c1e75",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksWindowsContainerAdministrator')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Shared-Host-Process-Namespace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksShareHostProcessAndNamespace')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Naked-Pods",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/65280eef-c8b4-425e-9aec-af55e55bf581",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksNakedPods')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Default-Namespace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksDefaultNamespace')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Internal-Lb",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3fc4dc25-5baf-40d8-9b05-7fe74c1bc64e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksInternalLb')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Temp-Disk-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/41425d9f-d1a5-499a-9932-f8ed8453932c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksTempDisk')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Allowed-Capabilities",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksAllowedCapabilities')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Priv-Escalation",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksPrivEscalation')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Priv-Containers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksPrivContainers')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-ReadinessOrLiveness-Probes",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b1a9997f-2883-4f12-bdff-2280f99b5915",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksReadinessOrLivenessProbes')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Aks-Command-Invoke",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b708b0a-3380-40e9-8b79-821f9fa224cc",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksCommandInvoke')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Aks-Policy",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksPolicy')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Private-Cluster",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksPrivateCluster')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/993c2fcd-2b29-49d2-9eb0-df2c3a730c32",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Kms",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dbbdc317-9734-4dd8-9074-993b29c69008",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksKms')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Aks-Cni",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/46238e2f-3f6f-4589-9f3f-77bed4116e67",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('aksCni')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Kubernetes",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Kubernetes",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.4708119Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.4708119Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-machinelearning": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Machine Learning",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Machine Learning is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Machine Learning",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:16.422558Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "mlAllowedModule": {
                  "type": "string",
                  "allowedValues": [
                    "enforceSetting",
                    "disabled"
                  ],
                  "defaultValue": "enforceSetting"
                },
                "mlAllowedPython": {
                  "type": "string",
                  "allowedValues": [
                    "enforceSetting",
                    "disabled"
                  ],
                  "defaultValue": "enforceSetting"
                },
                "mlAllowedRegistries": {
                  "type": "string",
                  "allowedValues": [
                    "enforceSetting",
                    "disabled"
                  ],
                  "defaultValue": "enforceSetting"
                },
                "mlAllowedRegistryDeploy": {
                  "type": "string",
                  "allowedValues": [
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "mlIdleShutdown": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "mlLegacyMode": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "mlLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "mlModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "mlModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "mlOutdatedOS": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "mlPrivateLink": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "mlResourceLogs": {
                  "type": "string",
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "mlUserAssignedIdentity": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "mlVirtualNetwork": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-ML-Outdated-Os",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
                  "parameters": {
                    "effects": {
                      "value": "[parameters('mlOutdatedOS')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ML-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6f9a2d0-cff7-4855-83ad-4cd750666512",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-User-Assigned-Identity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5f0c7d88-c7de-45b8-ac49-db49e72eaa78",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlUserAssignedIdentity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-ML-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a10ee784-7409-4941-b091-663697637c0f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Idle-Shutdown",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/679ddf89-ab8f-48a5-9029-e76054077449",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlIdleShutdown')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Audit-ML-Virtual-Network",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlVirtualNetwork')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Legacy-Mode",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e413671a-dd10-4cc1-a943-45b598596cb7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlLegacyMode')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Audit-ML-Private-Link",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/45e05259-1eb5-4f70-9574-baf73e9d219b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlPrivateLink')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Aine-ML-Resource-Logs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlResourceLogs')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Allowed-Registry-Deploy",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/19539b54-c61e-4196-9a38-67598701be90",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlAllowedRegistryDeploy')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Allowed-Module",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/53c70b02-63dd-11ea-bc55-0242ac130003",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlAllowedModule')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Allowed-Python",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/77eeea86-7e81-4a7d-9067-de844d096752",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlAllowedPython')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-ML-Allowed-Registries",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5853517a-63de-11ea-bc55-0242ac130003",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mlAllowedRegistries')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MachineLearning",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-MachineLearning",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.2987246Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.2987246Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-mysql": {
            "properties": {
              "displayName": "Enforce recommended guardrails for MySQL",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures MySQL is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "MySQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.5785216Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "mySqlAdvThreatProtection": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "mySqlInfraEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Dine-MySql-Adv-Threat-Protection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mySqlAdvThreatProtection')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-MySql-Infra-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3a58212a-c829-4f13-9872-6371df2fd0b4",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('mySqlInfraEncryption')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MySQL",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-MySQL",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.5368096Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.5368096Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-network": {
            "properties": {
              "displayName": "[Deprecated] Enforce recommended guardrails for Network and Networking services",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Network and Networking services are compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "deprecated": true,
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "supersededBy": "Enforce-Guardrails-Network_20250326",
                "version": "1.2.0-deprecated",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:19.2009474Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "afwEmptyIDPSBypassList": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "afwEnableAllIDPSSignatureRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "afwEnableIDPS": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "afwEnableTlsInspection": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "afwEnbaleTlsForAllAppRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appGwTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appGwWaf": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "ddosPlanResourceId": {
                  "type": "string",
                  "defaultValue": ""
                },
                "denyMgmtFromInternet": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "denyMgmtFromInternetPorts": {
                  "type": "Array",
                  "metadata": {
                    "description": "Ports to be blocked",
                    "displayName": "Ports"
                  },
                  "defaultValue": [
                    "22",
                    "3389"
                  ]
                },
                "modifyNsg": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "modifyNsgRuleAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Allow",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "modifyNsgRuleDescription": {
                  "type": "string",
                  "defaultValue": "Deny any outbound traffic to the Internet"
                },
                "modifyNsgRuleDestinationAddressPrefix": {
                  "type": "string",
                  "defaultValue": "Internet"
                },
                "modifyNsgRuleDestinationPortRange": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyNsgRuleDirection": {
                  "type": "string",
                  "defaultValue": "Outbound"
                },
                "modifyNsgRuleName": {
                  "type": "string",
                  "defaultValue": "DenyAnyInternetOutbound"
                },
                "modifyNsgRulePriority": {
                  "type": "integer",
                  "defaultValue": 1000
                },
                "modifyNsgRuleProtocol": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyNsgRuleSourceAddressPrefix": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyNsgRuleSourcePortRange": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyUdr": {
                  "type": "string",
                  "defaultValue": "Disabled"
                },
                "modifyUdrAddressPrefix": {
                  "type": "string",
                  "defaultValue": "0.0.0.0/0"
                },
                "modifyUdrNextHopIpAddress": {
                  "type": "string",
                  "defaultValue": ""
                },
                "modifyUdrNextHopType": {
                  "type": "string",
                  "defaultValue": "None"
                },
                "subnetNsg": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "subnetServiceEndpoint": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "subnetUdr": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "vnetModifyDdos": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "vpnAzureAD": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafAfdEnabled": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafFwRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafMode": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafModeAppGw": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafModeAppGwRequirement": {
                  "type": "string",
                  "defaultValue": "Prevention"
                },
                "wafModeRequirement": {
                  "type": "string",
                  "defaultValue": "Prevention"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Nsg-GW-subnet",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-VPN-AzureAD",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('vpnAzureAD')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-Afd-Enabled",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafAfdEnabled')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-IDPS",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6484db87-a62d-4327-9f07-80a2cbdf333a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('afwEnableIDPS')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FW-AllIDPSS",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/610b6183-5f00-4d68-86d2-4ab4cb3a67a5",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('afwEnableAllIDPSSignatureRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FW-EmpIDPSBypass",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f516dc7a-4543-4d40-aad6-98f76a706b50",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('afwEmptyIDPSBypassList')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FW-TLS-Inspection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/711c24bb-7f18-4578-b192-81a6161e1f17",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('afwEnableTlsInspection')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-FW-TLS-AllApp",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a58ac66d-92cb-409c-94b8-8e48d7a96596",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('afwEnbaleTlsForAllAppRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-AppGw-mode",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafModeAppGw')]"
                    },
                    "modeRequirement": {
                      "value": "[parameters('wafModeAppGwRequirement')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-Fw-rules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/632d3993-e2c0-44ea-a7db-2eca131f356d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafFwRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-mode",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafMode')]"
                    },
                    "modeRequirement": {
                      "value": "[parameters('wafModeRequirement')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-vNet-DDoS",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                  "parameters": {
                    "ddosPlan": {
                      "value": "[parameters('ddosPlanResourceId')]"
                    },
                    "effect": {
                      "value": "[parameters('vnetModifyDdos')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Ip-Forwarding",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-vNic-Pip",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppGw-Without-Waf",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appGwWaf')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Subnet-Without-Udr",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('subnetUdr')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Subnet-Without-NSG",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('subnetNsg')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Subnet-with-Service-Endpoints",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('subnetServiceEndpoint')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Mgmt-From-Internet",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('denyMgmtFromInternet')]"
                    },
                    "ports": {
                      "value": "[parameters('denyMgmtFromInternetPorts')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppGw-Without-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appGwTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Udr",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
                  "parameters": {
                    "addressPrefix": {
                      "value": "[parameters('modifyUdrAddressPrefix')]"
                    },
                    "effect": {
                      "value": "[parameters('modifyUdr')]"
                    },
                    "nextHopIpAddress": {
                      "value": "[parameters('modifyUdrNextHopIpAddress')]"
                    },
                    "nextHopType": {
                      "value": "[parameters('modifyUdrNextHopType')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Nsg",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifyNsg')]"
                    },
                    "nsgRuleAccess": {
                      "value": "[parameters('modifyNsgRuleAccess')]"
                    },
                    "nsgRuleDescription": {
                      "value": "[parameters('modifyNsgRuleDescription')]"
                    },
                    "nsgRuleDestinationAddressPrefix": {
                      "value": "[parameters('modifyNsgRuleDestinationAddressPrefix')]"
                    },
                    "nsgRuleDestinationPortRange": {
                      "value": "[parameters('modifyNsgRuleDestinationPortRange')]"
                    },
                    "nsgRuleDirection": {
                      "value": "[parameters('modifyNsgRuleDirection')]"
                    },
                    "nsgRuleName": {
                      "value": "[parameters('modifyNsgRuleName')]"
                    },
                    "nsgRulePriority": {
                      "value": "[parameters('modifyNsgRulePriority')]"
                    },
                    "nsgRuleProtocol": {
                      "value": "[parameters('modifyNsgRuleProtocol')]"
                    },
                    "nsgRuleSourceAddressPrefix": {
                      "value": "[parameters('modifyNsgRuleSourceAddressPrefix')]"
                    },
                    "nsgRuleSourcePortRange": {
                      "value": "[parameters('modifyNsgRuleSourcePortRange')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Network",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.9717276Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.9717276Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-network_20250326": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Network and Networking services",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Network and Networking services are compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Network",
                "replacesPolicy": "Enforce-Guardrails-Network",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "2.0.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:12.0552114Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "appGwTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "appGwWaf": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "ddosPlanResourceId": {
                  "type": "string",
                  "defaultValue": ""
                },
                "denyMgmtFromInternet": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "denyMgmtFromInternetPorts": {
                  "type": "Array",
                  "metadata": {
                    "description": "Ports to be blocked",
                    "displayName": "Ports"
                  },
                  "defaultValue": [
                    "22",
                    "3389"
                  ]
                },
                "modifyNsg": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "modifyNsgRuleAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Allow",
                    "Deny"
                  ],
                  "defaultValue": "Deny"
                },
                "modifyNsgRuleDescription": {
                  "type": "string",
                  "defaultValue": "Deny any outbound traffic to the Internet"
                },
                "modifyNsgRuleDestinationAddressPrefix": {
                  "type": "string",
                  "defaultValue": "Internet"
                },
                "modifyNsgRuleDestinationPortRange": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyNsgRuleDirection": {
                  "type": "string",
                  "defaultValue": "Outbound"
                },
                "modifyNsgRuleName": {
                  "type": "string",
                  "defaultValue": "DenyAnyInternetOutbound"
                },
                "modifyNsgRulePriority": {
                  "type": "integer",
                  "defaultValue": 1000
                },
                "modifyNsgRuleProtocol": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyNsgRuleSourceAddressPrefix": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyNsgRuleSourcePortRange": {
                  "type": "string",
                  "defaultValue": "*"
                },
                "modifyUdr": {
                  "type": "string",
                  "defaultValue": "Disabled"
                },
                "modifyUdrAddressPrefix": {
                  "type": "string",
                  "defaultValue": "0.0.0.0/0"
                },
                "modifyUdrNextHopIpAddress": {
                  "type": "string",
                  "defaultValue": ""
                },
                "modifyUdrNextHopType": {
                  "type": "string",
                  "defaultValue": "None"
                },
                "subnetNsg": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "subnetServiceEndpoint": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "subnetUdr": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "vnetModifyDdos": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "vpnAzureAD": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafAfdEnabled": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafFwRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafMode": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafModeAppGw": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "wafModeAppGwRequirement": {
                  "type": "string",
                  "defaultValue": "Prevention"
                },
                "wafModeRequirement": {
                  "type": "string",
                  "defaultValue": "Prevention"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Nsg-GW-subnet",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-VPN-AzureAD",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('vpnAzureAD')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-Afd-Enabled",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafAfdEnabled')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-AppGw-mode",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafModeAppGw')]"
                    },
                    "modeRequirement": {
                      "value": "[parameters('wafModeAppGwRequirement')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-Fw-rules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafFwRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Waf-mode",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('wafMode')]"
                    },
                    "modeRequirement": {
                      "value": "[parameters('wafModeRequirement')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-vNet-DDoS",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                  "parameters": {
                    "ddosPlan": {
                      "value": "[parameters('ddosPlanResourceId')]"
                    },
                    "effect": {
                      "value": "[parameters('vnetModifyDdos')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Ip-Forwarding",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-vNic-Pip",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppGw-Without-Waf",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appGwWaf')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Subnet-Without-Udr",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('subnetUdr')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Subnet-Without-NSG",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('subnetNsg')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Subnet-with-Service-Endpoints",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('subnetServiceEndpoint')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Mgmt-From-Internet",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('denyMgmtFromInternet')]"
                    },
                    "ports": {
                      "value": "[parameters('denyMgmtFromInternetPorts')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AppGw-Without-Tls",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('appGwTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Udr",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
                  "parameters": {
                    "addressPrefix": {
                      "value": "[parameters('modifyUdrAddressPrefix')]"
                    },
                    "effect": {
                      "value": "[parameters('modifyUdr')]"
                    },
                    "nextHopIpAddress": {
                      "value": "[parameters('modifyUdrNextHopIpAddress')]"
                    },
                    "nextHopType": {
                      "value": "[parameters('modifyUdrNextHopType')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Nsg",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifyNsg')]"
                    },
                    "nsgRuleAccess": {
                      "value": "[parameters('modifyNsgRuleAccess')]"
                    },
                    "nsgRuleDescription": {
                      "value": "[parameters('modifyNsgRuleDescription')]"
                    },
                    "nsgRuleDestinationAddressPrefix": {
                      "value": "[parameters('modifyNsgRuleDestinationAddressPrefix')]"
                    },
                    "nsgRuleDestinationPortRange": {
                      "value": "[parameters('modifyNsgRuleDestinationPortRange')]"
                    },
                    "nsgRuleDirection": {
                      "value": "[parameters('modifyNsgRuleDirection')]"
                    },
                    "nsgRuleName": {
                      "value": "[parameters('modifyNsgRuleName')]"
                    },
                    "nsgRulePriority": {
                      "value": "[parameters('modifyNsgRulePriority')]"
                    },
                    "nsgRuleProtocol": {
                      "value": "[parameters('modifyNsgRuleProtocol')]"
                    },
                    "nsgRuleSourceAddressPrefix": {
                      "value": "[parameters('modifyNsgRuleSourceAddressPrefix')]"
                    },
                    "nsgRuleSourcePortRange": {
                      "value": "[parameters('modifyNsgRuleSourcePortRange')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network_20250326",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Network_20250326",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.9011105Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.9011105Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-openai": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Open AI (Cognitive Service)",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Open AI (Cognitive Service) is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Cognitive Services",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:27.0669751Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "azureAiDiagSettings": {
                  "type": "string",
                  "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "AuditIfNotExists"
                },
                "azureAiDisableLocalKey": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "azureAiDisableLocalKey2": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "azureAiNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "azureAiPrivateLink": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "cognitiveServicesCustomerStorage": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesDisableLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesManagedIdentity": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesModifyDisableLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "cognitiveServicesNetworkAcls": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "cognitiveServicesOutboundNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-OpenAi-OutboundNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesOutboundNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-OpenAi-NetworkAcls",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesNetworkAcls')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Managed-Identity",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe3fd216-4f83-4fc1-8984-2bbec80a3418",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesManagedIdentity')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesDisableLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Cognitive-Services-Cust-Storage",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/46aa9b05-0e60-4eae-a88b-1e9d374fa515",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesCustomerStorage')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Cognitive-Services-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/14de9e63-1b31-492e-a5a3-c3f7fd57f555",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('cognitiveServicesModifyDisableLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-AzureAI-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('azureAiNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Audit-AzureAI-Private-Link",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('azureAiPrivateLink')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-AzureAI-Local-Key",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d45520cb-31ca-44ba-8da2-fcf914608544",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('azureAiDisableLocalKey')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-AzureAI-Local-Key2",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55eff01b-f2bd-4c32-9203-db285f709d30",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('azureAiDisableLocalKey2')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Aine-AzureAI-Diag-Settings",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('azureAiDiagSettings')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-OpenAI",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-OpenAI",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:26.9198765Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:26.9198765Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-postgresql": {
            "properties": {
              "displayName": "Enforce recommended guardrails for PostgreSQL",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures PostgreSQL is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "PostgreSQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:15.8377604Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "postgreSqlAdvThreatProtection": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Dine-PostgreSql-Adv-Threat-Protection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('postgreSqlAdvThreatProtection')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-PostgreSQL",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-PostgreSQL",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:15.7918789Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:15.7918789Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-servicebus": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Service Bus",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Service Bus is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Service Bus",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.0850976Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "serviceBusAuthzRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "serviceBusDenyDisabledLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "serviceBusDoubleEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "serviceBusModifyDisableLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Sb-Authz-Rules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('serviceBusAuthzRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sb-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ebaf4f25-a4e8-415f-86a8-42d9155bef0b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('serviceBusDoubleEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sb-LocalAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfb11c26-f069-4c14-8e36-56c394dae5af",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('serviceBusDenyDisabledLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Sb-LocalAuth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/910711a6-8aa2-4f15-ae62-1e5b2ed3ef9e",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('serviceBusModifyDisableLocalAuth')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ServiceBus",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-ServiceBus",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.0515889Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.0515889Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-sql": {
            "properties": {
              "displayName": "Enforce recommended guardrails for SQL and SQL Managed Instance",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures SQL and SQL Managed Instance is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "SQL",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:11.3592531Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "modifySqlPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "sqlAadOnly": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlManagedAadOnly": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "sqlManagedDefender": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Dine-Sql-Managed-Defender",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlManagedDefender')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Aad-Only",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlAadOnly')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Sql-Managed-Aad-Only",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('sqlManagedAadOnly')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Sql-Adv-Data",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6",
                  "parameters": {},
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Sql-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/28b0b1e5-17ba-4963-a7a4-5a1ab4400a0b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifySqlPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-SQL",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-SQL",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:11.3028207Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:11.3028207Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-storage": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Storage Account",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Storage is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Storage",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:18.5280333Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "modifyStorageAccountPublicEndpoint": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "modifyStorageFileSyncPublicEndpoint": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "storageAccountNetworkRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountRestrictNetworkRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountSharedKey": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsAllowedCopyScope": {
                  "type": "string",
                  "defaultValue": "AAD"
                },
                "storageAccountsCopyScope": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsCrossTenant": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsDoubleEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsInfraEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageAccountsModifyDisablePublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "storageAllowedNetworkAclsBypass": {
                  "type": "array",
                  "defaultValue": [
                    "None"
                  ]
                },
                "storageClassicToArm": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageContainerDeleteRetentionPolicy": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageCorsRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageKeysExpiration": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageLocalUser": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Disabled"
                },
                "storageMinContainerDeleteRetentionInDays": {
                  "type": "Integer",
                  "defaultValue": 7
                },
                "storageNetworkAclsBypass": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageNetworkAclsVirtualNetworkRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageResourceAccessRulesResourceId": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageResourceAccessRulesTenantId": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageServicesEncryption": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageSftp": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "storageThreatProtection": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Deny-Storage-CopyScope",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope",
                  "parameters": {
                    "allowedCopyScope": {
                      "value": "[parameters('storageAccountsAllowedCopyScope')]"
                    },
                    "effect": {
                      "value": "[parameters('storageAccountsCopyScope')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-ServicesEncryption",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageServicesEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-LocalUser",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageLocalUser')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-SFTP",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageSftp')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-NetworkAclsBypass",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass",
                  "parameters": {
                    "allowedBypassOptions": {
                      "value": "[parameters('storageAllowedNetworkAclsBypass')]"
                    },
                    "effect": {
                      "value": "[parameters('storageNetworkAclsBypass')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-ResourceAccessRulesTenantId",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageResourceAccessRulesTenantId')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-ResourceAccessRulesResourceId",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageResourceAccessRulesResourceId')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-NetworkAclsVirtualNetworkRules",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageNetworkAclsVirtualNetworkRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-ContainerDeleteRetentionPolicy",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageContainerDeleteRetentionPolicy')]"
                    },
                    "minContainerDeleteRetentionInDays": {
                      "value": "[parameters('storageMinContainerDeleteRetentionInDays')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-CorsRules",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageCorsRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Account-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bfecdea6-31c4-4045-ad42-71b9dc87247d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsDoubleEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Cross-Tenant",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92a89a79-6c52-4a7e-a03f-61306fc49312",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsCrossTenant')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Shared-Key",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountSharedKey')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Infra-Encryption",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsInfraEncryption')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Classic",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageClassicToArm')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Dine-Storage-Threat-Protection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageThreatProtection')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Restrict-NetworkRules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountRestrictNetworkRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-NetworkRules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountNetworkRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Storage-Account-Keys-Expire",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/044985bb-afe1-42cd-8a36-9d5d42424537",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageKeysExpiration')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Storage-FileSync-PublicEndpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e07b2e9-6cd9-4c40-9ccb-52817b95133b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifyStorageFileSyncPublicEndpoint')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Blob-Storage-Account-PublicEndpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('modifyStorageAccountPublicEndpoint')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Storage-Account-PublicEndpoint",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a06d0189-92e8-4dba-b0c4-08d7669fce7d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('storageAccountsModifyDisablePublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Storage",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Storage",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:18.3997364Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:18.3997364Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-synapse": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Synapse workspaces",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Synapse workspaces is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Synapse",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.2.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:12.1220273Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "synapseAllowedTenantIds": {
                  "type": "array",
                  "defaultValue": [
                    "[subscription().tenantId]"
                  ]
                },
                "synapseDataTraffic": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "synapseDefender": {
                  "type": "string",
                  "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                  ],
                  "defaultValue": "DeployIfNotExists"
                },
                "synapseFwRules": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Disabled"
                  ],
                  "defaultValue": "Audit"
                },
                "synapseLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "synapseManagedVnet": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                },
                "synapseModifyLocalAuth": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "synapseModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "synapseModifyTlsVersion": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "synapseTenants": {
                  "type": "string",
                  "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                  ],
                  "defaultValue": "Deny"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Dine-Synapse-Defender",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseDefender')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Synapse-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c3624673-d2ff-48e0-b28c-5de1c6767c3c",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseModifyLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Fw-Rules",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseFwRules')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Tenant-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3a003702-13d2-4679-941b-937e58c443f0",
                  "parameters": {
                    "allowedTenantIds": {
                      "value": "[parameters('synapseAllowedTenantIds')]"
                    },
                    "effect": {
                      "value": "[parameters('synapseTenants')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Data-Traffic",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3484ce98-c0c5-4c83-994b-c5ac24785218",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseDataTraffic')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Managed-Vnet",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d9dbfa3-927b-4cf0-9d0f-08747f971650",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseManagedVnet')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Deny-Synapse-Local-Auth",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseLocalAuth')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Synapse-Tls-Version",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8b5c654c-fb07-471b-aa8f-15fea733f140",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseModifyTlsVersion')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Synapse-Public-Network-Access",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c8cad01-ef30-4891-b230-652dadb4876a",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('synapseModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Synapse",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-Synapse",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:12.052455Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:12.052455Z"
            }
          },
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/policysetdefinitions/enforce-guardrails-virtualdesktop": {
            "properties": {
              "displayName": "Enforce recommended guardrails for Virtual Desktop",
              "policyType": "Custom",
              "description": "This policy initiative is a group of policies that ensures Virtual Desktop is compliant per regulated Landing Zones.",
              "metadata": {
                "alzCloudEnvironments": [
                  "AzureCloud",
                  "AzureChinaCloud",
                  "AzureUSGovernment"
                ],
                "category": "Desktop Virtualization",
                "source": "https://github.com/Azure/Enterprise-Scale/",
                "version": "1.1.0",
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:16.6325783Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "parameters": {
                "avdHostPoolModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                },
                "avdWorkspaceModifyPublicNetworkAccess": {
                  "type": "string",
                  "allowedValues": [
                    "Modify",
                    "Disabled"
                  ],
                  "defaultValue": "Modify"
                }
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "Modify-Workspace-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ce6ebf1d-0b94-4df9-9257-d8cacc238b4f",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('avdWorkspaceModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                },
                {
                  "policyDefinitionReferenceId": "Modify-Hostpool-PublicNetworkAccess",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a0913ff-51e7-47b8-97bb-ea17127f7c8d",
                  "parameters": {
                    "effect": {
                      "value": "[parameters('avdHostPoolModifyPublicNetworkAccess')]"
                    }
                  },
                  "groupNames": []
                }
              ],
              "policyDefinitionGroups": []
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-VirtualDesktop",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Enforce-Guardrails-VirtualDesktop",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:16.2511731Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:16.2511731Z"
            }
          }
        },
        "BlueprintDefinitions": {},
        "PolicyAssignments": {
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-ResourceRGLocation": {
            "identity": {
              "type": "None"
            },
            "properties": {
              "displayName": "Resource Group and Resource locations should match",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "Resource Group and Resource locations should match.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:35.0186213Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Resources must be deployed in the same region as the Resource Group."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-ResourceRGLocation",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Audit-ResourceRGLocation",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:34.9943132Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:34.9943132Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-TrustedLaunch": {
            "identity": {
              "type": "None"
            },
            "properties": {
              "displayName": "Audit virtual machines for Trusted Launch support",
              "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "effect": {
                  "value": "Audit"
                }
              },
              "description": "Trusted Launch improves security of a Virtual Machine which requires VM SKU, OS Disk & OS Image to support it (Gen 2). To learn more about Trusted Launch, visit https://aka.ms/trustedlaunch.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:28.7384566Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Trusted Launch must be used on supported virtual machines for enhanced security."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-TrustedLaunch",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Audit-TrustedLaunch",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:28.6931082Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:28.6931082Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources": {
            "identity": {
              "type": "None"
            },
            "properties": {
              "displayName": "Unused resources driving cost should be avoided",
              "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "EffectDisks": {
                  "value": "Audit"
                },
                "EffectPublicIpAddresses": {
                  "value": "Audit"
                },
                "EffectServerFarms": {
                  "value": "Audit"
                }
              },
              "description": "This Policy initiative is a group of Policy definitions that help optimize cost by detecting unused but chargeable resources. Leverage this Policy initiative as a cost control to reveal orphaned resources that are driving cost.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:50.3901981Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Unused resources driving cost must be avoided."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Audit-UnusedResources",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:50.3180565Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:50.3180565Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-ZoneResiliency": {
            "identity": {
              "type": "None"
            },
            "properties": {
              "displayName": "Resources should be Zone Resilient",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/130fb88f-0fc9-4678-bfe1-31022d71c7d5",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "allow": {
                  "value": "Both"
                },
                "effect": {
                  "value": "Audit"
                }
              },
              "description": "Resources should be Zone Resilient.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:44.6557592Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Resources must be Zone Resilient."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Audit-ZoneResiliency",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Audit-ZoneResiliency",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:44.5610555Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:44.5610555Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources": {
            "identity": {
              "type": "None"
            },
            "properties": {
              "displayName": "Deny the deployment of classic resources",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "effect": {
                  "value": "Deny"
                },
                "listOfResourceTypesNotAllowed": {
                  "value": [
                    "Microsoft.ClassicCompute/capabilities",
                    "Microsoft.ClassicCompute/checkDomainNameAvailability",
                    "Microsoft.ClassicCompute/domainNames",
                    "Microsoft.ClassicCompute/domainNames/capabilities",
                    "Microsoft.ClassicCompute/domainNames/internalLoadBalancers",
                    "Microsoft.ClassicCompute/domainNames/serviceCertificates",
                    "Microsoft.ClassicCompute/domainNames/slots",
                    "Microsoft.ClassicCompute/domainNames/slots/roles",
                    "Microsoft.ClassicCompute/domainNames/slots/roles/metricDefinitions",
                    "Microsoft.ClassicCompute/domainNames/slots/roles/metrics",
                    "Microsoft.ClassicCompute/moveSubscriptionResources",
                    "Microsoft.ClassicCompute/operatingSystemFamilies",
                    "Microsoft.ClassicCompute/operatingSystems",
                    "Microsoft.ClassicCompute/operations",
                    "Microsoft.ClassicCompute/operationStatuses",
                    "Microsoft.ClassicCompute/quotas",
                    "Microsoft.ClassicCompute/resourceTypes",
                    "Microsoft.ClassicCompute/validateSubscriptionMoveAvailability",
                    "Microsoft.ClassicCompute/virtualMachines",
                    "Microsoft.ClassicCompute/virtualMachines/diagnosticSettings",
                    "Microsoft.ClassicCompute/virtualMachines/metricDefinitions",
                    "Microsoft.ClassicCompute/virtualMachines/metrics",
                    "Microsoft.ClassicInfrastructureMigrate/classicInfrastructureResources",
                    "Microsoft.ClassicNetwork/capabilities",
                    "Microsoft.ClassicNetwork/expressRouteCrossConnections",
                    "Microsoft.ClassicNetwork/expressRouteCrossConnections/peerings",
                    "Microsoft.ClassicNetwork/gatewaySupportedDevices",
                    "Microsoft.ClassicNetwork/networkSecurityGroups",
                    "Microsoft.ClassicNetwork/operations",
                    "Microsoft.ClassicNetwork/quotas",
                    "Microsoft.ClassicNetwork/reservedIps",
                    "Microsoft.ClassicNetwork/virtualNetworks",
                    "Microsoft.ClassicNetwork/virtualNetworks/remoteVirtualNetworkPeeringProxies",
                    "Microsoft.ClassicNetwork/virtualNetworks/virtualNetworkPeerings",
                    "Microsoft.ClassicStorage/capabilities",
                    "Microsoft.ClassicStorage/checkStorageAccountAvailability",
                    "Microsoft.ClassicStorage/disks",
                    "Microsoft.ClassicStorage/images",
                    "Microsoft.ClassicStorage/operations",
                    "Microsoft.ClassicStorage/osImages",
                    "Microsoft.ClassicStorage/osPlatformImages",
                    "Microsoft.ClassicStorage/publicImages",
                    "Microsoft.ClassicStorage/quotas",
                    "Microsoft.ClassicStorage/storageAccounts",
                    "Microsoft.ClassicStorage/storageAccounts/blobServices",
                    "Microsoft.ClassicStorage/storageAccounts/fileServices",
                    "Microsoft.ClassicStorage/storageAccounts/metricDefinitions",
                    "Microsoft.ClassicStorage/storageAccounts/metrics",
                    "Microsoft.ClassicStorage/storageAccounts/queueServices",
                    "Microsoft.ClassicStorage/storageAccounts/services",
                    "Microsoft.ClassicStorage/storageAccounts/services/diagnosticSettings",
                    "Microsoft.ClassicStorage/storageAccounts/services/metricDefinitions",
                    "Microsoft.ClassicStorage/storageAccounts/services/metrics",
                    "Microsoft.ClassicStorage/storageAccounts/tableServices",
                    "Microsoft.ClassicStorage/storageAccounts/vmImages",
                    "Microsoft.ClassicStorage/vmImages",
                    "Microsoft.ClassicSubscription/operations"
                  ]
                }
              },
              "description": "Denies deployment of classic resource types under the assigned scope.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:47.6517271Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Classic resources must not be deployed."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deny-Classic-Resources",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:47.6236334Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:47.6236334Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk": {
            "identity": {
              "type": "None"
            },
            "properties": {
              "displayName": "Deny virtual machines and virtual machine scale sets that do not use managed disk",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "Deny virtual machines that do not use managed disk. It checks the managed disk property on virtual machine OS Disk fields.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:44.2376178Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Virtual machines and virtual machine scales sets must use a managed disk."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deny-UnmanagedDisk",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:44.2130125Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:44.2130125Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring": {
            "identity": {
              "principalId": "9ad036b0-0bbe-462d-80cc-55e8a118c989",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Microsoft Cloud Security Benchmark",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "Microsoft Cloud Security Benchmark policy initiative.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:32.9149902Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Microsoft Cloud Security Benchmark must be met."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-ASC-Monitoring",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:30.7071969Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:30.7071969Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log": {
            "identity": {
              "principalId": "64a5556e-e809-46ca-98ad-41a4aeef802f",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "logAnalytics": {
                  "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
                },
                "logsEnabled": {
                  "value": "True"
                }
              },
              "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:32.9931081Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Azure Activity logs must be configured to stream to specified Log Analytics workspace."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-AzActivity-Log",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:32.5254151Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:32.5254151Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-LogsCat": {
            "identity": {
              "principalId": "f49137a2-3586-48ed-b5ec-28f2b3ea8f8b",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Enable category group resource logging for supported resources to Log Analytics",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/f5b29bc4-feca-4cc6-a58a-772dd5e290a5",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "logAnalytics": {
                  "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
                }
              },
              "description": "Resource logs should be enabled to track activities and events that take place on your resources and give you visibility and insights into any changes that occur. This initiative deploys diagnostic setting using the allLogs category group to route logs to an Event Hub for all supported resources.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:28.5650789Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Diagnostic settings must be deployed to Azure services to forward logs to Log Analytics."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-LogsCat",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-Diag-LogsCat",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:27.7126254Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:27.7126254Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints": {
            "identity": {
              "principalId": "a6326185-c8e3-48a7-be39-911e45867dfe",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "[Preview]: Deploy Microsoft Defender for Endpoint agent",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/e20d08c5-6d64-656d-6465-ce9e37fd0ebc",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "microsoftDefenderForEndpointLinuxArcAgentDeployEffect": {
                  "value": "DeployIfNotExists"
                },
                "microsoftDefenderForEndpointLinuxVmAgentDeployEffect": {
                  "value": "DeployIfNotExists"
                },
                "microsoftDefenderForEndpointWindowsArcAgentDeployEffect": {
                  "value": "DeployIfNotExists"
                },
                "microsoftDefenderForEndpointWindowsVmAgentDeployEffect": {
                  "value": "DeployIfNotExists"
                }
              },
              "description": "Deploy Microsoft Defender for Endpoint agent on applicable images.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:28.9205217Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Microsoft Defender for Endpoint agent must be deployed on applicable images."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-MDEndpoints",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:27.644268Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:27.644268Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA": {
            "identity": {
              "principalId": "ec0f767e-03c8-4d5a-a4a8-27aff9951fa1",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Configure multiple Microsoft Defender for Endpoint integration settings with Microsoft Defender for Cloud",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/77b391e3-2d5d-40c3-83bf-65c846b3c6a3",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "Configure the multiple Microsoft Defender for Endpoint integration settings with Microsoft Defender for Cloud (WDATP, WDATP_EXCLUDE_LINUX_PUBLIC_PREVIEW, WDATP_UNIFIED_SOLUTION etc.). See: https://learn.microsoft.com/azure/defender-for-cloud/integration-defender-for-endpoint for more information.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:34.171397Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Microsoft Defender for Endpoint must be deployed."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-MDEndpointsAMA",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:33.6401262Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:33.6401262Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224": {
            "identity": {
              "principalId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Deploy Microsoft Defender for Cloud configuration",
              "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "ascExportResourceGroupLocation": {
                  "value": "eastus2"
                },
                "ascExportResourceGroupName": {
                  "value": "rg-asc-export-eastus2"
                },
                "emailSecurityContact": {
                  "value": "autocloudarc@outlook.com"
                },
                "enableAscForAppServices": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForArm": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForContainers": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForCosmosDbs": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForCspm": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForKeyVault": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForOssDb": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForServers": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForServersVulnerabilityAssessments": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForSql": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForSqlOnVm": {
                  "value": "DeployIfNotExists"
                },
                "enableAscForStorage": {
                  "value": "DeployIfNotExists"
                },
                "logAnalytics": {
                  "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
                }
              },
              "description": "Deploy Microsoft Defender for Cloud and Security Contacts",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:29.5798251Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Microsoft Defender for Cloud and Security Contacts must be deployed."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-MDFC-Config-H224",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:28.8371827Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:28.8371827Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb": {
            "identity": {
              "principalId": "2c5561ee-d8d7-49ce-bcdf-cd4a76b10b2b",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Configure Advanced Threat Protection to be enabled on open-source relational databases",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "Enable Advanced Threat Protection on your non-Basic tier open-source relational databases to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. See https://aka.ms/AzDforOpenSourceDBsDocu.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:29.3145404Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Advanced Threat Protection must be enabled on open-source relational databases."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-MDFC-OssDb",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:28.2567699Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:28.2567699Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp": {
            "identity": {
              "principalId": "6b963187-5a69-41b8-bdd8-f31549be4d75",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Configure Azure Defender to be enabled on SQL Servers and SQL Managed Instances",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "Enable Azure Defender on your SQL Servers and SQL Managed Instances to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:33.4395826Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Azure Defender must be enabled on SQL Servers and SQL Managed Instances."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-MDFC-SqlAtp",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:32.7643716Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:32.7643716Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-SvcHealth-BuiltIn": {
            "identity": {
              "principalId": "d3c29b08-f4fd-4660-b8ae-b96018c98846",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Configure subscriptions to enable service health alert monitoring rule",
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98903777-a9f6-47f5-90a9-acaf62ab01a8",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {
                "actionGroupResources": {
                  "value": {
                    "actionGroupEmail": [],
                    "eventHubResourceId": [],
                    "functionResourceId": "",
                    "functionTriggerUrl": "",
                    "logicappCallbackUrl": "",
                    "logicappResourceId": "",
                    "webhookServiceUri": []
                  }
                },
                "actionGroupRoleIds": {
                  "value": [
                    "Owner"
                  ]
                },
                "resourceGroupLocation": {
                  "value": "${default_location}"
                }
              },
              "description": "Assignable at the subscription or management group level, this policy ensures that each subscription has a service health alert rule configured with alert conditions and mapping to action groups as specified in the policy parameters. By default creates a resource group, alert rule and action group configured to send emails to subscription owners for all service health events.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:51.8838692Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Service Health alerts must be configured on all subscriptions."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Deploy-SvcHealth-BuiltIn",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Deploy-SvcHealth-BuiltIn",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:51.3839345Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:51.3839345Z"
            }
          },
          "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB": {
            "identity": {
              "principalId": "c8234718-816c-4fe9-b023-f5dda473b612",
              "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
              "type": "SystemAssigned"
            },
            "properties": {
              "displayName": "Enforce Azure Compute Security Baseline compliance auditing",
              "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
              "scope": "/providers/Microsoft.Management/managementGroups/alz",
              "notScopes": [],
              "parameters": {},
              "description": "This initiative assignment enables Azure Compute Security Baseline compliance auditing for Windows and Linux virtual machines.",
              "metadata": {
                "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                "createdOn": "2026-01-21T00:37:31.2148597Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "enforcementMode": "Default",
              "nonComplianceMessages": [
                {
                  "message": "Azure Compute Security Baseline compliance auditing must be enforced."
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB",
            "type": "Microsoft.Authorization/policyAssignments",
            "name": "Enforce-ACSB",
            "location": "eastus2",
            "systemData": {
              "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "createdByType": "Application",
              "createdAt": "2026-01-21T00:37:30.5242068Z",
              "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
              "lastModifiedByType": "Application",
              "lastModifiedAt": "2026-01-21T00:37:30.5242068Z"
            }
          }
        },
        "RoleAssignments": {
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/01c6ca0d-4d98-5221-bcb2-7b1e583e1092": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/01c6ca0d-4d98-5221-bcb2-7b1e583e1092",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Security Admin",
              "RoleDefinitionId": "fb1c8493-542b-48eb-b624-b4c8fea62acd",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/1034b018-6b7e-5f50-abe4-fc055d45ca7a": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/1034b018-6b7e-5f50-abe4-fc055d45ca7a",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Enforce-ACSB",
              "SignInName": null,
              "RoleDefinitionName": "Contributor",
              "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
              "ObjectId": "c8234718-816c-4fe9-b023-f5dda473b612",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/164da090-4a2d-580a-a623-53027bb37df7": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/164da090-4a2d-580a-a623-53027bb37df7",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-SvcHealth-BuiltIn",
              "SignInName": null,
              "RoleDefinitionName": "Monitoring Policy Contributor",
              "RoleDefinitionId": "47be4a87-7950-4631-9daf-b664a405f074",
              "ObjectId": "d3c29b08-f4fd-4660-b8ae-b96018c98846",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/25c80a67-378c-57ef-8a96-0c4ec5929097": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/25c80a67-378c-57ef-8a96-0c4ec5929097",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDEndpoints",
              "SignInName": null,
              "RoleDefinitionName": "Contributor",
              "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
              "ObjectId": "a6326185-c8e3-48a7-be39-911e45867dfe",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/27a5a584-fb04-5777-924f-67514ea68bb7": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/27a5a584-fb04-5777-924f-67514ea68bb7",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-AzActivity-Log",
              "SignInName": null,
              "RoleDefinitionName": "Monitoring Contributor",
              "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "ObjectId": "64a5556e-e809-46ca-98ad-41a4aeef802f",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/59b33418-65ac-552d-80c1-0793f5f40dfe": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/59b33418-65ac-552d-80c1-0793f5f40dfe",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDEndpointsAMA",
              "SignInName": null,
              "RoleDefinitionName": "Security Admin",
              "RoleDefinitionId": "fb1c8493-542b-48eb-b624-b4c8fea62acd",
              "ObjectId": "ec0f767e-03c8-4d5a-a4a8-27aff9951fa1",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/65318e41-42aa-5f93-9dd2-47fe674700a9": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/65318e41-42aa-5f93-9dd2-47fe674700a9",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Azure Kubernetes Service Policy Add-on Deployment",
              "RoleDefinitionId": "18ed5180-3e48-46fd-8541-4ea054d57064",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/8c2eae47-5281-5678-b118-375a905f05e8": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/8c2eae47-5281-5678-b118-375a905f05e8",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Owner",
              "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/9bfcad9a-e001-5e1d-89ff-2e447c8ba752": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/9bfcad9a-e001-5e1d-89ff-2e447c8ba752",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-Diag-LogsCat",
              "SignInName": null,
              "RoleDefinitionName": "Log Analytics Contributor",
              "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "ObjectId": "f49137a2-3586-48ed-b5ec-28f2b3ea8f8b",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/a774183c-630c-4a13-9317-e89bc9d0f502": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/a774183c-630c-4a13-9317-e89bc9d0f502",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "azgovviz-accelerator-01",
              "SignInName": null,
              "RoleDefinitionName": "Reader",
              "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
              "ObjectId": "7f46b4ac-9b5a-4329-b133-8fcb8a6c43ff",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/bf87e8c5-c3c5-4d31-a2cc-8360ec586267": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/bf87e8c5-c3c5-4d31-a2cc-8360ec586267",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "id-alz-mgmt-eastus2-apply-001",
              "SignInName": null,
              "RoleDefinitionName": "Owner",
              "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
              "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/c5b402ad-c13f-5446-ad35-7ef4fb49f05d": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/c5b402ad-c13f-5446-ad35-7ef4fb49f05d",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Defender Kubernetes Agent Operator",
              "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/c8667f09-bf4d-52c1-88fb-3d720087c030": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/c8667f09-bf4d-52c1-88fb-3d720087c030",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
              "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/cc772067-4212-5f54-82d8-7290828c17fe": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/cc772067-4212-5f54-82d8-7290828c17fe",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-AzActivity-Log",
              "SignInName": null,
              "RoleDefinitionName": "Log Analytics Contributor",
              "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "ObjectId": "64a5556e-e809-46ca-98ad-41a4aeef802f",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/d0df3747-e489-5ff5-9661-ad3688369170": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/d0df3747-e489-5ff5-9661-ad3688369170",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Defender Containers Sensor",
              "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/e4ea43cf-e1bb-5083-92bc-3ba0590d1f06": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/e4ea43cf-e1bb-5083-92bc-3ba0590d1f06",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-Config-H224",
              "SignInName": null,
              "RoleDefinitionName": "Contributor",
              "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
              "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/e6e60993-40bd-58b7-bf3e-13d8252e0aaf": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/e6e60993-40bd-58b7-bf3e-13d8252e0aaf",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-OssDb",
              "SignInName": null,
              "RoleDefinitionName": "Contributor",
              "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
              "ObjectId": "2c5561ee-d8d7-49ce-bcdf-cd4a76b10b2b",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/ee52860b-6488-5691-813b-168bf4fb16e0": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/alz/providers/microsoft.authorization/roleassignments/ee52860b-6488-5691-813b-168bf4fb16e0",
              "Scope": "/providers/Microsoft.Management/managementGroups/alz",
              "DisplayName": "Deploy-MDFC-SqlAtp",
              "SignInName": null,
              "RoleDefinitionName": "SQL Security Manager",
              "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
              "ObjectId": "6b963187-5a69-41b8-bdd8-f31549be4d75",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ]
        },
        "DiagnosticSettings": {},
        "Subscriptions": {},
        "ManagementGroups": {
          "decommissioned": {
            "MgId": "decommissioned",
            "MgName": "Decommissioned",
            "mgParentId": "alz",
            "mgParentName": "Azure Landing Zones",
            "level": "2",
            "PolicyDefinitionsCustom": {},
            "PolicySetDefinitionsCustom": {},
            "BlueprintDefinitions": {},
            "PolicyAssignments": {
              "/providers/Microsoft.Management/managementGroups/decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm": {
                "identity": {
                  "principalId": "bfc54ace-219e-4516-8c28-de1e2daaaa34",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce ALZ Decommissioned Guardrails",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
                  "scope": "/providers/Microsoft.Management/managementGroups/decommissioned",
                  "notScopes": [],
                  "parameters": {
                    "listOfResourceTypesAllowed": {
                      "value": [
                        "microsoft.consumption/tags",
                        "microsoft.authorization/roleassignments",
                        "microsoft.authorization/roledefinitions",
                        "microsoft.authorization/policyassignments",
                        "microsoft.authorization/locks",
                        "microsoft.authorization/policydefinitions",
                        "microsoft.authorization/policysetdefinitions",
                        "microsoft.resources/tags",
                        "microsoft.authorization/roleeligibilityschedules",
                        "microsoft.authorization/roleeligibilityscheduleinstances",
                        "microsoft.authorization/roleassignmentschedules",
                        "microsoft.authorization/roleassignmentscheduleinstances"
                      ]
                    }
                  },
                  "description": "This initiative will help enforce and govern subscriptions that are placed within the decommissioned Management Group as part of your Subscription decommissioning process. See https://aka.ms/alz/policies for more information.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:32.6684168Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "This resource must be compliant with the assigned policy."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-ALZ-Decomm",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:32.1629986Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:32.1629986Z"
                }
              }
            },
            "RoleAssignments": {
              "/providers/microsoft.management/managementgroups/decommissioned/providers/microsoft.authorization/roleassignments/44aafea8-f2e5-48da-ae5c-afbe99d710d0": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/decommissioned/providers/microsoft.authorization/roleassignments/44aafea8-f2e5-48da-ae5c-afbe99d710d0",
                  "Scope": "/providers/Microsoft.Management/managementGroups/decommissioned",
                  "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                  "SignInName": null,
                  "RoleDefinitionName": "Owner",
                  "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/decommissioned/providers/microsoft.authorization/roleassignments/78689988-a02c-5b62-ba50-93f9af8776a9": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/decommissioned/providers/microsoft.authorization/roleassignments/78689988-a02c-5b62-ba50-93f9af8776a9",
                  "Scope": "/providers/Microsoft.Management/managementGroups/decommissioned",
                  "DisplayName": "Enforce-ALZ-Decomm",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "bfc54ace-219e-4516-8c28-de1e2daaaa34",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ]
            },
            "DiagnosticSettings": {},
            "Subscriptions": {},
            "ManagementGroups": {}
          },
          "landingzones": {
            "MgId": "landingzones",
            "MgName": "Landing Zones",
            "mgParentId": "alz",
            "mgParentName": "Azure Landing Zones",
            "level": "2",
            "PolicyDefinitionsCustom": {},
            "PolicySetDefinitionsCustom": {},
            "BlueprintDefinitions": {},
            "PolicyAssignments": {
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Web Application Firewall (WAF) should be enabled for Application Gateway",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "Audit"
                    }
                  },
                  "description": "Assign the WAF should be enabled for Application Gateway audit policy.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.4100574Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Web Application Firewall (WAF) must be enabled for Application Gateway."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Audit-AppGW-WAF",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.3845013Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.3845013Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Network interfaces should disable IP forwarding",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:30.0231288Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Network interfaces must disable IP forwarding."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deny-IP-forwarding",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:29.9471342Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:29.9471342Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Management port access from the Internet should be blocked",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This policy denies any network security rule that allows management port access from the Internet",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:46.3018721Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Management port access from the Internet must be blocked."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deny-MgmtPorts-Internet",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:46.2230308Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:46.2230308Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Kubernetes clusters should not allow container privilege escalation",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "Deny"
                    }
                  },
                  "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:43.9556181Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default"
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deny-Priv-Esc-AKS",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:43.9015252Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:43.9015252Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Kubernetes cluster should not allow privileged containers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "deny"
                    }
                  },
                  "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.1841688Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default"
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deny-Privileged-AKS",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:32.8171756Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:32.8171756Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Secure transfer to storage accounts should be enabled",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "Deny"
                    }
                  },
                  "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:52.2433179Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Secure transfer to storage accounts must be enabled."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deny-Storage-http",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:52.2014298Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:52.2014298Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Subnets should have a Network Security Group",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:52.8605316Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Subnets must have a Network Security Group."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deny-Subnet-Without-Nsg",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:52.8223991Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:52.8223991Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing": {
                "identity": {
                  "principalId": "32ba4a2b-8a18-4bae-81f4-04f5323b950d",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Configure SQL servers to have auditing enabled to Log Analytics workspace",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "logAnalyticsWorkspaceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
                    }
                  },
                  "description": "To ensure the operations performed against your SQL assets are captured, SQL servers should have auditing enabled. If auditing is not enabled, this policy will configure auditing events to flow to the specified Log Analytics workspace.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:34.738973Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "SQL servers must have auditing enabled to Log Analytics workspace."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-AzSqlDb-Auditing",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:34.2228943Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:34.2228943Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-GuestAttest": {
                "identity": {
                  "principalId": "29bd59a9-c37e-4b19-b27d-e06f92316ec7",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Configure prerequisites to enable Guest Attestation on Trusted Launch enabled VMs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/281d9e47-d14d-4f05-b8eb-18f2c4a034ff",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "attestationEndpoint": {
                      "value": ""
                    }
                  },
                  "description": "Configure the Trusted Launch enabled virtual machines to automatically install the Guest Attestation extension and enable system-assigned managed identity to allow Azure Security Center to proactively attest and monitor the boot integrity. Boot integrity is attested via Remote Attestation. For more details, please refer to the following link - https://aka.ms/trustedlaunch.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:38.6450488Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Trusted Launch Guest Attestation must be configured on applicable virtual machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-GuestAttest",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-GuestAttest",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:37.7446658Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:37.7446658Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA": {
                "identity": {
                  "principalId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnDcr": {
                      "value": true
                    },
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-defendersql-prod"
                    },
                    "enableCollectionOfSqlQueriesForSecurityResearch": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    },
                    "userWorkspaceResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
                    },
                    "workspaceRegion": {
                      "value": "northeurope"
                    }
                  },
                  "description": "Microsoft Defender for SQL collects events from the agents and uses them to provide security alerts and tailored hardening tasks (recommendations).",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:34.5449446Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Microsoft Defender for SQL must be deployed."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-MDFC-DefSQL-AMA",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.9511722Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.9511722Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE": {
                "identity": {
                  "principalId": "98dfc5db-225d-4e5a-8be1-73e46a35d234",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Deploy TDE on SQL servers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This policy ensures that Transparent Data Encryption is enabled on SQL Servers.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:29.5370325Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "TDE must be deployed on SQL servers."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-SQL-TDE",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:28.9828967Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:28.9828967Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat": {
                "identity": {
                  "principalId": "7684f271-108c-49b0-a260-37a7956a4511",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Deploy Threat Detection on SQL servers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This policy ensures that Threat Detection is enabled on SQL Servers.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:50.0442826Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Threat Detection must be deployed on SQL servers."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-SQL-Threat",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:49.505509Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:49.505509Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup": {
                "identity": {
                  "principalId": "713ad35c-4373-4967-9e37-31ebbfdc9fa2",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:48.9561445Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Backup on virtual machines without a given tag must be configured to a new recovery services vault with a default policy."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VM-Backup",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:48.1701222Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:48.1701222Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack": {
                "identity": {
                  "principalId": "055fc92a-a5b1-47ec-9424-714049e87032",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable ChangeTracking and Inventory for virtual machines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/92a36f05-ebc9-4bba-9128-b47ad2ea3354",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-changetracking-prod"
                    },
                    "effect": {
                      "value": "DeployIfNotExists"
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable ChangeTracking and Inventory for virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:48.9094797Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Change Tracking must be enabled for Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VM-ChangeTrack",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:48.2074278Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:48.2074278Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring": {
                "identity": {
                  "principalId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Azure Monitor for VMs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/924bfe3a-762f-40e7-86dd-5c8b95eb09e6",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights"
                    },
                    "enableProcessesAndDependencies": {
                      "value": true
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "scopeToSupportedImages": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:38.5740195Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Azure Monitor must be enabled for Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VM-Monitoring",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:37.7286087Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:37.7286087Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack": {
                "identity": {
                  "principalId": "f846a8ca-f281-4e0e-a93a-4fefbfa022c2",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/53448c70-089b-4f52-8f38-89196d7f2de1",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-changetracking-prod"
                    },
                    "effect": {
                      "value": "DeployIfNotExists"
                    }
                  },
                  "description": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:30.9920969Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Change Tracking must be enabled for Arc-enabled Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-vmArc-ChangeTrack",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:30.4311073Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:30.4311073Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmHybr-Monitoring": {
                "identity": {
                  "principalId": "d24e793f-c3f8-495a-8573-cc7d4eb413e3",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Azure Monitor for Hybrid Virtual Machines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/2b00397d-c309-49c4-aa5a-f0b2c5bc6321",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights"
                    },
                    "enableProcessesAndDependencies": {
                      "value": true
                    }
                  },
                  "description": "Enable Azure Monitor for Hybrid Virtual Machines in the specified scope (Management group, Subscription or resource group).",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:28.4949613Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Azure Monitor must be enabled for Hybrid Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmHybr-Monitoring",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-vmHybr-Monitoring",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:27.7288125Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:27.7288125Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack": {
                "identity": {
                  "principalId": "f0bfbe2c-1f01-4aff-a4d9-c8664f38b691",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable ChangeTracking and Inventory for virtual machine scale sets",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/c4a70814-96be-461c-889f-2b27429120dc",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-changetracking-prod"
                    },
                    "effect": {
                      "value": "DeployIfNotExists"
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable ChangeTracking and Inventory for virtual machine scale sets. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:32.1528699Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Change Tracking must be enabled for Virtual Machines Scales Sets."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VMSS-ChangeTrack",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:31.3527289Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:31.3527289Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring": {
                "identity": {
                  "principalId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Azure Monitor for Virtual Machine Scale Sets",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/f5bf694c-cca7-4033-b883-3a23327d5485",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights"
                    },
                    "enableProcessesAndDependencies": {
                      "value": true
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "scopeToSupportedImages": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:47.3245286Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Azure Monitor must be enabled for Virtual Machines Scales Sets."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VMSS-Monitoring",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:46.5799179Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:46.5799179Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates": {
                "identity": {
                  "principalId": "b9bed05d-d241-463a-8b6b-35f6e0a56b7f",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines.",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "assessmentMode": {
                      "value": "AutomaticByPlatform"
                    },
                    "locations": {
                      "value": []
                    },
                    "tagOperator": {
                      "value": "Any"
                    },
                    "tagValues": {
                      "value": {}
                    }
                  },
                  "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:46.9766434Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Periodic checking of missing updates must be enabled."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enable-AUM-CheckUpdates",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:46.1030742Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:46.1030742Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET": {
                "identity": {
                  "principalId": "f2ae3276-9433-4996-ad1f-2c43ed2be76a",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Virtual networks should be protected by Azure DDoS Network Protection",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "ddosPlan": {
                      "value": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-ddos/providers/Microsoft.Network/ddosProtectionPlans/alz-ddos-eastus2"
                    },
                    "effect": {
                      "value": "Modify"
                    }
                  },
                  "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Network Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:52.5091866Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "This resource must be compliant with the assigned policy."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enable-DDoS-VNET",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:51.8619917Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:51.8619917Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Kubernetes clusters should be accessible only over HTTPS",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "deny"
                    }
                  },
                  "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:50.8687381Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default"
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-AKS-HTTPS",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:50.8391616Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:50.8391616Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-ASR": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Enforce enhanced recovery and backup policies",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables recommended ALZ guardrails for Azure Recovery Services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:27.9363503Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails must be enforced for Azure Recovery Services (Backup and Site Recovery)."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-ASR",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-ASR",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:27.6759202Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:27.6759202Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-Encrypt-CMK0": {
                "identity": {
                  "principalId": "c209b4a6-8ebd-4b71-a2d4-e325cfca5c53",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Customer Managed Keys",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK_20250218",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Customer Managed Keys.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:29.560135Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Customer Managed Keys."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-Encrypt-CMK0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-Encrypt-CMK0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:28.9314467Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:28.9314467Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-APIM0": {
                "identity": {
                  "principalId": "806b0801-558a-41d9-83bd-f8d0b83c6149",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for API Management",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-APIM",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for API Management.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:30.6843283Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for API Management."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-APIM0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-APIM0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:30.0923335Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:30.0923335Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-AppServices0": {
                "identity": {
                  "principalId": "a7787ead-50d0-4207-a061-ffc63777afd8",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for App Services",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-AppServices",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for App Services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.7801913Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for App Services."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-AppServices0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-AppServices0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.0368977Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.0368977Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Automation0": {
                "identity": {
                  "principalId": "8c632410-4cca-470f-b79f-fad550737228",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Automation Accounts",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Automation",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Automation Accounts.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:49.7728694Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Automation Accounts."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Automation0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Automation0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:49.3218692Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:49.3218692Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-BotService0": {
                "identity": {
                  "principalId": "ee71c1ec-c98e-4913-a26a-1f0ee014e1b1",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Bot Service",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-BotService",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Bot Service.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:38:02.74077Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Bot Service."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-BotService0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-BotService0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:38:02.5308182Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:38:02.5308182Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CogServ0": {
                "identity": {
                  "principalId": "86ecafdc-d1b2-4c80-960d-450370b50cc1",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Cognitive Services",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CognitiveServices",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Cognitive Services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:30.4336545Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Cognitive Services."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CogServ0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-CogServ0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:29.9099572Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:29.9099572Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Compute0": {
                "identity": {
                  "principalId": "747b5838-77e6-4c71-bcc3-6a34aaa046b0",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Compute",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Compute",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Compute.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:48.06732Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Compute."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Compute0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Compute0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:47.6125604Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:47.6125604Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContApps0": {
                "identity": {
                  "principalId": "8d8fd773-c121-4be0-a709-76177cfb6540",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Container Apps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerApps",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Container Apps.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:51.1443144Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Container Apps."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContApps0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ContApps0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:50.5718295Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:50.5718295Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContInst0": {
                "identity": {
                  "principalId": "d35778f7-af04-4a2e-8705-9beed4b30a2e",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Container Instance",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerInstance",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Container Instance.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:47.7954381Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Container Instance."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContInst0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ContInst0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:47.3025598Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:47.3025598Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContReg0": {
                "identity": {
                  "principalId": "4cd07de3-708f-484d-8a8b-311f2359add8",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Container Registry",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerRegistry",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Container Registry.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:53.7253568Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Container Registry."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContReg0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ContReg0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:53.1661012Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:53.1661012Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CosmosDb0": {
                "identity": {
                  "principalId": "ff39fdcb-ddbd-4956-aadb-74c21959c173",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Cosmos DB",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CosmosDb",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Cosmos DB.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:35.2519123Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Cosmos DB."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CosmosDb0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-CosmosDb0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:34.6816896Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:34.6816896Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataExpl0": {
                "identity": {
                  "principalId": "4e4d651f-3bfa-45a0-afc3-6e8078b93d96",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Data Explorer",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataExplorer",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Data Explorer.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:47.6698321Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Data Explorer."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataExpl0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-DataExpl0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:47.0924632Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:47.0924632Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataFactory0": {
                "identity": {
                  "principalId": "8f537356-061d-4c66-a7da-e68800ccb320",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Data Factory",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataFactory",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Data Factory.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:38.0934923Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Data Factory."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataFactory0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-DataFactory0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:37.5666434Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:37.5666434Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventGrid0": {
                "identity": {
                  "principalId": "b39055a7-c519-4346-b960-b1fb68d9a540",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Event Grid",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventGrid",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Event Grid.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:29.6789755Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Event Grid."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventGrid0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-EventGrid0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:29.0837674Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:29.0837674Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventHub0": {
                "identity": {
                  "principalId": "39725792-272d-44a1-b66a-c87a5e3d7a73",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Event Hub",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventHub",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Event Hub.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:53.8694944Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Event Hub."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventHub0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-EventHub0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:53.4120427Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:53.4120427Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Azure Key Vault",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables recommended ALZ guardrails for Azure Key Vault.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:46.3444627Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "This resource must be compliant with the assigned policy."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-KeyVault",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:46.2275845Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:46.2275845Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVaultSup0": {
                "identity": {
                  "principalId": "d4353230-7404-41bb-9cb7-885bdaa6c8e9",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Key Vault Supplementary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault-Sup",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Key Vault Supplementary.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:41.6655085Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Key Vault Supplementary."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVaultSup0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-KeyVaultSup0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:41.1315765Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:41.1315765Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Kubernetes0": {
                "identity": {
                  "principalId": "d0be1068-7999-45ea-9763-bfd944195dc4",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Kubernetes",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Kubernetes",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Kubernetes.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:35.9308784Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Kubernetes."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Kubernetes0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Kubernetes0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:35.2787238Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:35.2787238Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MachLearn0": {
                "identity": {
                  "principalId": "0196c880-73d7-4a31-b27c-5b6d5d3d8b33",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Machine Learning",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MachineLearning",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Machine Learning.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:49.9979157Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Machine Learning."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MachLearn0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-MachLearn0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:49.4329459Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:49.4329459Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MySQL0": {
                "identity": {
                  "principalId": "2a9558d6-8571-463a-8f52-83a0f00245b9",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for MySQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MySQL",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for MySQL.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:50.9333778Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for MySQL."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MySQL0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-MySQL0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:50.4393676Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:50.4393676Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Network0": {
                "identity": {
                  "principalId": "19abb909-4243-4175-8bad-379140883249",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Network and Networking services",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network_20250326",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "ddosPlanResourceId": {
                      "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/ddosProtectionPlans/placeholder"
                    }
                  },
                  "description": "This initiative assignment enables additional ALZ guardrails for Network and Networking services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:48.7726772Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Network and Networking services."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Network0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Network0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:48.1712399Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:48.1712399Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-OpenAI0": {
                "identity": {
                  "principalId": "1e5cbafe-7f0d-4697-a29b-19d3c03e487f",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for OpenAI",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-OpenAI",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for OpenAI.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:30.6448559Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for OpenAI."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-OpenAI0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-OpenAI0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:29.9597646Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:29.9597646Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-PostgreSQL0": {
                "identity": {
                  "principalId": "a4d196af-6014-4deb-997c-91b943a94fea",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for PostgreSQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-PostgreSQL",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for PostgreSQL.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:46.904365Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for PostgreSQL."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-PostgreSQL0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-PostgreSQL0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:46.4513099Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:46.4513099Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ServiceBus0": {
                "identity": {
                  "principalId": "7f5ed711-5393-4763-8164-6071a8b825c9",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Service Bus",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ServiceBus",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Service Bus.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:32.4389886Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Service Bus."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ServiceBus0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ServiceBus0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:31.7704417Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:31.7704417Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-SQL0": {
                "identity": {
                  "principalId": "b294b13b-7150-469b-8cd5-03d09546d627",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for SQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-SQL",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for SQL.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:52.1017755Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for SQL."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-SQL0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-SQL0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:51.4631661Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:51.4631661Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Storage0": {
                "identity": {
                  "principalId": "56a68665-1799-46a6-ba44-77a7d7067f4c",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Storage",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Storage",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Storage.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:47.8025401Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Storage."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Storage0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Storage0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:47.2901069Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:47.2901069Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Synapse0": {
                "identity": {
                  "principalId": "08b9812f-09ba-4b4a-b4d6-11c9f9c65735",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Synapse",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Synapse",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Synapse.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:28.3559181Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Synapse."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Synapse0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Synapse0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:27.6986277Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:27.6986277Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-VirtualDesk0": {
                "identity": {
                  "principalId": "5f6e43ee-88a5-494a-a956-af40a270b28f",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Virtual Desktop",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-VirtualDesktop",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Virtual Desktop.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:35.1548717Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Virtual Desktop."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-VirtualDesk0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-VirtualDesk0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:34.4765077Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:34.4765077Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-Subnet-Private": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Subnets should be private",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7bca8353-aa3b-429b-904a-9229c4385837",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "Audit"
                    }
                  },
                  "description": "Ensure your subnets are secure by default by preventing default outbound access. For more information go to https://aka.ms/defaultoutboundaccessretirement",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:57.7787851Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Subnets should be private."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-Subnet-Private",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-Subnet-Private",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:57.6442671Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:57.6442671Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-Q225": {
                "identity": {
                  "principalId": "0cdd1d82-bc7c-4baf-9e30-7de416a166b8",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20241211",
                  "scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "notScopes": [],
                  "parameters": {},
                  "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:35.0156686Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "TLS and SSL must be enabled for on resources without encryption in transit."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/landingzones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-Q225",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-TLS-SSL-Q225",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:34.4029655Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:34.4029655Z"
                }
              }
            },
            "RoleAssignments": {
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/0030fa92-9971-50e4-9ff3-3706ebdfc448": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/0030fa92-9971-50e4-9ff3-3706ebdfc448",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-TLS-SSL-Q225",
                  "SignInName": null,
                  "RoleDefinitionName": "Website Contributor",
                  "RoleDefinitionId": "de139f84-1756-47ae-9be6-808fbbe84772",
                  "ObjectId": "0cdd1d82-bc7c-4baf-9e30-7de416a166b8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/028f67b9-c0f6-5d5b-882e-10a162a0085e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/028f67b9-c0f6-5d5b-882e-10a162a0085e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-SQL-Threat",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Security Manager",
                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "ObjectId": "7684f271-108c-49b0-a260-37a7956a4511",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/052dfc27-793e-4833-b8c5-9d815e5e1678": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/052dfc27-793e-4833-b8c5-9d815e5e1678",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                  "SignInName": null,
                  "RoleDefinitionName": "Owner",
                  "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/07cb7fdf-8f2b-5894-b382-d303ad34d459": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/07cb7fdf-8f2b-5894-b382-d303ad34d459",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-CosmosDb0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "ff39fdcb-ddbd-4956-aadb-74c21959c173",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/07fd6a89-a821-54b5-a2f1-e7728e54d3be": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/07fd6a89-a821-54b5-a2f1-e7728e54d3be",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-VirtualDesk0",
                  "SignInName": null,
                  "RoleDefinitionName": "Desktop Virtualization Host Pool Contributor",
                  "RoleDefinitionId": "e307426c-f9b6-4e81-87de-d99efb3c32bc",
                  "ObjectId": "5f6e43ee-88a5-494a-a956-af40a270b28f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/13da4df2-1597-5c20-ac3a-48312d156277": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/13da4df2-1597-5c20-ac3a-48312d156277",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/15e29143-1af8-5fbc-a66f-69c8b6624395": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/15e29143-1af8-5fbc-a66f-69c8b6624395",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-SQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Security Manager",
                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "ObjectId": "b294b13b-7150-469b-8cd5-03d09546d627",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1661ba6a-ba86-5122-9228-516d442632e7": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1661ba6a-ba86-5122-9228-516d442632e7",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/18db325e-b242-525f-af1e-3d29b5c2dd85": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/18db325e-b242-525f-af1e-3d29b5c2dd85",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-AppServices0",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "a7787ead-50d0-4207-a061-ffc63777afd8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1b99b8f6-4ca9-5d15-be5d-9e0e704b2682": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1b99b8f6-4ca9-5d15-be5d-9e0e704b2682",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "1e5cbafe-7f0d-4697-a29b-19d3c03e487f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1e2bc49f-7c8b-5abd-9e7f-cd780642543d": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1e2bc49f-7c8b-5abd-9e7f-cd780642543d",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-TLS-SSL-Q225",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Managed Instance Contributor",
                  "RoleDefinitionId": "4939a1f6-9ae0-4e48-a1e0-f2cbe897382d",
                  "ObjectId": "0cdd1d82-bc7c-4baf-9e30-7de416a166b8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1e2e5544-e794-56fc-9822-d76858fac987": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/1e2e5544-e794-56fc-9822-d76858fac987",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Network0",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "19abb909-4243-4175-8bad-379140883249",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/221a1724-36bc-5386-86ce-e355be8e2bfe": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/221a1724-36bc-5386-86ce-e355be8e2bfe",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Reader",
                  "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                  "ObjectId": "29bd59a9-c37e-4b19-b27d-e06f92316ec7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/221c559b-6051-5420-aef4-6a0cd34cc603": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/221c559b-6051-5420-aef4-6a0cd34cc603",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-AzSqlDb-Auditing",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "32ba4a2b-8a18-4bae-81f4-04f5323b950d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/2623849b-ebe1-5aac-a818-0985502ad441": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/2623849b-ebe1-5aac-a818-0985502ad441",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/26d0d42e-f893-577f-a6c6-389bda781241": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/26d0d42e-f893-577f-a6c6-389bda781241",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-vmArc-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "f846a8ca-f281-4e0e-a93a-4fefbfa022c2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/2939a2c0-9fca-5de3-8b24-b3d5021aafa1": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/2939a2c0-9fca-5de3-8b24-b3d5021aafa1",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-CogServ0",
                  "SignInName": null,
                  "RoleDefinitionName": "Search Service Contributor",
                  "RoleDefinitionId": "7ca78c08-252a-4471-8644-bb5ff32d4ba0",
                  "ObjectId": "86ecafdc-d1b2-4c80-960d-450370b50cc1",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/3358a1a2-d1ef-51f7-beb9-999fdeba3130": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/3358a1a2-d1ef-51f7-beb9-999fdeba3130",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enable-AUM-CheckUpdates",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "b9bed05d-d241-463a-8b6b-35f6e0a56b7f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/367f2736-9ef3-575b-9bbc-f0e05b1cb52e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/367f2736-9ef3-575b-9bbc-f0e05b1cb52e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/3ac8dad5-9e02-58f2-a97b-d4f7a084a05e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/3ac8dad5-9e02-58f2-a97b-d4f7a084a05e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Synapse0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Security Manager",
                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "ObjectId": "08b9812f-09ba-4b4a-b4d6-11c9f9c65735",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/3c834d8d-fcff-5348-9c7f-daf9c330cf11": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/3c834d8d-fcff-5348-9c7f-daf9c330cf11",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Kubernetes0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Kubernetes Service Policy Add-on Deployment",
                  "RoleDefinitionId": "18ed5180-3e48-46fd-8541-4ea054d57064",
                  "ObjectId": "d0be1068-7999-45ea-9763-bfd944195dc4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/46d584c5-5f63-5139-b076-552f929f5a4a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/46d584c5-5f63-5139-b076-552f929f5a4a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed Identity Operator",
                  "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                  "ObjectId": "29bd59a9-c37e-4b19-b27d-e06f92316ec7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/49b439b3-07ec-5469-902b-2f99b8c894e0": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/49b439b3-07ec-5469-902b-2f99b8c894e0",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Storage0",
                  "SignInName": null,
                  "RoleDefinitionName": "Storage Account Contributor",
                  "RoleDefinitionId": "17d1049b-9a84-46fb-8f53-869881c3d3ab",
                  "ObjectId": "56a68665-1799-46a6-ba44-77a7d7067f4c",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/4eb5e902-cf89-5342-9592-d66dfcfaee49": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/4eb5e902-cf89-5342-9592-d66dfcfaee49",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/583bb7af-c5b4-501c-b345-1312d7429ac4": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/583bb7af-c5b4-501c-b345-1312d7429ac4",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-DataExpl0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Server Contributor",
                  "RoleDefinitionId": "6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437",
                  "ObjectId": "4e4d651f-3bfa-45a0-afc3-6e8078b93d96",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/58e70f77-7bed-514d-92cc-1e0ce0fbf50d": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/58e70f77-7bed-514d-92cc-1e0ce0fbf50d",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-DataFactory0",
                  "SignInName": null,
                  "RoleDefinitionName": "Data Factory Contributor",
                  "RoleDefinitionId": "673868aa-7521-48a0-acc6-0f60742d39f5",
                  "ObjectId": "8f537356-061d-4c66-a7da-e68800ccb320",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/5a2de5c4-1621-5c72-8469-ed455903e097": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/5a2de5c4-1621-5c72-8469-ed455903e097",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-SQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Server Contributor",
                  "RoleDefinitionId": "6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437",
                  "ObjectId": "b294b13b-7150-469b-8cd5-03d09546d627",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/5f8be5f8-61fc-5946-938e-55025ce8fa76": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/5f8be5f8-61fc-5946-938e-55025ce8fa76",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Backup",
                  "SignInName": null,
                  "RoleDefinitionName": "Backup Contributor",
                  "RoleDefinitionId": "5e467623-bb1f-42f4-a55d-6e525e11384b",
                  "ObjectId": "713ad35c-4373-4967-9e37-31ebbfdc9fa2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/5f997d26-8fc4-5c37-a7dc-20ac39b021c7": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/5f997d26-8fc4-5c37-a7dc-20ac39b021c7",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6036c8a4-6d6a-5af1-b679-291b062cbfdf": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6036c8a4-6d6a-5af1-b679-291b062cbfdf",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "f0bfbe2c-1f01-4aff-a4d9-c8664f38b691",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6cb5e73d-970c-51c1-848b-4026ee5e1e46": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6cb5e73d-970c-51c1-848b-4026ee5e1e46",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "f0bfbe2c-1f01-4aff-a4d9-c8664f38b691",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6d0bebc7-0a96-579b-bf79-dfc8c3628811": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6d0bebc7-0a96-579b-bf79-dfc8c3628811",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-TLS-SSL-Q225",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "0cdd1d82-bc7c-4baf-9e30-7de416a166b8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6df96add-89e6-5f9f-953b-3ef07bc9e3e6": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/6df96add-89e6-5f9f-953b-3ef07bc9e3e6",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/72cb5da4-84eb-57df-95d3-d553e55b2e33": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/72cb5da4-84eb-57df-95d3-d553e55b2e33",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "055fc92a-a5b1-47ec-9424-714049e87032",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/74c01450-817f-587d-8290-8368caa1000b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/74c01450-817f-587d-8290-8368caa1000b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-CogServ0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "86ecafdc-d1b2-4c80-960d-450370b50cc1",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/74ef3f40-c573-5017-b992-1054015c4191": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/74ef3f40-c573-5017-b992-1054015c4191",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/792fd885-7903-5d8b-b5e9-3953c3752384": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/792fd885-7903-5d8b-b5e9-3953c3752384",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "055fc92a-a5b1-47ec-9424-714049e87032",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/7ffa5814-5fb9-5ae5-a5a4-6b12c9ac9ffe": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/7ffa5814-5fb9-5ae5-a5a4-6b12c9ac9ffe",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-CogServ0",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "86ecafdc-d1b2-4c80-960d-450370b50cc1",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8580ee77-e4d6-5b26-bd52-2ef4d21bd9ad": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8580ee77-e4d6-5b26-bd52-2ef4d21bd9ad",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-EventHub0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Event Hubs Data Owner",
                  "RoleDefinitionId": "f526a384-b230-433a-b45c-95f59c4a2dec",
                  "ObjectId": "39725792-272d-44a1-b66a-c87a5e3d7a73",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/85eaee1f-e02e-5968-91b2-461eb6b1a5ee": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/85eaee1f-e02e-5968-91b2-461eb6b1a5ee",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-EventGrid0",
                  "SignInName": null,
                  "RoleDefinitionName": "EventGrid Contributor",
                  "RoleDefinitionId": "1e241071-0855-49ea-94dc-649edcd759de",
                  "ObjectId": "b39055a7-c519-4346-b960-b1fb68d9a540",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/86ef130f-29d3-57da-b74d-942f0abaca7f": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/86ef130f-29d3-57da-b74d-942f0abaca7f",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Kubernetes0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                  "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                  "ObjectId": "d0be1068-7999-45ea-9763-bfd944195dc4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8901f16e-37f9-59d1-862c-de2cecba983b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8901f16e-37f9-59d1-862c-de2cecba983b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "29bd59a9-c37e-4b19-b27d-e06f92316ec7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8a0c8cbe-26f1-5dcd-b0f7-941aff7a72b5": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8a0c8cbe-26f1-5dcd-b0f7-941aff7a72b5",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "f0bfbe2c-1f01-4aff-a4d9-c8664f38b691",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8b03acfb-f4b0-533e-8719-e36a747cd5d5": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8b03acfb-f4b0-533e-8719-e36a747cd5d5",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8d220925-45ce-5b0d-bc56-1c0248597c15": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8d220925-45ce-5b0d-bc56-1c0248597c15",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8d7f7d9c-ec37-5fa1-869d-0b02e2fecd8e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8d7f7d9c-ec37-5fa1-869d-0b02e2fecd8e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-vmHybr-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "d24e793f-c3f8-495a-8573-cc7d4eb413e3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8f62ded1-4e01-5104-b9ff-f729b7f66dfa": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/8f62ded1-4e01-5104-b9ff-f729b7f66dfa",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Storage0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "56a68665-1799-46a6-ba44-77a7d7067f4c",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/958f9c17-2250-598d-95f2-178c9afad410": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/958f9c17-2250-598d-95f2-178c9afad410",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-vmArc-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "f846a8ca-f281-4e0e-a93a-4fefbfa022c2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/96d47f8d-3bf0-58bd-a9cf-2e7fa014c12e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/96d47f8d-3bf0-58bd-a9cf-2e7fa014c12e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "055fc92a-a5b1-47ec-9424-714049e87032",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/96e2b90d-a27b-52fb-844e-ee63eb2b24f0": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/96e2b90d-a27b-52fb-844e-ee63eb2b24f0",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-MachLearn0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "0196c880-73d7-4a31-b27c-5b6d5d3d8b33",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/97062944-ecca-50d5-9a04-2b7bd6b101e8": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/97062944-ecca-50d5-9a04-2b7bd6b101e8",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-SQL-TDE",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL DB Contributor",
                  "RoleDefinitionId": "9b7fa17d-e63e-47b0-bb0a-15c516ac86ec",
                  "ObjectId": "98dfc5db-225d-4e5a-8be1-73e46a35d234",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/98c9d475-ff1a-5e39-a3d5-2fc123460a1e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/98c9d475-ff1a-5e39-a3d5-2fc123460a1e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-TLS-SSL-Q225",
                  "SignInName": null,
                  "RoleDefinitionName": "Storage Account Contributor",
                  "RoleDefinitionId": "17d1049b-9a84-46fb-8f53-869881c3d3ab",
                  "ObjectId": "0cdd1d82-bc7c-4baf-9e30-7de416a166b8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/997aa2f6-e929-5188-926d-b867fd27b996": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/997aa2f6-e929-5188-926d-b867fd27b996",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-SQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "Storage Account Contributor",
                  "RoleDefinitionId": "17d1049b-9a84-46fb-8f53-869881c3d3ab",
                  "ObjectId": "b294b13b-7150-469b-8cd5-03d09546d627",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9acf0963-01f0-58c1-996f-19699e2f3120": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9acf0963-01f0-58c1-996f-19699e2f3120",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enable-AUM-CheckUpdates",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "b9bed05d-d241-463a-8b6b-35f6e0a56b7f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9b4ac624-8d14-5054-a532-9b53124f6997": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9b4ac624-8d14-5054-a532-9b53124f6997",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-AppServices0",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed Identity Operator",
                  "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                  "ObjectId": "a7787ead-50d0-4207-a061-ffc63777afd8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9c777edc-0685-5862-b963-a0053fdf6b3f": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9c777edc-0685-5862-b963-a0053fdf6b3f",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9ee380bc-fecd-574d-bd64-5687c6a709e9": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/9ee380bc-fecd-574d-bd64-5687c6a709e9",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Cognitive Services OpenAI Contributor",
                  "RoleDefinitionId": "a001fd3d-188f-4b5d-821b-7da978bf7442",
                  "ObjectId": "1e5cbafe-7f0d-4697-a29b-19d3c03e487f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a0959163-2675-56bd-ae0f-1c5f4d3f200c": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a0959163-2675-56bd-ae0f-1c5f4d3f200c",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a20648bf-d257-511e-ab8c-62a3b3940543": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a20648bf-d257-511e-ab8c-62a3b3940543",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Search Service Contributor",
                  "RoleDefinitionId": "7ca78c08-252a-4471-8644-bb5ff32d4ba0",
                  "ObjectId": "1e5cbafe-7f0d-4697-a29b-19d3c03e487f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a224c8c5-0346-5928-a003-014fc50e207f": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a224c8c5-0346-5928-a003-014fc50e207f",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-CosmosDb0",
                  "SignInName": null,
                  "RoleDefinitionName": "Security Admin",
                  "RoleDefinitionId": "fb1c8493-542b-48eb-b624-b4c8fea62acd",
                  "ObjectId": "ff39fdcb-ddbd-4956-aadb-74c21959c173",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a3f5e898-02ba-52a5-bbed-8d730c89dee4": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a3f5e898-02ba-52a5-bbed-8d730c89dee4",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a4b1d01a-3f4a-5f66-a180-79c8799b81c9": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a4b1d01a-3f4a-5f66-a180-79c8799b81c9",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-ServiceBus0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Service Bus Data Owner",
                  "RoleDefinitionId": "090c5cfd-751d-490a-894a-3ce6f1109419",
                  "ObjectId": "7f5ed711-5393-4763-8164-6071a8b825c9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a5866b09-3ff7-5324-9b0a-f8ab99fd30f7": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a5866b09-3ff7-5324-9b0a-f8ab99fd30f7",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Backup",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "713ad35c-4373-4967-9e37-31ebbfdc9fa2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a596edc3-d0f5-52a0-8b47-74fb8c649fa5": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/a596edc3-d0f5-52a0-8b47-74fb8c649fa5",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-MySQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "2a9558d6-8571-463a-8f52-83a0f00245b9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/aa4e567a-26c0-5fab-87a7-c5ec43045f8d": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/aa4e567a-26c0-5fab-87a7-c5ec43045f8d",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Storage0",
                  "SignInName": null,
                  "RoleDefinitionName": "Security Admin",
                  "RoleDefinitionId": "fb1c8493-542b-48eb-b624-b4c8fea62acd",
                  "ObjectId": "56a68665-1799-46a6-ba44-77a7d7067f4c",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/abfc103e-7982-5b5d-a961-b84668580e07": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/abfc103e-7982-5b5d-a961-b84668580e07",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-vmHybr-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "d24e793f-c3f8-495a-8573-cc7d4eb413e3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b2384531-4c24-59e4-abc7-fde89177344f": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b2384531-4c24-59e4-abc7-fde89177344f",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-vmArc-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "f846a8ca-f281-4e0e-a93a-4fefbfa022c2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b58a6898-ea49-5e71-ac0a-4343e36884ba": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b58a6898-ea49-5e71-ac0a-4343e36884ba",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-PostgreSQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "a4d196af-6014-4deb-997c-91b943a94fea",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b8b2edf5-fa89-51e2-9dca-3e42101e096c": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b8b2edf5-fa89-51e2-9dca-3e42101e096c",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-AppServices0",
                  "SignInName": null,
                  "RoleDefinitionName": "Website Contributor",
                  "RoleDefinitionId": "de139f84-1756-47ae-9be6-808fbbe84772",
                  "ObjectId": "a7787ead-50d0-4207-a061-ffc63777afd8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b96b4869-841a-5600-8d14-5548a0daef12": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b96b4869-841a-5600-8d14-5548a0daef12",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enable-DDoS-VNET",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "f2ae3276-9433-4996-ad1f-2c43ed2be76a",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b9df137c-500a-52f0-a9af-8d550f0c5368": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/b9df137c-500a-52f0-a9af-8d550f0c5368",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "055fc92a-a5b1-47ec-9424-714049e87032",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/bb95ed85-5f41-5faa-be29-a78ba115af30": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/bb95ed85-5f41-5faa-be29-a78ba115af30",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "055fc92a-a5b1-47ec-9424-714049e87032",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/bf26f7d4-8268-5513-9da8-0087127c4849": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/bf26f7d4-8268-5513-9da8-0087127c4849",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-CosmosDb0",
                  "SignInName": null,
                  "RoleDefinitionName": "DocumentDB Account Contributor",
                  "RoleDefinitionId": "5bd9cd88-fe45-4216-938b-f97437e15450",
                  "ObjectId": "ff39fdcb-ddbd-4956-aadb-74c21959c173",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c147cb4c-b5b7-558c-8dbe-69cee9c3cfa1": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c147cb4c-b5b7-558c-8dbe-69cee9c3cfa1",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-KeyVaultSup0",
                  "SignInName": null,
                  "RoleDefinitionName": "Key Vault Contributor",
                  "RoleDefinitionId": "f25e0fa2-a7c8-4377-a976-54943a77a395",
                  "ObjectId": "d4353230-7404-41bb-9cb7-885bdaa6c8e9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c80dc5fe-cfb8-5382-9882-de4fc05759e8": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c80dc5fe-cfb8-5382-9882-de4fc05759e8",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-ContReg0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "4cd07de3-708f-484d-8a8b-311f2359add8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c89cabdc-7d20-5e77-a1f4-13bbf3cf68c5": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c89cabdc-7d20-5e77-a1f4-13bbf3cf68c5",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c91803a0-1b97-55e8-8116-03e851eff15a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/c91803a0-1b97-55e8-8116-03e851eff15a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "f0bfbe2c-1f01-4aff-a4d9-c8664f38b691",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/cac32cb9-e07c-5b4d-8ef4-4c03eb8d1dc3": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/cac32cb9-e07c-5b4d-8ef4-4c03eb8d1dc3",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-KeyVaultSup0",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed HSM contributor",
                  "RoleDefinitionId": "18500a29-7fe2-46b2-a342-b16a415e101d",
                  "ObjectId": "d4353230-7404-41bb-9cb7-885bdaa6c8e9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/cbc7cf2b-d9b0-5f38-b479-f55a81ab4cf6": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/cbc7cf2b-d9b0-5f38-b479-f55a81ab4cf6",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-APIM0",
                  "SignInName": null,
                  "RoleDefinitionName": "API Management Service Contributor",
                  "RoleDefinitionId": "312a565d-c81f-4fd8-895a-4e21e48d571c",
                  "ObjectId": "806b0801-558a-41d9-83bd-f8d0b83c6149",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/d06b0732-81f6-5984-a15e-0028b9751c12": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/d06b0732-81f6-5984-a15e-0028b9751c12",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Cognitive Services Contributor",
                  "RoleDefinitionId": "25fbc0a9-bd7c-42a3-aa1a-3b75d497ee68",
                  "ObjectId": "1e5cbafe-7f0d-4697-a29b-19d3c03e487f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/d1d44c3d-b9dd-574c-856f-b92ead29c37b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/d1d44c3d-b9dd-574c-856f-b92ead29c37b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed Identity Contributor",
                  "RoleDefinitionId": "e40ec5ca-96e0-45a2-b4ff-59039f2c2b59",
                  "ObjectId": "29bd59a9-c37e-4b19-b27d-e06f92316ec7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/d94cb67f-3bef-59d2-8df3-79fc90666d5e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/d94cb67f-3bef-59d2-8df3-79fc90666d5e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-AzSqlDb-Auditing",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Security Manager",
                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "ObjectId": "32ba4a2b-8a18-4bae-81f4-04f5323b950d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/e5de577f-fd12-53e7-a595-bea06321cf3b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/e5de577f-fd12-53e7-a595-bea06321cf3b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-TLS-SSL-Q225",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Server Contributor",
                  "RoleDefinitionId": "6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437",
                  "ObjectId": "0cdd1d82-bc7c-4baf-9e30-7de416a166b8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/e8ac2e11-178f-55e1-bd3a-4062de1277fb": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/e8ac2e11-178f-55e1-bd3a-4062de1277fb",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "fed1d197-aa72-419e-833a-3167acfbf9bb",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/e97bf68d-082c-51b1-b724-332d5578f15c": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/e97bf68d-082c-51b1-b724-332d5578f15c",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-vmHybr-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "d24e793f-c3f8-495a-8573-cc7d4eb413e3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/eb5d0321-27e1-5d99-b537-6b2b8c531e75": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/eb5d0321-27e1-5d99-b537-6b2b8c531e75",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "f0bfbe2c-1f01-4aff-a4d9-c8664f38b691",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/f3259fef-429c-52ae-a77f-d66bb51bee6d": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/f3259fef-429c-52ae-a77f-d66bb51bee6d",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Synapse0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "08b9812f-09ba-4b4a-b4d6-11c9f9c65735",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/f54bde39-4186-5db1-b1f3-aa4fb3a97e43": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/f54bde39-4186-5db1-b1f3-aa4fb3a97e43",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-VirtualDesk0",
                  "SignInName": null,
                  "RoleDefinitionName": "Desktop Virtualization Workspace Contributor",
                  "RoleDefinitionId": "21efdde3-836f-432b-bf3d-3e8e734d4b2b",
                  "ObjectId": "5f6e43ee-88a5-494a-a956-af40a270b28f",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/f884c814-c476-570b-9a22-9b5ea812aa84": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/landingzones/providers/microsoft.authorization/roleassignments/f884c814-c476-570b-9a22-9b5ea812aa84",
                  "Scope": "/providers/Microsoft.Management/managementGroups/landingzones",
                  "DisplayName": "Enforce-GR-Automation0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "8c632410-4cca-470f-b79f-fad550737228",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ]
            },
            "DiagnosticSettings": {},
            "Subscriptions": {},
            "ManagementGroups": {
              "corp": {
                "MgId": "corp",
                "MgName": "Corp",
                "mgParentId": "landingzones",
                "mgParentName": "Landing Zones",
                "level": "3",
                "PolicyDefinitionsCustom": {},
                "PolicySetDefinitionsCustom": {},
                "BlueprintDefinitions": {},
                "PolicyAssignments": {
                  "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Audit-PeDnsZones": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Audit Private Link Private DNS Zone resources",
                      "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones",
                      "scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "notScopes": [],
                      "parameters": {
                        "effect": {
                          "value": "Audit"
                        },
                        "privateLinkDnsZones": {
                          "value": [
                            "privatelink.adf.azure.com",
                            "privatelink.afs.azure.net",
                            "privatelink.agentsvc.azure-automation.net",
                            "privatelink.analysis.windows.net",
                            "privatelink.api.azureml.ms",
                            "privatelink.azconfig.io",
                            "privatelink.azure-api.net",
                            "privatelink.azure-automation.net",
                            "privatelink.azurecr.io",
                            "privatelink.azure-devices.net",
                            "privatelink.azure-devices-provisioning.net",
                            "privatelink.azuredatabricks.net",
                            "privatelink.azurehdinsight.net",
                            "privatelink.azurehealthcareapis.com",
                            "privatelink.azurestaticapps.net",
                            "privatelink.azuresynapse.net",
                            "privatelink.azurewebsites.net",
                            "privatelink.batch.azure.com",
                            "privatelink.blob.core.windows.net",
                            "privatelink.cassandra.cosmos.azure.com",
                            "privatelink.cognitiveservices.azure.com",
                            "privatelink.database.windows.net",
                            "privatelink.datafactory.azure.net",
                            "privatelink.dev.azuresynapse.net",
                            "privatelink.dfs.core.windows.net",
                            "privatelink.dicom.azurehealthcareapis.com",
                            "privatelink.digitaltwins.azure.net",
                            "privatelink.directline.botframework.com",
                            "privatelink.documents.azure.com",
                            "privatelink.eventgrid.azure.net",
                            "privatelink.file.core.windows.net",
                            "privatelink.gremlin.cosmos.azure.com",
                            "privatelink.guestconfiguration.azure.com",
                            "privatelink.his.arc.azure.com",
                            "privatelink.kubernetesconfiguration.azure.com",
                            "privatelink.managedhsm.azure.net",
                            "privatelink.mariadb.database.azure.com",
                            "privatelink.media.azure.net",
                            "privatelink.mongo.cosmos.azure.com",
                            "privatelink.monitor.azure.com",
                            "privatelink.mysql.database.azure.com",
                            "privatelink.notebooks.azure.net",
                            "privatelink.ods.opinsights.azure.com",
                            "privatelink.oms.opinsights.azure.com",
                            "privatelink.pbidedicated.windows.net",
                            "privatelink.postgres.database.azure.com",
                            "privatelink.prod.migration.windowsazure.com",
                            "privatelink.purview.azure.com",
                            "privatelink.purviewstudio.azure.com",
                            "privatelink.queue.core.windows.net",
                            "privatelink.redis.cache.windows.net",
                            "privatelink.redisenterprise.cache.azure.net",
                            "privatelink.search.windows.net",
                            "privatelink.service.signalr.net",
                            "privatelink.servicebus.windows.net",
                            "privatelink.siterecovery.windowsazure.com",
                            "privatelink.sql.azuresynapse.net",
                            "privatelink.table.core.windows.net",
                            "privatelink.table.cosmos.azure.com",
                            "privatelink.tip1.powerquery.microsoft.com",
                            "privatelink.token.botframework.com",
                            "privatelink.vaultcore.azure.net",
                            "privatelink.web.core.windows.net",
                            "privatelink.webpubsub.azure.com"
                          ]
                        }
                      },
                      "description": "Audits the deployment of Private Link Private DNS Zone resources in the Corp landing zone.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:29.3232931Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Private Link Private DNS Zone resources must be deployed in the Corp landing zone."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Audit-PeDnsZones",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Audit-PeDnsZones",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:29.2722373Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:29.2722373Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deny-HybridNetworking": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Deny the deployment of vWAN/ER/VPN gateway resources",
                      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                      "scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "notScopes": [],
                      "parameters": {
                        "effect": {
                          "value": "Deny"
                        },
                        "listOfResourceTypesNotAllowed": {
                          "value": [
                            "microsoft.network/expressroutecircuits",
                            "microsoft.network/expressroutegateways",
                            "microsoft.network/expressrouteports",
                            "microsoft.network/virtualwans",
                            "microsoft.network/virtualhubs",
                            "microsoft.network/vpngateways",
                            "microsoft.network/p2svpngateways",
                            "microsoft.network/vpnsites",
                            "microsoft.network/virtualnetworkgateways"
                          ]
                        }
                      },
                      "description": "Denies deployment of vWAN/ER/VPN gateway resources in the Corp landing zone.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:32.0923388Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "vWAN/ER/VPN gateway resources must not be deployed in the Corp landing zone."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deny-HybridNetworking",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deny-HybridNetworking",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:32.0364811Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:32.0364811Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-Endpoints": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Public network access should be disabled for PaaS services",
                      "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
                      "scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "notScopes": [],
                      "parameters": {},
                      "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:50.6443184Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Public network access must be disabled for PaaS services."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-Endpoints",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deny-Public-Endpoints",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:50.374401Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:50.374401Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP-On-NIC": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Deny network interfaces having a public IP associated",
                      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
                      "scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "notScopes": [],
                      "parameters": {},
                      "description": "This policy denies network interfaces from having a public IP associated to it under the assigned scope.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:30.860004Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Network interfaces must not have a public IP associated."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP-On-NIC",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deny-Public-IP-On-NIC",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:30.8337813Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:30.8337813Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones": {
                    "identity": {
                      "principalId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                      "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                      "type": "SystemAssigned"
                    },
                    "properties": {
                      "displayName": "Configure Azure PaaS services to use private DNS zones",
                      "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
                      "scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "notScopes": [],
                      "parameters": {
                        "azureAcrPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io"
                        },
                        "azureAppPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io"
                        },
                        "azureAppServicesPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net"
                        },
                        "azureArcGuestconfigurationPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com"
                        },
                        "azureArcHybridResourceProviderPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com"
                        },
                        "azureArcKubernetesConfigurationPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.dp.kubernetesconfiguration.azure.com"
                        },
                        "azureAsrPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com"
                        },
                        "azureAutomationDSCHybridPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net"
                        },
                        "azureAutomationWebhookPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net"
                        },
                        "azureBatchPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com"
                        },
                        "azureBotServicePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com"
                        },
                        "azureCognitiveSearchPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net"
                        },
                        "azureCognitiveServicesPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com"
                        },
                        "azureCosmosCassandraPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com"
                        },
                        "azureCosmosGremlinPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com"
                        },
                        "azureCosmosMongoPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com"
                        },
                        "azureCosmosSQLPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com"
                        },
                        "azureCosmosTablePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com"
                        },
                        "azureDataFactoryPortalPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com"
                        },
                        "azureDataFactoryPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net"
                        },
                        "azureDatabricksPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azuredatabricks.net"
                        },
                        "azureDiskAccessPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                        },
                        "azureEventGridDomainsPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net"
                        },
                        "azureEventGridTopicsPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net"
                        },
                        "azureEventHubNamespacePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net"
                        },
                        "azureFilePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net"
                        },
                        "azureHDInsightPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net"
                        },
                        "azureIotCentralPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azureiotcentral.com"
                        },
                        "azureIotDeviceupdatePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net"
                        },
                        "azureIotHubsPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net"
                        },
                        "azureIotPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net"
                        },
                        "azureKeyVaultPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net"
                        },
                        "azureMachineLearningWorkspacePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms"
                        },
                        "azureMachineLearningWorkspaceSecondPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net"
                        },
                        "azureManagedGrafanaWorkspacePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.grafana.azure.com"
                        },
                        "azureMediaServicesKeyPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net"
                        },
                        "azureMediaServicesLivePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net"
                        },
                        "azureMediaServicesStreamPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net"
                        },
                        "azureMigratePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com"
                        },
                        "azureMonitorPrivateDnsZoneId1": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com"
                        },
                        "azureMonitorPrivateDnsZoneId2": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com"
                        },
                        "azureMonitorPrivateDnsZoneId3": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com"
                        },
                        "azureMonitorPrivateDnsZoneId4": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net"
                        },
                        "azureMonitorPrivateDnsZoneId5": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                        },
                        "azureRedisCachePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net"
                        },
                        "azureServiceBusNamespacePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net"
                        },
                        "azureSignalRPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net"
                        },
                        "azureSiteRecoveryBackupPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.ne.backup.windowsazure.com"
                        },
                        "azureSiteRecoveryBlobPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                        },
                        "azureSiteRecoveryQueuePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net"
                        },
                        "azureStorageBlobPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                        },
                        "azureStorageBlobSecPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                        },
                        "azureStorageDFSPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net"
                        },
                        "azureStorageDFSSecPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net"
                        },
                        "azureStorageFilePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net"
                        },
                        "azureStorageQueuePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net"
                        },
                        "azureStorageQueueSecPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net"
                        },
                        "azureStorageStaticWebPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net"
                        },
                        "azureStorageStaticWebSecPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net"
                        },
                        "azureStorageTablePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net"
                        },
                        "azureStorageTableSecondaryPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net"
                        },
                        "azureSynapseDevPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net"
                        },
                        "azureSynapseSQLODPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net"
                        },
                        "azureSynapseSQLPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net"
                        },
                        "azureVirtualDesktopHostpoolPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.wvd.microsoft.com"
                        },
                        "azureVirtualDesktopWorkspacePrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.wvd.microsoft.com"
                        },
                        "azureWebPrivateDnsZoneId": {
                          "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/privateDnsZones//providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com"
                        },
                        "dnsZoneRegion": {
                          "value": "eastus2"
                        },
                        "dnsZoneResourceGroupName": {
                          "value": "alz-dns"
                        },
                        "dnsZoneSubscriptionId": {
                          "value": "399a72e1-30af-4a84-92ac-af885a677310"
                        }
                      },
                      "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:30.4611256Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Azure PaaS services must use private DNS zones."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deploy-Private-DNS-Zones",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:29.7228083Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:29.7228083Z"
                    }
                  }
                },
                "RoleAssignments": {
                  "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/4f8d1930-48b0-44f1-bc1d-0fb0c361ddfc": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/4f8d1930-48b0-44f1-bc1d-0fb0c361ddfc",
                      "Scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                      "SignInName": null,
                      "RoleDefinitionName": "Owner",
                      "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                      "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/640f024f-9e49-5528-ab48-ae9934d5c9c3": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/640f024f-9e49-5528-ab48-ae9934d5c9c3",
                      "Scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "DisplayName": "Deploy-Private-DNS-Zones",
                      "SignInName": null,
                      "RoleDefinitionName": "Network Contributor",
                      "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                      "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/6f02dba4-713e-5f3c-a53e-f41adee61bc4": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/6f02dba4-713e-5f3c-a53e-f41adee61bc4",
                      "Scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "DisplayName": "Deploy-Private-DNS-Zones",
                      "SignInName": null,
                      "RoleDefinitionName": "Private DNS Zone Contributor",
                      "RoleDefinitionId": "b12aa53e-6015-4669-85d0-8515ebb3ae7f",
                      "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/82e6afe3-42cd-5bf1-9f39-bdc10d1a4255": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/corp/providers/microsoft.authorization/roleassignments/82e6afe3-42cd-5bf1-9f39-bdc10d1a4255",
                      "Scope": "/providers/Microsoft.Management/managementGroups/corp",
                      "DisplayName": "Deploy-Private-DNS-Zones",
                      "SignInName": null,
                      "RoleDefinitionName": "Contributor",
                      "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                },
                "DiagnosticSettings": {},
                "Subscriptions": {},
                "ManagementGroups": {}
              },
              "online": {
                "MgId": "online",
                "MgName": "Online",
                "mgParentId": "landingzones",
                "mgParentName": "Landing Zones",
                "level": "3",
                "PolicyDefinitionsCustom": {},
                "PolicySetDefinitionsCustom": {},
                "BlueprintDefinitions": {},
                "PolicyAssignments": {},
                "RoleAssignments": {
                  "/providers/microsoft.management/managementgroups/online/providers/microsoft.authorization/roleassignments/a3ae4daa-a41c-48b2-b8b9-45035a88f55a": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/online/providers/microsoft.authorization/roleassignments/a3ae4daa-a41c-48b2-b8b9-45035a88f55a",
                      "Scope": "/providers/Microsoft.Management/managementGroups/online",
                      "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                      "SignInName": null,
                      "RoleDefinitionName": "Owner",
                      "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                      "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                },
                "DiagnosticSettings": {},
                "Subscriptions": {},
                "ManagementGroups": {}
              }
            }
          },
          "platform": {
            "MgId": "platform",
            "MgName": "Platform",
            "mgParentId": "alz",
            "mgParentName": "Azure Landing Zones",
            "level": "2",
            "PolicyDefinitionsCustom": {},
            "PolicySetDefinitionsCustom": {},
            "BlueprintDefinitions": {},
            "PolicyAssignments": {
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/DenyAction-DeleteUAMIAMA": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Do not allow deletion of the User Assigned Managed Identity used by AMA",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "DenyAction"
                    },
                    "resourceName": {
                      "value": "alz-uami"
                    },
                    "resourceType": {
                      "value": "Microsoft.ManagedIdentity/userAssignedIdentities"
                    }
                  },
                  "description": "This policy provides a safeguard against accidental removal of the User Assigned Managed Identity used by AMA by blocking delete calls using deny action effect.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:31.8924991Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "This resource must be compliant with the assigned policy."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/DenyAction-DeleteUAMIAMA",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "DenyAction-DeleteUAMIAMA",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:31.7385037Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:31.7385037Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-GuestAttest": {
                "identity": {
                  "principalId": "535fe3b7-ad0c-46b2-a4b5-bca05f052cce",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Configure prerequisites to enable Guest Attestation on Trusted Launch enabled VMs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/281d9e47-d14d-4f05-b8eb-18f2c4a034ff",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "attestationEndpoint": {
                      "value": ""
                    }
                  },
                  "description": "Configure the Trusted Launch enabled virtual machines to automatically install the Guest Attestation extension and enable system-assigned managed identity to allow Azure Security Center to proactively attest and monitor the boot integrity. Boot integrity is attested via Remote Attestation. For more details, please refer to the following link - https://aka.ms/trustedlaunch.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:36.118588Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Trusted Launch Guest Attestation must be configured on applicable virtual machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-GuestAttest",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-GuestAttest",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.8066636Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.8066636Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA": {
                "identity": {
                  "principalId": "c2fa7a41-1841-4efc-b241-092ecd0187ce",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnDcr": {
                      "value": true
                    },
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-defendersql-prod"
                    },
                    "enableCollectionOfSqlQueriesForSecurityResearch": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    },
                    "userWorkspaceResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law"
                    },
                    "workspaceRegion": {
                      "value": "northeurope"
                    }
                  },
                  "description": "Microsoft Defender for SQL collects events from the agents and uses them to provide security alerts and tailored hardening tasks (recommendations).",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:30.7600431Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Microsoft Defender for SQL must be deployed."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-MDFC-DefSQL-AMA",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:30.1434857Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:30.1434857Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack": {
                "identity": {
                  "principalId": "8e09f885-e656-4949-bf97-82eb3c4e43a3",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable ChangeTracking and Inventory for virtual machines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/92a36f05-ebc9-4bba-9128-b47ad2ea3354",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-changetracking-prod"
                    },
                    "effect": {
                      "value": "DeployIfNotExists"
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable ChangeTracking and Inventory for virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:49.0693623Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Change Tracking must be enabled for Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VM-ChangeTrack",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:48.2205887Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:48.2205887Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring": {
                "identity": {
                  "principalId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Azure Monitor for VMs",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/924bfe3a-762f-40e7-86dd-5c8b95eb09e6",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights"
                    },
                    "enableProcessesAndDependencies": {
                      "value": true
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "scopeToSupportedImages": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.0612846Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Azure Monitor must be enabled for Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VM-Monitoring",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:32.4404932Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:32.4404932Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack": {
                "identity": {
                  "principalId": "38bb27da-6794-4749-9eac-82a79cfc8567",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/53448c70-089b-4f52-8f38-89196d7f2de1",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-changetracking-prod"
                    },
                    "effect": {
                      "value": "DeployIfNotExists"
                    }
                  },
                  "description": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:52.0022897Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Change Tracking must be enabled for Arc-enabled Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-vmArc-ChangeTrack",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:51.4704676Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:51.4704676Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmHybr-Monitoring": {
                "identity": {
                  "principalId": "7d21f057-956c-43e8-9076-507ca45fb4d8",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Azure Monitor for Hybrid Virtual Machines",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/2b00397d-c309-49c4-aa5a-f0b2c5bc6321",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights"
                    },
                    "enableProcessesAndDependencies": {
                      "value": true
                    }
                  },
                  "description": "Enable Azure Monitor for Hybrid Virtual Machines in the specified scope (Management group, Subscription or resource group).",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:39.6801552Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Azure Monitor must be enabled for Hybrid Virtual Machines."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmHybr-Monitoring",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-vmHybr-Monitoring",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:38.4704886Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:38.4704886Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack": {
                "identity": {
                  "principalId": "ad8d007e-7a4d-4f51-b117-8031fc5c10ae",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable ChangeTracking and Inventory for virtual machine scale sets",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/c4a70814-96be-461c-889f-2b27429120dc",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-changetracking-prod"
                    },
                    "effect": {
                      "value": "DeployIfNotExists"
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable ChangeTracking and Inventory for virtual machine scale sets. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.1548519Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Change Tracking must be enabled for Virtual Machines Scales Sets."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VMSS-ChangeTrack",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:32.4721764Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:32.4721764Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring": {
                "identity": {
                  "principalId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enable Azure Monitor for Virtual Machine Scale Sets",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/f5bf694c-cca7-4033-b883-3a23327d5485",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "bringYourOwnUserAssignedManagedIdentity": {
                      "value": true
                    },
                    "dcrResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights"
                    },
                    "enableProcessesAndDependencies": {
                      "value": true
                    },
                    "restrictBringYourOwnUserAssignedIdentityToSubscription": {
                      "value": false
                    },
                    "scopeToSupportedImages": {
                      "value": false
                    },
                    "userAssignedIdentityResourceId": {
                      "value": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/alz-uami"
                    }
                  },
                  "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:46.060047Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Azure Monitor must be enabled for Virtual Machines Scales Sets."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Deploy-VMSS-Monitoring",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:45.1125265Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:45.1125265Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates": {
                "identity": {
                  "principalId": "1261171c-968b-4051-a4f3-ffe35bee94b2",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines.",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "assessmentMode": {
                      "value": "AutomaticByPlatform"
                    },
                    "locations": {
                      "value": []
                    },
                    "tagOperator": {
                      "value": "Any"
                    },
                    "tagValues": {
                      "value": {}
                    }
                  },
                  "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:49.9495889Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Periodic checking of missing updates must be enabled."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enable-AUM-CheckUpdates",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:49.1765418Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:49.1765418Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-ASR": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Enforce enhanced recovery and backup policies",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables recommended ALZ guardrails for Azure Recovery Services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:50.3588792Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails must be enforced for Azure Recovery Services (Backup and Site Recovery)."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-ASR",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-ASR",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:50.3223473Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:50.3223473Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-Encrypt-CMK0": {
                "identity": {
                  "principalId": "c33f767b-8da1-46e1-a1f0-8b38e81da539",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Customer Managed Keys",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK_20250218",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Customer Managed Keys.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:53.8329023Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Customer Managed Keys."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-Encrypt-CMK0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-Encrypt-CMK0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:53.2534592Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:53.2534592Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-APIM0": {
                "identity": {
                  "principalId": "74b3f5b3-2917-4e99-a549-df49f32b9c4d",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for API Management",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-APIM",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for API Management.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:52.8835615Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for API Management."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-APIM0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-APIM0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:52.3651467Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:52.3651467Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-AppServices0": {
                "identity": {
                  "principalId": "08a55b11-45d7-469d-b91c-c939d3807428",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for App Services",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-AppServices",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for App Services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:49.8609012Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for App Services."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-AppServices0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-AppServices0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:49.3768201Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:49.3768201Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Automation0": {
                "identity": {
                  "principalId": "7810322a-2229-41cf-9947-d207168d98e4",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Automation Accounts",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Automation",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Automation Accounts.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:28.3051151Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Automation Accounts."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Automation0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Automation0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:27.7338576Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:27.7338576Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-BotService0": {
                "identity": {
                  "principalId": "ecef5a5f-cd54-4a4e-a559-5195c2a317ec",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Bot Service",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-BotService",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Bot Service.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:34.3852627Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Bot Service."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-BotService0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-BotService0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.8523882Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.8523882Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CogServ0": {
                "identity": {
                  "principalId": "e61d8f94-6754-42ca-92e1-174e079e37e9",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Cognitive Services",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CognitiveServices",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Cognitive Services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:53.0987483Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Cognitive Services."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CogServ0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-CogServ0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:52.5532152Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:52.5532152Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Compute0": {
                "identity": {
                  "principalId": "a3b3dbb3-babf-429e-a11f-20c489fa2088",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Compute",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Compute",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Compute.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:32.0388969Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Compute."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Compute0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Compute0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:31.0682198Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:31.0682198Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContApps0": {
                "identity": {
                  "principalId": "8672d474-7381-4409-a60f-491051ab1c42",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Container Apps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerApps",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Container Apps.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:35.701404Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Container Apps."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContApps0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ContApps0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:35.175973Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:35.175973Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContInst0": {
                "identity": {
                  "principalId": "85bd4e38-d942-4392-8f5d-cdb770318a4a",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Container Instance",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerInstance",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Container Instance.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:40.7114724Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Container Instance."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContInst0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ContInst0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:40.0447788Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:40.0447788Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContReg0": {
                "identity": {
                  "principalId": "fa342b08-e7aa-4a9a-8623-1f61b7ddd124",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Container Registry",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerRegistry",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Container Registry.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:45.8123468Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Container Registry."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ContReg0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ContReg0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:45.0980698Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:45.0980698Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CosmosDb0": {
                "identity": {
                  "principalId": "e1389625-4532-4d0a-8016-019defcbe532",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Cosmos DB",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CosmosDb",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Cosmos DB.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:34.7014304Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Cosmos DB."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-CosmosDb0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-CosmosDb0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.9734883Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.9734883Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataExpl0": {
                "identity": {
                  "principalId": "722aad44-e907-4035-b66e-671385dfee62",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Data Explorer",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataExplorer",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Data Explorer.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:31.7975098Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Data Explorer."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataExpl0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-DataExpl0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:31.2909643Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:31.2909643Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataFactory0": {
                "identity": {
                  "principalId": "ac1f47ef-5b18-4c23-b653-2c1640c02af5",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Data Factory",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataFactory",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Data Factory.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:53.1799959Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Data Factory."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-DataFactory0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-DataFactory0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:52.472144Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:52.472144Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventGrid0": {
                "identity": {
                  "principalId": "b0f11a1b-0623-4603-b4d3-d97ba3a4b962",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Event Grid",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventGrid",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Event Grid.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:31.5819221Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Event Grid."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventGrid0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-EventGrid0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:30.9754373Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:30.9754373Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventHub0": {
                "identity": {
                  "principalId": "08eb96a8-0902-4fc2-b7c1-ae765d8c7156",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Event Hub",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventHub",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Event Hub.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:38.4722625Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Event Hub."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-EventHub0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-EventHub0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:37.7509565Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:37.7509565Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Azure Key Vault",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables recommended ALZ guardrails for Azure Key Vault.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:51.61024Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "This resource must be compliant with the assigned policy."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-KeyVault",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:51.5182482Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:51.5182482Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVaultSup0": {
                "identity": {
                  "principalId": "1a330176-d36e-4459-8708-37618d47506b",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Key Vault Supplementary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault-Sup",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Key Vault Supplementary.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.9577739Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Key Vault Supplementary."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVaultSup0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-KeyVaultSup0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.425381Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.425381Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Kubernetes0": {
                "identity": {
                  "principalId": "4874bce3-231a-4e4c-90ef-d2e56e15caa5",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Kubernetes",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Kubernetes",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Kubernetes.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:29.776084Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Kubernetes."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Kubernetes0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Kubernetes0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:28.9721267Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:28.9721267Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MachLearn0": {
                "identity": {
                  "principalId": "4c8a0c04-4c06-4d48-90f8-788132533379",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Machine Learning",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MachineLearning",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Machine Learning.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:28.4042783Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Machine Learning."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MachLearn0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-MachLearn0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:27.6859452Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:27.6859452Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MySQL0": {
                "identity": {
                  "principalId": "d4638c96-f1c0-40b8-88dc-e41e89b57533",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for MySQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MySQL",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for MySQL.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:50.9240574Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for MySQL."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-MySQL0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-MySQL0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:50.3151785Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:50.3151785Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Network0": {
                "identity": {
                  "principalId": "911eaf80-ba3e-4490-91c8-982956fbce6d",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Network and Networking services",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network_20250326",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "ddosPlanResourceId": {
                      "value": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/placeholder/providers/Microsoft.Network/ddosProtectionPlans/placeholder"
                    }
                  },
                  "description": "This initiative assignment enables additional ALZ guardrails for Network and Networking services.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:47.3054217Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Network and Networking services."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Network0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Network0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:46.6906439Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:46.6906439Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-OpenAI0": {
                "identity": {
                  "principalId": "2a5d6356-24eb-4462-842f-1a42600150b7",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for OpenAI",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-OpenAI",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for OpenAI.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:36.0807249Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for OpenAI."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-OpenAI0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-OpenAI0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:35.3322784Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:35.3322784Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-PostgreSQL0": {
                "identity": {
                  "principalId": "65dbcc4a-fbe1-4eaf-9d13-67cfc78a8bcc",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for PostgreSQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-PostgreSQL",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for PostgreSQL.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:43.3669482Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for PostgreSQL."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-PostgreSQL0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-PostgreSQL0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:42.8629393Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:42.8629393Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ServiceBus0": {
                "identity": {
                  "principalId": "202f8148-2104-41a3-8544-91a2e296ed54",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Service Bus",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ServiceBus",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Service Bus.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:33.6965714Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Service Bus."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-ServiceBus0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-ServiceBus0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:33.2061278Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:33.2061278Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-SQL0": {
                "identity": {
                  "principalId": "6e1bdbb4-3154-4247-9e46-07665a96027a",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for SQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-SQL",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for SQL.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:48.960647Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for SQL."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-SQL0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-SQL0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:48.3589055Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:48.3589055Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Storage0": {
                "identity": {
                  "principalId": "25bd8629-ac72-46ef-b258-1979c3f3867d",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Storage",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Storage",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Storage.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:49.9278085Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Storage."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Storage0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Storage0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:49.3236214Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:49.3236214Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Synapse0": {
                "identity": {
                  "principalId": "57b9fc03-4191-4360-b209-b1addfc85b2e",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Synapse",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Synapse",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Synapse.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:38.3207168Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Synapse."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-Synapse0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-Synapse0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:37.6910583Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:37.6910583Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-VirtualDesk0": {
                "identity": {
                  "principalId": "4ed2bce2-6b8f-4621-89e9-afa50d16c46a",
                  "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                  "type": "SystemAssigned"
                },
                "properties": {
                  "displayName": "Enforce recommended guardrails for Virtual Desktop",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-VirtualDesktop",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {},
                  "description": "This initiative assignment enables additional ALZ guardrails for Virtual Desktop.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:31.4378885Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Recommended guardrails should be enforced for Virtual Desktop."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-VirtualDesk0",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-GR-VirtualDesk0",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:30.9518444Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:30.9518444Z"
                }
              },
              "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-Subnet-Private": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Subnets should be private",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7bca8353-aa3b-429b-904a-9229c4385837",
                  "scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "notScopes": [],
                  "parameters": {
                    "effect": {
                      "value": "Audit"
                    }
                  },
                  "description": "Ensure your subnets are secure by default by preventing default outbound access. For more information go to https://aka.ms/defaultoutboundaccessretirement",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:38.8721624Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "DoNotEnforce",
                  "nonComplianceMessages": [
                    {
                      "message": "Subnets should be private."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/platform/providers/Microsoft.Authorization/policyAssignments/Enforce-Subnet-Private",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-Subnet-Private",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:38.8107009Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:38.8107009Z"
                }
              }
            },
            "RoleAssignments": {
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/0c4ec8f3-bfc4-5c01-b350-d3aee2e7d0c1": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/0c4ec8f3-bfc4-5c01-b350-d3aee2e7d0c1",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-AppServices0",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "08a55b11-45d7-469d-b91c-c939d3807428",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/0ec2393b-bb9c-562d-b063-b7c13f6b7236": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/0ec2393b-bb9c-562d-b063-b7c13f6b7236",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed Identity Operator",
                  "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                  "ObjectId": "535fe3b7-ad0c-46b2-a4b5-bca05f052cce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/14fd742a-e9aa-5554-a0ff-f1bbaa7a5464": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/14fd742a-e9aa-5554-a0ff-f1bbaa7a5464",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Network0",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "911eaf80-ba3e-4490-91c8-982956fbce6d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/18ea0ed8-494a-59ac-8586-573da3961160": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/18ea0ed8-494a-59ac-8586-573da3961160",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "ad8d007e-7a4d-4f51-b117-8031fc5c10ae",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/1d30f5b2-eb2f-555f-b91e-03259a00ae58": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/1d30f5b2-eb2f-555f-b91e-03259a00ae58",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-EventGrid0",
                  "SignInName": null,
                  "RoleDefinitionName": "EventGrid Contributor",
                  "RoleDefinitionId": "1e241071-0855-49ea-94dc-649edcd759de",
                  "ObjectId": "b0f11a1b-0623-4603-b4d3-d97ba3a4b962",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2206e795-6490-5732-a8c9-9a455eb751e8": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2206e795-6490-5732-a8c9-9a455eb751e8",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-SQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Security Manager",
                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "ObjectId": "6e1bdbb4-3154-4247-9e46-07665a96027a",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/248e807e-a090-5022-8822-dca0fbe5b1d1": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/248e807e-a090-5022-8822-dca0fbe5b1d1",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/264a3a3f-268b-5387-8788-4bc6eaaf620c": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/264a3a3f-268b-5387-8788-4bc6eaaf620c",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "c2fa7a41-1841-4efc-b241-092ecd0187ce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/27390b19-2f68-5f4e-9c47-79422352e9bd": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/27390b19-2f68-5f4e-9c47-79422352e9bd",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "8e09f885-e656-4949-bf97-82eb3c4e43a3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2a972d9a-82e4-5206-9134-e682d9f37c45": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2a972d9a-82e4-5206-9134-e682d9f37c45",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-SQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "Storage Account Contributor",
                  "RoleDefinitionId": "17d1049b-9a84-46fb-8f53-869881c3d3ab",
                  "ObjectId": "6e1bdbb4-3154-4247-9e46-07665a96027a",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2f301999-2dc1-53e5-a6b5-e791fea7498a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2f301999-2dc1-53e5-a6b5-e791fea7498a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Storage0",
                  "SignInName": null,
                  "RoleDefinitionName": "Security Admin",
                  "RoleDefinitionId": "fb1c8493-542b-48eb-b624-b4c8fea62acd",
                  "ObjectId": "25bd8629-ac72-46ef-b258-1979c3f3867d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2f307cc7-5eef-58bd-bb25-c90d83909382": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/2f307cc7-5eef-58bd-bb25-c90d83909382",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "ad8d007e-7a4d-4f51-b117-8031fc5c10ae",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/3344a026-0b3f-57c3-8dc0-d878125253a1": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/3344a026-0b3f-57c3-8dc0-d878125253a1",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-KeyVaultSup0",
                  "SignInName": null,
                  "RoleDefinitionName": "Key Vault Contributor",
                  "RoleDefinitionId": "f25e0fa2-a7c8-4377-a976-54943a77a395",
                  "ObjectId": "1a330176-d36e-4459-8708-37618d47506b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/3c932b1c-a651-5353-94f5-13797bfeb3df": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/3c932b1c-a651-5353-94f5-13797bfeb3df",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Cognitive Services Contributor",
                  "RoleDefinitionId": "25fbc0a9-bd7c-42a3-aa1a-3b75d497ee68",
                  "ObjectId": "2a5d6356-24eb-4462-842f-1a42600150b7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/416ab005-269e-57b7-815c-96313b668a8b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/416ab005-269e-57b7-815c-96313b668a8b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Kubernetes0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                  "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                  "ObjectId": "4874bce3-231a-4e4c-90ef-d2e56e15caa5",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4282caab-ec52-57f4-bf75-7e77398e6edc": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4282caab-ec52-57f4-bf75-7e77398e6edc",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4360e2b5-7c8f-5df9-b438-3676b66eca3e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4360e2b5-7c8f-5df9-b438-3676b66eca3e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-ContReg0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "fa342b08-e7aa-4a9a-8623-1f61b7ddd124",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4456aa56-e5fe-56be-abf8-81812d0eb5eb": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4456aa56-e5fe-56be-abf8-81812d0eb5eb",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Synapse0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Security Manager",
                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "ObjectId": "57b9fc03-4191-4360-b209-b1addfc85b2e",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/44983641-ae6f-5758-94c5-9d51353e4d22": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/44983641-ae6f-5758-94c5-9d51353e4d22",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4b98ee0a-4375-5e05-869e-26d5ca15a3fc": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/4b98ee0a-4375-5e05-869e-26d5ca15a3fc",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-DataExpl0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Server Contributor",
                  "RoleDefinitionId": "6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437",
                  "ObjectId": "722aad44-e907-4035-b66e-671385dfee62",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/5b6b55b2-5fee-53bf-9ab8-2f5a205307b6": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/5b6b55b2-5fee-53bf-9ab8-2f5a205307b6",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-CogServ0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "e61d8f94-6754-42ca-92e1-174e079e37e9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/5b9dfc99-5800-55cc-979f-d5d34fba705b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/5b9dfc99-5800-55cc-979f-d5d34fba705b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Storage0",
                  "SignInName": null,
                  "RoleDefinitionName": "Storage Account Contributor",
                  "RoleDefinitionId": "17d1049b-9a84-46fb-8f53-869881c3d3ab",
                  "ObjectId": "25bd8629-ac72-46ef-b258-1979c3f3867d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/5d99d002-53c6-587e-85cb-015f84463464": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/5d99d002-53c6-587e-85cb-015f84463464",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enable-AUM-CheckUpdates",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "1261171c-968b-4051-a4f3-ffe35bee94b2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/609f67fc-ad73-5b43-9e7d-af2800faa635": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/609f67fc-ad73-5b43-9e7d-af2800faa635",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-VirtualDesk0",
                  "SignInName": null,
                  "RoleDefinitionName": "Desktop Virtualization Workspace Contributor",
                  "RoleDefinitionId": "21efdde3-836f-432b-bf3d-3e8e734d4b2b",
                  "ObjectId": "4ed2bce2-6b8f-4621-89e9-afa50d16c46a",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/641743cb-dca2-5e38-be3e-d91c5e49d336": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/641743cb-dca2-5e38-be3e-d91c5e49d336",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-VirtualDesk0",
                  "SignInName": null,
                  "RoleDefinitionName": "Desktop Virtualization Host Pool Contributor",
                  "RoleDefinitionId": "e307426c-f9b6-4e81-87de-d99efb3c32bc",
                  "ObjectId": "4ed2bce2-6b8f-4621-89e9-afa50d16c46a",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/65264347-2f51-5ded-b3ac-aed6d1bf842a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/65264347-2f51-5ded-b3ac-aed6d1bf842a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Automation0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "7810322a-2229-41cf-9947-d207168d98e4",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/65ca1230-d73e-5978-843a-28a6a6d3cbe1": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/65ca1230-d73e-5978-843a-28a6a6d3cbe1",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-AppServices0",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed Identity Operator",
                  "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                  "ObjectId": "08a55b11-45d7-469d-b91c-c939d3807428",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/663cad6b-03fc-5556-b43a-1ef44d20351c": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/663cad6b-03fc-5556-b43a-1ef44d20351c",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "2a5d6356-24eb-4462-842f-1a42600150b7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/6bca0a5c-b408-58f3-8ea0-fe57d8c8c32e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/6bca0a5c-b408-58f3-8ea0-fe57d8c8c32e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-APIM0",
                  "SignInName": null,
                  "RoleDefinitionName": "API Management Service Contributor",
                  "RoleDefinitionId": "312a565d-c81f-4fd8-895a-4e21e48d571c",
                  "ObjectId": "74b3f5b3-2917-4e99-a549-df49f32b9c4d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/6c4064d6-47fa-5262-b8ee-7775be7ae5c7": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/6c4064d6-47fa-5262-b8ee-7775be7ae5c7",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Storage0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "25bd8629-ac72-46ef-b258-1979c3f3867d",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/6c9b4cd3-60df-586b-8a42-b874236169c3": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/6c9b4cd3-60df-586b-8a42-b874236169c3",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-vmHybr-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "7d21f057-956c-43e8-9076-507ca45fb4d8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/74d37a26-6521-593f-8dc7-d55770085dc5": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/74d37a26-6521-593f-8dc7-d55770085dc5",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-CosmosDb0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "e1389625-4532-4d0a-8016-019defcbe532",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/758f96f5-88c9-5684-9d6b-d9514d391624": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/758f96f5-88c9-5684-9d6b-d9514d391624",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "8e09f885-e656-4949-bf97-82eb3c4e43a3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/75c5a688-629a-5d5d-b1ba-9fbaae2b7594": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/75c5a688-629a-5d5d-b1ba-9fbaae2b7594",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-MachLearn0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "4c8a0c04-4c06-4d48-90f8-788132533379",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/776c9969-b6a0-5867-87de-01002e7fa79d": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/776c9969-b6a0-5867-87de-01002e7fa79d",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "ad8d007e-7a4d-4f51-b117-8031fc5c10ae",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/795ea75f-239e-5009-9b54-e3e93a734f11": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/795ea75f-239e-5009-9b54-e3e93a734f11",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "535fe3b7-ad0c-46b2-a4b5-bca05f052cce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/7dbc5710-ed1e-59bf-992e-d90847a68780": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/7dbc5710-ed1e-59bf-992e-d90847a68780",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Search Service Contributor",
                  "RoleDefinitionId": "7ca78c08-252a-4471-8644-bb5ff32d4ba0",
                  "ObjectId": "2a5d6356-24eb-4462-842f-1a42600150b7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/80b69860-1865-59e3-8d50-617d729147d7": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/80b69860-1865-59e3-8d50-617d729147d7",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "8e09f885-e656-4949-bf97-82eb3c4e43a3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/81f00951-105a-5a94-acb4-b6a42f0912ad": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/81f00951-105a-5a94-acb4-b6a42f0912ad",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-KeyVaultSup0",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed HSM contributor",
                  "RoleDefinitionId": "18500a29-7fe2-46b2-a342-b16a415e101d",
                  "ObjectId": "1a330176-d36e-4459-8708-37618d47506b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/825aa658-6a64-5557-b26c-5274faa3853c": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/825aa658-6a64-5557-b26c-5274faa3853c",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-CogServ0",
                  "SignInName": null,
                  "RoleDefinitionName": "Network Contributor",
                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "ObjectId": "e61d8f94-6754-42ca-92e1-174e079e37e9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/84c8e63f-6fc4-547d-b98b-213c23456f70": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/84c8e63f-6fc4-547d-b98b-213c23456f70",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/85b503d7-516c-5b33-bc01-a659253f5bdc": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/85b503d7-516c-5b33-bc01-a659253f5bdc",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Synapse0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "57b9fc03-4191-4360-b209-b1addfc85b2e",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/8a9832e1-851a-556f-aa53-fd6c11c861f9": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/8a9832e1-851a-556f-aa53-fd6c11c861f9",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/8b6d8209-f87b-5cfa-8876-b7c21b89b4e3": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/8b6d8209-f87b-5cfa-8876-b7c21b89b4e3",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-EventHub0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Event Hubs Data Owner",
                  "RoleDefinitionId": "f526a384-b230-433a-b45c-95f59c4a2dec",
                  "ObjectId": "08eb96a8-0902-4fc2-b7c1-ae765d8c7156",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/8e1fdb59-8d4e-5697-8de2-6c7b89a4628b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/8e1fdb59-8d4e-5697-8de2-6c7b89a4628b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "8e09f885-e656-4949-bf97-82eb3c4e43a3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/9073b376-45ba-5e07-986a-58338cbf60f8": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/9073b376-45ba-5e07-986a-58338cbf60f8",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-vmArc-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "38bb27da-6794-4749-9eac-82a79cfc8567",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/9d372f6d-4e49-5dd3-89b8-a6548d84ae5d": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/9d372f6d-4e49-5dd3-89b8-a6548d84ae5d",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-vmHybr-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "7d21f057-956c-43e8-9076-507ca45fb4d8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a146898d-22c5-595b-84c3-376bf13b8ed7": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a146898d-22c5-595b-84c3-376bf13b8ed7",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "c2fa7a41-1841-4efc-b241-092ecd0187ce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a1efaaea-2ea9-58ee-9d01-0db9d4744ed9": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a1efaaea-2ea9-58ee-9d01-0db9d4744ed9",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-CosmosDb0",
                  "SignInName": null,
                  "RoleDefinitionName": "Security Admin",
                  "RoleDefinitionId": "fb1c8493-542b-48eb-b624-b4c8fea62acd",
                  "ObjectId": "e1389625-4532-4d0a-8016-019defcbe532",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a1f54afc-4ea1-5ba1-a14b-ea52ff525ee4": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a1f54afc-4ea1-5ba1-a14b-ea52ff525ee4",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-DataFactory0",
                  "SignInName": null,
                  "RoleDefinitionName": "Data Factory Contributor",
                  "RoleDefinitionId": "673868aa-7521-48a0-acc6-0f60742d39f5",
                  "ObjectId": "ac1f47ef-5b18-4c23-b653-2c1640c02af5",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a22f7587-fa74-52d2-bb3c-29fa5b374411": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a22f7587-fa74-52d2-bb3c-29fa5b374411",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "c2fa7a41-1841-4efc-b241-092ecd0187ce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a5f0d94a-9590-5b33-b035-08128e0e98c5": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/a5f0d94a-9590-5b33-b035-08128e0e98c5",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-OpenAI0",
                  "SignInName": null,
                  "RoleDefinitionName": "Cognitive Services OpenAI Contributor",
                  "RoleDefinitionId": "a001fd3d-188f-4b5d-821b-7da978bf7442",
                  "ObjectId": "2a5d6356-24eb-4462-842f-1a42600150b7",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/abc45988-3c3b-5027-849c-2f6384ffcece": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/abc45988-3c3b-5027-849c-2f6384ffcece",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-SQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "SQL Server Contributor",
                  "RoleDefinitionId": "6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437",
                  "ObjectId": "6e1bdbb4-3154-4247-9e46-07665a96027a",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/adb5407f-02f6-54cb-885a-8c3bd772a636": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/adb5407f-02f6-54cb-885a-8c3bd772a636",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/af57f98e-098c-5ef2-95bf-6059d859d7ed": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/af57f98e-098c-5ef2-95bf-6059d859d7ed",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "c2fa7a41-1841-4efc-b241-092ecd0187ce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/b9584a98-81fb-5647-b2f7-1e27f04cb89a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/b9584a98-81fb-5647-b2f7-1e27f04cb89a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-vmHybr-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "7d21f057-956c-43e8-9076-507ca45fb4d8",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/bb4e68bf-cee5-58bf-9456-6758da720624": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/bb4e68bf-cee5-58bf-9456-6758da720624",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-PostgreSQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "65dbcc4a-fbe1-4eaf-9d13-67cfc78a8bcc",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/bc8f6f5b-08af-5029-a528-91089bbfd7c2": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/bc8f6f5b-08af-5029-a528-91089bbfd7c2",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-MySQL0",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "d4638c96-f1c0-40b8-88dc-e41e89b57533",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/c69df046-9464-5fa7-a4e6-4ec940d11679": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/c69df046-9464-5fa7-a4e6-4ec940d11679",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-Kubernetes0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Kubernetes Service Policy Add-on Deployment",
                  "RoleDefinitionId": "18ed5180-3e48-46fd-8541-4ea054d57064",
                  "ObjectId": "4874bce3-231a-4e4c-90ef-d2e56e15caa5",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/c7b768b5-5bdd-598a-a73a-8beaaebd4600": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/c7b768b5-5bdd-598a-a73a-8beaaebd4600",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-vmArc-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "38bb27da-6794-4749-9eac-82a79cfc8567",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/cb71459e-4b63-54c3-9605-260f74538dce": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/cb71459e-4b63-54c3-9605-260f74538dce",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Virtual Machine Contributor",
                  "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/d3479c18-1084-5755-9160-cc7db41807fa": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/d3479c18-1084-5755-9160-cc7db41807fa",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Reader",
                  "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                  "ObjectId": "535fe3b7-ad0c-46b2-a4b5-bca05f052cce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/d34f687b-14f4-57ff-8047-4c1a240ffde2": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/d34f687b-14f4-57ff-8047-4c1a240ffde2",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "ad8d007e-7a4d-4f51-b117-8031fc5c10ae",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e3e37dd3-a735-5f2a-a329-05c5a08e9c3a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e3e37dd3-a735-5f2a-a329-05c5a08e9c3a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VM-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "8e09f885-e656-4949-bf97-82eb3c4e43a3",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e5a36161-8536-4cc3-9c74-88ba1b15fdce": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e5a36161-8536-4cc3-9c74-88ba1b15fdce",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                  "SignInName": null,
                  "RoleDefinitionName": "Owner",
                  "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e79df963-f713-58cb-beb5-831377301a41": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e79df963-f713-58cb-beb5-831377301a41",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e8c74cbd-44ec-5e26-9edc-fbd96145915a": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e8c74cbd-44ec-5e26-9edc-fbd96145915a",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-MDFC-DefSQL-AMA",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "c2fa7a41-1841-4efc-b241-092ecd0187ce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e9125113-f6ff-5928-aaf1-39f4eaf0235e": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/e9125113-f6ff-5928-aaf1-39f4eaf0235e",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-vmArc-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "38bb27da-6794-4749-9eac-82a79cfc8567",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/ecb16890-74c3-5f99-8857-41686ad71f3b": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/ecb16890-74c3-5f99-8857-41686ad71f3b",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-AppServices0",
                  "SignInName": null,
                  "RoleDefinitionName": "Website Contributor",
                  "RoleDefinitionId": "de139f84-1756-47ae-9be6-808fbbe84772",
                  "ObjectId": "08a55b11-45d7-469d-b91c-c939d3807428",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/ecece4f1-85b7-5914-88f7-9b9a5d324033": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/ecece4f1-85b7-5914-88f7-9b9a5d324033",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "Monitoring Contributor",
                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/ed04b2bd-4d96-51dc-bfad-8a728ffbc641": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/ed04b2bd-4d96-51dc-bfad-8a728ffbc641",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-ServiceBus0",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Service Bus Data Owner",
                  "RoleDefinitionId": "090c5cfd-751d-490a-894a-3ce6f1109419",
                  "ObjectId": "202f8148-2104-41a3-8544-91a2e296ed54",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/f00ac66a-5ccd-57df-89c5-17ebd4dc5d29": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/f00ac66a-5ccd-57df-89c5-17ebd4dc5d29",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-GuestAttest",
                  "SignInName": null,
                  "RoleDefinitionName": "Managed Identity Contributor",
                  "RoleDefinitionId": "e40ec5ca-96e0-45a2-b4ff-59039f2c2b59",
                  "ObjectId": "535fe3b7-ad0c-46b2-a4b5-bca05f052cce",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/f6db367e-e677-5e27-81cf-a99afcf44889": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/f6db367e-e677-5e27-81cf-a99afcf44889",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-Monitoring",
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/f91d2cb6-4678-57ef-b942-2851cf3025aa": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/f91d2cb6-4678-57ef-b942-2851cf3025aa",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-CogServ0",
                  "SignInName": null,
                  "RoleDefinitionName": "Search Service Contributor",
                  "RoleDefinitionId": "7ca78c08-252a-4471-8644-bb5ff32d4ba0",
                  "ObjectId": "e61d8f94-6754-42ca-92e1-174e079e37e9",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/fa01b8be-07fd-52ac-bc4a-3305f87a4436": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/fa01b8be-07fd-52ac-bc4a-3305f87a4436",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Deploy-VMSS-ChangeTrack",
                  "SignInName": null,
                  "RoleDefinitionName": "Log Analytics Contributor",
                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "ObjectId": "ad8d007e-7a4d-4f51-b117-8031fc5c10ae",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/fa310cfe-a919-5360-a8c0-9a736e1b52c4": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/fa310cfe-a919-5360-a8c0-9a736e1b52c4",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enable-AUM-CheckUpdates",
                  "SignInName": null,
                  "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                  "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                  "ObjectId": "1261171c-968b-4051-a4f3-ffe35bee94b2",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/fd989f1b-0434-59da-8abf-e86054328cf2": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/platform/providers/microsoft.authorization/roleassignments/fd989f1b-0434-59da-8abf-e86054328cf2",
                  "Scope": "/providers/Microsoft.Management/managementGroups/platform",
                  "DisplayName": "Enforce-GR-CosmosDb0",
                  "SignInName": null,
                  "RoleDefinitionName": "DocumentDB Account Contributor",
                  "RoleDefinitionId": "5bd9cd88-fe45-4216-938b-f97437e15450",
                  "ObjectId": "e1389625-4532-4d0a-8016-019defcbe532",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ]
            },
            "DiagnosticSettings": {},
            "Subscriptions": {},
            "ManagementGroups": {
              "connectivity": {
                "MgId": "connectivity",
                "MgName": "Connectivity",
                "mgParentId": "platform",
                "mgParentName": "Platform",
                "level": "3",
                "PolicyDefinitionsCustom": {},
                "PolicySetDefinitionsCustom": {},
                "BlueprintDefinitions": {},
                "PolicyAssignments": {
                  "/providers/Microsoft.Management/managementGroups/connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET": {
                    "identity": {
                      "principalId": "ccdffaf3-7266-4cf6-93dd-69c2687c41fa",
                      "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                      "type": "SystemAssigned"
                    },
                    "properties": {
                      "displayName": "Virtual networks should be protected by Azure DDoS Network Protection",
                      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                      "scope": "/providers/Microsoft.Management/managementGroups/connectivity",
                      "notScopes": [],
                      "parameters": {
                        "ddosPlan": {
                          "value": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-ddos/providers/Microsoft.Network/ddosProtectionPlans/alz-ddos-eastus2"
                        },
                        "effect": {
                          "value": "Modify"
                        }
                      },
                      "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Network Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:45.5455786Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "This resource must be compliant with the assigned policy."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Enable-DDoS-VNET",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:44.9080285Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:44.9080285Z"
                    }
                  }
                },
                "RoleAssignments": {
                  "/providers/microsoft.management/managementgroups/connectivity/providers/microsoft.authorization/roleassignments/4146ec13-df2c-41bc-ac68-3a0f44cfdc4e": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/connectivity/providers/microsoft.authorization/roleassignments/4146ec13-df2c-41bc-ac68-3a0f44cfdc4e",
                      "Scope": "/providers/Microsoft.Management/managementGroups/connectivity",
                      "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                      "SignInName": null,
                      "RoleDefinitionName": "Owner",
                      "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                      "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/providers/microsoft.management/managementgroups/connectivity/providers/microsoft.authorization/roleassignments/aa248a30-c76a-57d5-b8c5-7d6d5660657b": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/connectivity/providers/microsoft.authorization/roleassignments/aa248a30-c76a-57d5-b8c5-7d6d5660657b",
                      "Scope": "/providers/Microsoft.Management/managementGroups/connectivity",
                      "DisplayName": "Enable-DDoS-VNET",
                      "SignInName": null,
                      "RoleDefinitionName": "Network Contributor",
                      "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                      "ObjectId": "ccdffaf3-7266-4cf6-93dd-69c2687c41fa",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                },
                "DiagnosticSettings": {},
                "Subscriptions": {
                  "399a72e1-30af-4a84-92ac-af885a677310": {
                    "SubscriptionName": "azr-mge-dev-sub-04",
                    "SubscriptionQuotaId": "Internal_2014-09-01",
                    "SubscriptionState": "Enabled",
                    "SubscriptionTags": [
                      {
                        "Key": "alz-alias",
                        "Value": "identity",
                        "Name": "alz-alias"
                      },
                      {
                        "Key": "Division",
                        "Value": "Core",
                        "Name": "Division"
                      },
                      {
                        "Key": "Environment",
                        "Value": "Hybrid",
                        "Name": "Environment"
                      },
                      {
                        "Key": "Purpose",
                        "Value": "UserTenant",
                        "Name": "Purpose"
                      },
                      {
                        "Key": "TimeZone",
                        "Value": "_P10138588_United States_444350001",
                        "Name": "TimeZone"
                      },
                      {
                        "Key": "trn-alias",
                        "Value": "connectivity",
                        "Name": "trn-alias"
                      }
                    ],
                    "PolicyDefinitionsCustom": {},
                    "PolicySetDefinitionsCustom": {},
                    "BlueprintDefinitions": {},
                    "PolicyAssignments": {
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC DataProtection (subscription: 399a72e1-30af-4a84-92ac-af885a677310)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:37.9389788Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "DataProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:37.8853595Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:37.8853595Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning AKS Security Profile": {
                        "identity": {
                          "principalId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning AKS Security Profile",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:12:00.6799513Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:12:11.1985908Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning AKS Security Profile",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning AKS Security Profile",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:12:00.0885795Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:12:11.0390946Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning ARC k8s Enabled": {
                        "identity": {
                          "principalId": "d2712173-b6ca-49e0-997f-a42883ba2297",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/708b60a6-d253-4fe0-9114-4be4c00f012c",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:12:00.9013392Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:12:11.3927904Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning ARC k8s Enabled",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning ARC k8s Enabled",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:12:00.294753Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:12:11.178158Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Azure Policy Addon for Kub": {
                        "identity": {
                          "principalId": "632a4d89-8100-4094-9e7c-b1b20a2c14e6",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:12:00.7204273Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:12:11.2529691Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Azure Policy Addon for Kub",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning Azure Policy Addon for Kub",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:12:00.2321372Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:12:11.0289819Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Policy extension for Arc-e": {
                        "identity": {
                          "principalId": "896c44db-432a-4586-91ae-28cd483cefb8",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0adc5395-9169-4b9b-8687-af838d69410a",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:12:00.6528148Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:12:11.4002387Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Policy extension for Arc-e",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning Policy extension for Arc-e",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:12:00.2079779Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:12:11.1767532Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for SQL on SQL VMs and Arc-enabled SQL Servers": {
                        "identity": {
                          "principalId": "af6197aa-135e-408c-afb6-a60768086310",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/d7c3ea3a-edf3-4bd5-bd64-d5b635b05393",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:12:11.9946166Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:12:11.4297491Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:12:11.4297491Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC OpenSourceRelationalDatabasesProtection (subscription: 399a72e1-30af-4a84-92ac-af885a677310)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:56.9050314Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:56.7492629Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:56.7492629Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn": {
                        "properties": {
                          "displayName": "ASC Default (subscription: 399a72e1-30af-4a84-92ac-af885a677310)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "parameters": {},
                          "description": "This is the default set of policies monitored by Azure Security Center. It was automatically assigned as part of onboarding to Security Center. The default assignment contains only audit policies. For more information please visit https://aka.ms/ascpolicies",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "5b78eb55-3d4e-49c7-b443-a90799761640",
                            "createdOn": "2024-07-17T04:00:02.4631038Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SecurityCenterBuiltIn",
                        "systemData": {
                          "createdBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "createdByType": "Application",
                          "createdAt": "2024-07-17T04:00:00.5430714Z",
                          "lastModifiedBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2024-07-17T04:00:00.5430714Z"
                        }
                      },
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection": {
                        "identity": {
                          "principalId": "cbf25f57-604d-4870-b7a0-ce09f4355dc4",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL Servers on Machines provisioning (subscription: 399a72e1-30af-4a84-92ac-af885a677310)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/c1529623-9fc2-45bc-b84b-b14cd0b7484e",
                          "scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "description": "This initiative enables Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "2edb2aec-6497-405f-9b4c-3b489dcf0c45",
                            "createdOn": "2025-11-10T21:04:49.8460159Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SqlVmAndArcSqlServersProtection",
                        "location": "westeurope",
                        "systemData": {
                          "createdBy": "77cef9f1-f194-4ef3-aeb9-5976388f3945",
                          "createdByType": "Application",
                          "createdAt": "2025-11-10T21:04:48.2480502Z",
                          "lastModifiedBy": "77cef9f1-f194-4ef3-aeb9-5976388f3945",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2025-11-10T21:04:48.2480502Z"
                        }
                      }
                    },
                    "RoleAssignments": {
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/079b70c3-629e-4ee0-af26-499fec29596e": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/079b70c3-629e-4ee0-af26-499fec29596e",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Scanner Operator",
                          "RoleDefinitionId": "0f641de8-0b88-4198-bdef-bd8b45ceba96",
                          "ObjectId": "6c612e71-0944-4b98-adc4-e92e5478857c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1a6b5d81-7a02-4c41-a2b5-4dd63497c8a5": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1a6b5d81-7a02-4c41-a2b5-4dd63497c8a5",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Contributor",
                          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                          "ObjectId": "af6197aa-135e-408c-afb6-a60768086310",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1ca4377e-3dc6-5508-10ed-88b0148fb36c": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1ca4377e-3dc6-5508-10ed-88b0148fb36c",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Owner (alz-mgmt)",
                          "RoleDefinitionId": "f95e05f3-0265-c57d-a9f9-d78015027a11",
                          "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1d73bf12-a193-44b2-b403-731fe1b50ecd": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1d73bf12-a193-44b2-b403-731fe1b50ecd",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "d2712173-b6ca-49e0-997f-a42883ba2297",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1ffcee44-10d5-4707-877b-e98f919ec4da": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/1ffcee44-10d5-4707-877b-e98f919ec4da",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "130138f2-6056-4ee8-a254-d3717d01c495",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/27d0a7da-1e4f-4fde-4e22-7ee50322157d": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/27d0a7da-1e4f-4fde-4e22-7ee50322157d",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "d2712173-b6ca-49e0-997f-a42883ba2297",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/2bd64e4a-9904-70b9-5a5d-635e749ef4b5": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/2bd64e4a-9904-70b9-5a5d-635e749ef4b5",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Data Scanner",
                          "RoleDefinitionId": "1e7ca9b1-60d1-4db8-a914-f2ca1ff27c40",
                          "ObjectId": "5e24b36b-8f41-4294-85a5-83ff954662f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/3776ef05-f0f1-4d78-6d1d-28dc1998ce7a": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/3776ef05-f0f1-4d78-6d1d-28dc1998ce7a",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/3bf721c8-6dd6-4b59-3f81-434795d944c4": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/3bf721c8-6dd6-4b59-3f81-434795d944c4",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "896c44db-432a-4586-91ae-28cd483cefb8",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/3e582e04-f567-a869-3ca1-e9f2057f6e1d": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/3e582e04-f567-a869-3ca1-e9f2057f6e1d",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "id-alz-mgmt-eastus2-plan-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Reader (alz-mgmt)",
                          "RoleDefinitionId": "89737a5a-a182-3c5a-849f-aafd11be99ff",
                          "ObjectId": "8083fb27-b991-474f-b1e6-c2a8e20fcb25",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/48306fcf-4eab-44f3-ccc1-376b255c1260": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/48306fcf-4eab-44f3-ccc1-376b255c1260",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/5027bf61-0e61-4c79-3123-cb6ecb31479b": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/5027bf61-0e61-4c79-3123-cb6ecb31479b",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Monitoring Contributor",
                          "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                          "ObjectId": "af6197aa-135e-408c-afb6-a60768086310",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/50a587a4-fe0a-426f-b296-0bca07a3ed00": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/50a587a4-fe0a-426f-b296-0bca07a3ed00",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "896c44db-432a-4586-91ae-28cd483cefb8",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/5f09e2fa-f6f6-43d7-97b0-c202cad2ed30": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/5f09e2fa-f6f6-43d7-97b0-c202cad2ed30",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage File Data Privileged Reader",
                          "RoleDefinitionId": "b8eda974-7b85-4f76-af95-65846b26df6d",
                          "ObjectId": "5e24b36b-8f41-4294-85a5-83ff954662f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/63580dca-e585-4743-0c84-71b7b458ebfa": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/63580dca-e585-4743-0c84-71b7b458ebfa",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "632a4d89-8100-4094-9e7c-b1b20a2c14e6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/66fee840-bc04-438f-4452-eaa0a0e21caa": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/66fee840-bc04-438f-4452-eaa0a0e21caa",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "896c44db-432a-4586-91ae-28cd483cefb8",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/6dd0d409-3fee-4f65-2ba2-094001f53bc6": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/6dd0d409-3fee-4f65-2ba2-094001f53bc6",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "d2712173-b6ca-49e0-997f-a42883ba2297",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/6ffb789f-bee7-4c9a-a9ca-366864ad7001": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/6ffb789f-bee7-4c9a-a9ca-366864ad7001",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender CSPM Storage Scanner Operator",
                          "RoleDefinitionId": "8480c0f0-4509-4229-9339-7c10018cb8c4",
                          "ObjectId": "22925100-5144-42ce-9259-18ecd377ebb6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/7012bc3c-fac7-42c3-36b6-149544ec26c5": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/7012bc3c-fac7-42c3-36b6-149544ec26c5",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/70250671-f618-4e68-43e7-f071c8ee0656": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/70250671-f618-4e68-43e7-f071c8ee0656",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "896c44db-432a-4586-91ae-28cd483cefb8",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/72179af7-6503-4e29-0f02-1d17aae5af1a": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/72179af7-6503-4e29-0f02-1d17aae5af1a",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/72bb5561-b133-4f28-1bd2-1df6a5178ed0": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/72bb5561-b133-4f28-1bd2-1df6a5178ed0",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/7f1a2041-ba8a-45fd-18bc-5714a413f322": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/7f1a2041-ba8a-45fd-18bc-5714a413f322",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "632a4d89-8100-4094-9e7c-b1b20a2c14e6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/87638a18-0aba-4d40-cf81-8c5777f5e59c": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/87638a18-0aba-4d40-cf81-8c5777f5e59c",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "d2712173-b6ca-49e0-997f-a42883ba2297",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/8cc59ca2-22c5-402c-990d-ca03e6f8266b": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/8cc59ca2-22c5-402c-990d-ca03e6f8266b",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage Blob Data Reader",
                          "RoleDefinitionId": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
                          "ObjectId": "5e24b36b-8f41-4294-85a5-83ff954662f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/95c76b52-1e5f-4c57-5550-ab6337e2022c": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/95c76b52-1e5f-4c57-5550-ab6337e2022c",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "632a4d89-8100-4094-9e7c-b1b20a2c14e6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/96a17df1-d477-4ede-b147-f678ce8b82ea": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/96a17df1-d477-4ede-b147-f678ce8b82ea",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/9737cc7b-e496-436c-9feb-406619242452": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/9737cc7b-e496-436c-9feb-406619242452",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/987ce9e0-7519-4c3f-be0b-ee64ab95bdf9": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/987ce9e0-7519-4c3f-be0b-ee64ab95bdf9",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "managedenvironments-ar-tenant-connector",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "40b922de-ef06-430f-a397-a32d3fa5afca",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/9d85c19c-5e26-4e1f-542b-f7a712aef867": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/9d85c19c-5e26-4e1f-542b-f7a712aef867",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "fc25dcbb-ab32-4687-ba79-d3bd0909343c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/9dbc58d8-b6f1-4e28-bd5a-edcb76357f1a": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/9dbc58d8-b6f1-4e28-bd5a-edcb76357f1a",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "EventGrid Contributor",
                          "RoleDefinitionId": "1e241071-0855-49ea-94dc-649edcd759de",
                          "ObjectId": "6c612e71-0944-4b98-adc4-e92e5478857c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/a7321d69-7d9a-45c4-b07a-bbaca8f38d64": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/a7321d69-7d9a-45c4-b07a-bbaca8f38d64",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "632a4d89-8100-4094-9e7c-b1b20a2c14e6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/a92a7eac-879d-4e9c-8f27-5543c7f06c9c": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/a92a7eac-879d-4e9c-8f27-5543c7f06c9c",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Microsoft Demos",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "3ba76acc-be40-4508-a9cb-2853c9ef3396",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/aceffdde-8afe-4e82-a2a2-36ebf4be33d5": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/aceffdde-8afe-4e82-a2a2-36ebf4be33d5",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "130138f2-6056-4ee8-a254-d3717d01c495",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/addc4320-6003-4bae-9f80-f457c3e61483": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/addc4320-6003-4bae-9f80-f457c3e61483",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "22925100-5144-42ce-9259-18ecd377ebb6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/b29a7ad3-2c11-472e-3f39-820de30ac515": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/b29a7ad3-2c11-472e-3f39-820de30ac515",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "af6197aa-135e-408c-afb6-a60768086310",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/b9d78022-d902-4482-8d38-be7aa127f496": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/b9d78022-d902-4482-8d38-be7aa127f496",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Sensitive Data Discovery",
                          "RoleDefinitionId": "0b6ca2e8-2cdc-4bd6-b896-aa3d8c21fc35",
                          "ObjectId": "5e24b36b-8f41-4294-85a5-83ff954662f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/c3fc2de6-3df6-41d7-96ba-2ee79374e300": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/c3fc2de6-3df6-41d7-96ba-2ee79374e300",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "cbf25f57-604d-4870-b7a0-ce09f4355dc4",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/cab338d0-2c3a-43fe-1ad7-c56b0fcb99e4": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/cab338d0-2c3a-43fe-1ad7-c56b0fcb99e4",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "896c44db-432a-4586-91ae-28cd483cefb8",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/cc07e884-2040-4620-9175-ab16a3ce79be": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/cc07e884-2040-4620-9175-ab16a3ce79be",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Microsoft Defender for Cloud Servers Scanner Resource Provider",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Agentless VM Scan",
                          "RoleDefinitionId": "d24ecba3-c1f4-40fa-a7bb-4588a071e8fd",
                          "ObjectId": "65d577d2-0846-488c-94ff-5a5b872010f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/cf78aa0d-d8c1-489a-9a37-93acd87b8087": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/cf78aa0d-d8c1-489a-9a37-93acd87b8087",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "632a4d89-8100-4094-9e7c-b1b20a2c14e6",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/da15758a-a166-4f98-bde1-7fe56bfa97b7": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/da15758a-a166-4f98-bde1-7fe56bfa97b7",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Managed Identity Operator",
                          "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                          "ObjectId": "cbf25f57-604d-4870-b7a0-ce09f4355dc4",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/ddd7721a-4206-4f3d-872e-695ba5d1003f": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/ddd7721a-4206-4f3d-872e-695ba5d1003f",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Cloud Infrastructure Entitlement Management",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "499b1a12-a346-48b0-be20-8ac5ecd42c40",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e11550f4-c8ea-41a0-a8de-74a09324f376": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e11550f4-c8ea-41a0-a8de-74a09324f376",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "d2712173-b6ca-49e0-997f-a42883ba2297",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e119c709-99ad-4693-8f89-b97fca21c634": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e119c709-99ad-4693-8f89-b97fca21c634",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "cbf25f57-604d-4870-b7a0-ce09f4355dc4",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e2509e95-e7e2-4cfd-bdde-32265f04e822": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e2509e95-e7e2-4cfd-bdde-32265f04e822",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "MCAPSGov-AutomationApp",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "d2d58a6c-d725-401a-944d-19d295b91ed0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e6679b72-41ce-484a-68c8-39375bd15988": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/e6679b72-41ce-484a-68c8-39375bd15988",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "af6197aa-135e-408c-afb6-a60768086310",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/f22db1d7-c0c0-4c04-aba1-a8eafb77adc7": [
                        {
                          "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/providers/microsoft.authorization/roleassignments/f22db1d7-c0c0-4c04-aba1-a8eafb77adc7",
                          "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                          "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                          "ObjectId": "af6197aa-135e-408c-afb6-a60768086310",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ]
                    },
                    "BlueprintAssignments": {},
                    "DiagnosticSettings": {
                      "subscriptionToLa": {
                        "Name": "subscriptionToLa",
                        "Type": "LA",
                        "TargetId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                        "Settings": [
                          {
                            "Category": "Administrative",
                            "Enabled": true
                          },
                          {
                            "Category": "Security",
                            "Enabled": true
                          },
                          {
                            "Category": "ServiceHealth",
                            "Enabled": true
                          },
                          {
                            "Category": "Alert",
                            "Enabled": true
                          },
                          {
                            "Category": "Recommendation",
                            "Enabled": true
                          },
                          {
                            "Category": "Policy",
                            "Enabled": true
                          },
                          {
                            "Category": "Autoscale",
                            "Enabled": true
                          },
                          {
                            "Category": "ResourceHealth",
                            "Enabled": true
                          }
                        ]
                      }
                    },
                    "ResourceGroups": {
                      "alz-dns": {
                        "Resources": {
                          "microsoft.network-privatednszones_privatelink.afs.azure.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.afs.azure.net/providers/microsoft.authorization/roleassignments/f0a001b3-c9d6-5e82-8ee9-f189e380b091": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.afs.azure.net/providers/microsoft.authorization/roleassignments/f0a001b3-c9d6-5e82-8ee9-f189e380b091",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Private DNS Zone Contributor",
                                  "RoleDefinitionId": "b12aa53e-6015-4669-85d0-8515ebb3ae7f",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.afs.azure.net/providers/microsoft.authorization/roleassignments/fa8e7922-d0a2-59d3-8895-1ae15064fef3": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.afs.azure.net/providers/microsoft.authorization/roleassignments/fa8e7922-d0a2-59d3-8895-1ae15064fef3",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.agentsvc.azure-automation.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.agentsvc.azure-automation.net/providers/microsoft.authorization/roleassignments/f378d69c-00c7-5d84-b887-be6664626617": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.agentsvc.azure-automation.net/providers/microsoft.authorization/roleassignments/f378d69c-00c7-5d84-b887-be6664626617",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.azure-devices.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azure-devices.net/providers/microsoft.authorization/roleassignments/62820ae9-64b4-5b83-8dff-9483c4efaedc": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azure-devices.net/providers/microsoft.authorization/roleassignments/62820ae9-64b4-5b83-8dff-9483c4efaedc",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azure-devices.net/providers/microsoft.authorization/roleassignments/8a6b1917-89a3-5413-ab3b-2eb06ef57081": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azure-devices.net/providers/microsoft.authorization/roleassignments/8a6b1917-89a3-5413-ab3b-2eb06ef57081",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Contributor",
                                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.azurecr.io": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azurecr.io/providers/microsoft.authorization/roleassignments/53c68144-693d-5eb9-84f9-3d5fb538f08b": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azurecr.io/providers/microsoft.authorization/roleassignments/53c68144-693d-5eb9-84f9-3d5fb538f08b",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.azuredatabricks.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azuredatabricks.net/providers/microsoft.authorization/roleassignments/f834dc98-428c-5b8c-b92e-16bc0b6bdb0e": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azuredatabricks.net/providers/microsoft.authorization/roleassignments/f834dc98-428c-5b8c-b92e-16bc0b6bdb0e",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuredatabricks.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.azurehdinsight.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azurehdinsight.net/providers/microsoft.authorization/roleassignments/3ecd0f7e-0f3f-5756-94b1-99828b238a6b": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.azurehdinsight.net/providers/microsoft.authorization/roleassignments/3ecd0f7e-0f3f-5756-94b1-99828b238a6b",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.blob.core.windows.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.blob.core.windows.net/providers/microsoft.authorization/roleassignments/f26cf474-0499-53b6-a627-99553a4f26a5": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.blob.core.windows.net/providers/microsoft.authorization/roleassignments/f26cf474-0499-53b6-a627-99553a4f26a5",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.cognitiveservices.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.cognitiveservices.azure.com/providers/microsoft.authorization/roleassignments/02b69eed-0266-5308-a305-618f3b89a168": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.cognitiveservices.azure.com/providers/microsoft.authorization/roleassignments/02b69eed-0266-5308-a305-618f3b89a168",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.dfs.core.windows.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.dfs.core.windows.net/providers/microsoft.authorization/roleassignments/5ecf8b8b-13f3-5fb7-a38d-8cc63ea20ce2": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.dfs.core.windows.net/providers/microsoft.authorization/roleassignments/5ecf8b8b-13f3-5fb7-a38d-8cc63ea20ce2",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.dp.kubernetesconfiguration.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.dp.kubernetesconfiguration.azure.com/providers/microsoft.authorization/roleassignments/4cbbe705-0b59-534e-b399-5b1b340a07f5": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.dp.kubernetesconfiguration.azure.com/providers/microsoft.authorization/roleassignments/4cbbe705-0b59-534e-b399-5b1b340a07f5",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dp.kubernetesconfiguration.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.eus2.backup.windowsazure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.eus2.backup.windowsazure.com/providers/microsoft.authorization/roleassignments/595336de-c089-524a-baa1-c7bb1f275ad9": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.eus2.backup.windowsazure.com/providers/microsoft.authorization/roleassignments/595336de-c089-524a-baa1-c7bb1f275ad9",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus2.backup.windowsazure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.file.core.windows.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.file.core.windows.net/providers/microsoft.authorization/roleassignments/35456175-28b8-51b1-bd22-a3663554466d": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.file.core.windows.net/providers/microsoft.authorization/roleassignments/35456175-28b8-51b1-bd22-a3663554466d",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.grafana.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.grafana.azure.com/providers/microsoft.authorization/roleassignments/49d8d84e-4e72-5fc6-a003-38f75924408a": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.grafana.azure.com/providers/microsoft.authorization/roleassignments/49d8d84e-4e72-5fc6-a003-38f75924408a",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.grafana.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.guestconfiguration.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.guestconfiguration.azure.com/providers/microsoft.authorization/roleassignments/75a2624a-e416-55b2-b06a-52a6c7653247": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.guestconfiguration.azure.com/providers/microsoft.authorization/roleassignments/75a2624a-e416-55b2-b06a-52a6c7653247",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.his.arc.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.his.arc.azure.com/providers/microsoft.authorization/roleassignments/b1f1aa94-caf0-5ac4-b814-b9af455bc582": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.his.arc.azure.com/providers/microsoft.authorization/roleassignments/b1f1aa94-caf0-5ac4-b814-b9af455bc582",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.media.azure.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.media.azure.net/providers/microsoft.authorization/roleassignments/50b206ba-5079-5a70-a9b0-6b7e2b4e053e": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.media.azure.net/providers/microsoft.authorization/roleassignments/50b206ba-5079-5a70-a9b0-6b7e2b4e053e",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.monitor.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.monitor.azure.com/providers/microsoft.authorization/roleassignments/93d4e52e-2031-5c10-ae38-cf9879c31aa2": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.monitor.azure.com/providers/microsoft.authorization/roleassignments/93d4e52e-2031-5c10-ae38-cf9879c31aa2",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.ods.opinsights.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.ods.opinsights.azure.com/providers/microsoft.authorization/roleassignments/9aa8391c-7ffc-50ff-a7fb-ab6de00b8c52": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.ods.opinsights.azure.com/providers/microsoft.authorization/roleassignments/9aa8391c-7ffc-50ff-a7fb-ab6de00b8c52",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.oms.opinsights.azure.com": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.oms.opinsights.azure.com/providers/microsoft.authorization/roleassignments/bf664c14-3dd6-5553-8794-18889f642125": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.oms.opinsights.azure.com/providers/microsoft.authorization/roleassignments/bf664c14-3dd6-5553-8794-18889f642125",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.queue.core.windows.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.queue.core.windows.net/providers/microsoft.authorization/roleassignments/5179fb4b-c1c8-56ac-b7a1-a8fc6df348b6": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.queue.core.windows.net/providers/microsoft.authorization/roleassignments/5179fb4b-c1c8-56ac-b7a1-a8fc6df348b6",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.table.core.windows.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.table.core.windows.net/providers/microsoft.authorization/roleassignments/ca46f5e2-c965-5e2b-9982-e79f88456021": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.table.core.windows.net/providers/microsoft.authorization/roleassignments/ca46f5e2-c965-5e2b-9982-e79f88456021",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.vaultcore.azure.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.vaultcore.azure.net/providers/microsoft.authorization/roleassignments/bc9351ba-ce1d-5346-9d97-704f66b74b3e": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.vaultcore.azure.net/providers/microsoft.authorization/roleassignments/bc9351ba-ce1d-5346-9d97-704f66b74b3e",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.network-privatednszones_privatelink.web.core.windows.net": {
                            "RoleAssignments": {
                              "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.web.core.windows.net/providers/microsoft.authorization/roleassignments/d0fd1589-8905-5fde-9bdd-a95f926d6245": [
                                {
                                  "RoleAssignmentId": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourcegroups/alz-dns/providers/microsoft.network/privatednszones/privatelink.web.core.windows.net/providers/microsoft.authorization/roleassignments/d0fd1589-8905-5fde-9bdd-a95f926d6245",
                                  "Scope": "/subscriptions/399a72e1-30af-4a84-92ac-af885a677310/resourceGroups/alz-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net",
                                  "DisplayName": "Deploy-Private-DNS-Zones",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Network Contributor",
                                  "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                                  "ObjectId": "c53367bf-c70d-47fe-800a-d39cec62b490",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "ManagementGroups": {}
              },
              "identity": {
                "MgId": "identity",
                "MgName": "Identity",
                "mgParentId": "platform",
                "mgParentName": "Platform",
                "level": "3",
                "PolicyDefinitionsCustom": {},
                "PolicySetDefinitionsCustom": {},
                "BlueprintDefinitions": {},
                "PolicyAssignments": {
                  "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Management port access from the Internet should be blocked",
                      "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                      "scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "notScopes": [],
                      "parameters": {},
                      "description": "This policy denies any network security rule that allows management port access from the Internet",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:50.2790815Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Management port access from the Internet must be blocked."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deny-MgmtPorts-Internet",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:50.2517714Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:50.2517714Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Deny the creation of public IP",
                      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                      "scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "notScopes": [],
                      "parameters": {
                        "effect": {
                          "value": "Deny"
                        },
                        "listOfResourceTypesNotAllowed": {
                          "value": [
                            "Microsoft.Network/publicIPAddresses"
                          ]
                        }
                      },
                      "description": "This policy denies creation of Public IPs under the assigned scope.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:50.8479536Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Public IPs must not be created under this scope."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deny-Public-IP",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:50.8081301Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:50.8081301Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg": {
                    "identity": {
                      "type": "None"
                    },
                    "properties": {
                      "displayName": "Subnets should have a Network Security Group",
                      "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                      "scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "notScopes": [],
                      "parameters": {},
                      "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:43.9062621Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Subnets must have a Network Security Group."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deny-Subnet-Without-Nsg",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:43.8735991Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:43.8735991Z"
                    }
                  },
                  "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup": {
                    "identity": {
                      "principalId": "58b4675a-f317-4f50-a9d9-d94a7a1ed1b3",
                      "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                      "type": "SystemAssigned"
                    },
                    "properties": {
                      "displayName": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
                      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
                      "scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "notScopes": [],
                      "parameters": {},
                      "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
                      "metadata": {
                        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                        "createdOn": "2026-01-21T00:37:48.5768158Z",
                        "updatedBy": null,
                        "updatedOn": null
                      },
                      "enforcementMode": "Default",
                      "nonComplianceMessages": [
                        {
                          "message": "Backup on virtual machines without a given tag must be configured to a new recovery services vault with a default policy."
                        }
                      ]
                    },
                    "id": "/providers/Microsoft.Management/managementGroups/identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
                    "type": "Microsoft.Authorization/policyAssignments",
                    "name": "Deploy-VM-Backup",
                    "location": "eastus2",
                    "systemData": {
                      "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "createdByType": "Application",
                      "createdAt": "2026-01-21T00:37:48.1026242Z",
                      "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                      "lastModifiedByType": "Application",
                      "lastModifiedAt": "2026-01-21T00:37:48.1026242Z"
                    }
                  }
                },
                "RoleAssignments": {
                  "/providers/microsoft.management/managementgroups/identity/providers/microsoft.authorization/roleassignments/33d8edfc-cef4-562d-bb2e-5eb74041a5fb": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/identity/providers/microsoft.authorization/roleassignments/33d8edfc-cef4-562d-bb2e-5eb74041a5fb",
                      "Scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "DisplayName": "Deploy-VM-Backup",
                      "SignInName": null,
                      "RoleDefinitionName": "Virtual Machine Contributor",
                      "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                      "ObjectId": "58b4675a-f317-4f50-a9d9-d94a7a1ed1b3",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/providers/microsoft.management/managementgroups/identity/providers/microsoft.authorization/roleassignments/9b62158f-480b-555f-92cb-e673541bdf04": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/identity/providers/microsoft.authorization/roleassignments/9b62158f-480b-555f-92cb-e673541bdf04",
                      "Scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "DisplayName": "Deploy-VM-Backup",
                      "SignInName": null,
                      "RoleDefinitionName": "Backup Contributor",
                      "RoleDefinitionId": "5e467623-bb1f-42f4-a55d-6e525e11384b",
                      "ObjectId": "58b4675a-f317-4f50-a9d9-d94a7a1ed1b3",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/providers/microsoft.management/managementgroups/identity/providers/microsoft.authorization/roleassignments/adbbfc1a-d31e-4500-a948-5f0438cea495": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/identity/providers/microsoft.authorization/roleassignments/adbbfc1a-d31e-4500-a948-5f0438cea495",
                      "Scope": "/providers/Microsoft.Management/managementGroups/identity",
                      "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                      "SignInName": null,
                      "RoleDefinitionName": "Owner",
                      "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                      "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                },
                "DiagnosticSettings": {},
                "Subscriptions": {
                  "1c083bf3-30ac-4804-aa81-afddc58c78dc": {
                    "SubscriptionName": "azr-mge-dev-sub-02",
                    "SubscriptionQuotaId": "Internal_2014-09-01",
                    "SubscriptionState": "Enabled",
                    "SubscriptionTags": [
                      {
                        "Key": "alz-alias",
                        "Value": "connectivity",
                        "Name": "alz-alias"
                      },
                      {
                        "Key": "Division",
                        "Value": "Core",
                        "Name": "Division"
                      },
                      {
                        "Key": "Environment",
                        "Value": "Hybrid",
                        "Name": "Environment"
                      },
                      {
                        "Key": "Purpose",
                        "Value": "UserTenant",
                        "Name": "Purpose"
                      },
                      {
                        "Key": "TimeZone",
                        "Value": "_P10138588_United States_444350001",
                        "Name": "TimeZone"
                      },
                      {
                        "Key": "trn-alias:",
                        "Value": "identity",
                        "Name": "trn-alias:"
                      }
                    ],
                    "PolicyDefinitionsCustom": {},
                    "PolicySetDefinitionsCustom": {},
                    "BlueprintDefinitions": {},
                    "PolicyAssignments": {
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/ASC provisioning default LA agent Linux Arc": {
                        "identity": {
                          "principalId": "cf96e6be-f825-4d30-9258-7bb0f3c6f655",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "ASC provisioning default LA agent Linux Arc",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bacd7fca-1938-443d-aad6-a786107b1bfb",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:34:12.1374289Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/ASC provisioning default LA agent Linux Arc",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "ASC provisioning default LA agent Linux Arc",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:34:11.524976Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:34:11.524976Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/ASC provisioning default LA agent Windows Arc": {
                        "identity": {
                          "principalId": "aaf3926e-2755-4bc3-8158-c8bcae463565",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "ASC provisioning default LA agent Windows Arc",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/594c1276-f44f-482d-9910-71fac2ce5ae0",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:34:11.9804199Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/ASC provisioning default LA agent Windows Arc",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "ASC provisioning default LA agent Windows Arc",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:34:11.4282303Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:34:11.4282303Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC DataProtection (subscription: 1c083bf3-30ac-4804-aa81-afddc58c78dc)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:10:55.6232498Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "DataProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:10:55.5902307Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:10:55.5902307Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning AKS Security Profile": {
                        "identity": {
                          "principalId": "ebb4952e-6c2b-4a98-b018-349935a41bda",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning AKS Security Profile",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:02.8850035Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:11:10.0214747Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning AKS Security Profile",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning AKS Security Profile",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:02.5017042Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:09.7664011Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning ARC k8s Enabled": {
                        "identity": {
                          "principalId": "0e0c4910-eba1-43b4-8dcf-fedf8e56335c",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/708b60a6-d253-4fe0-9114-4be4c00f012c",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:03.0719702Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:11:10.0267975Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning ARC k8s Enabled",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning ARC k8s Enabled",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:02.5598674Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:09.7958887Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Azure Policy Addon for Kub": {
                        "identity": {
                          "principalId": "0b4e17b1-fe4a-44d8-a8c3-b53c0e035da0",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:03.1348915Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:11:10.8417333Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Azure Policy Addon for Kub",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning Azure Policy Addon for Kub",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:02.5508104Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:10.6887522Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Policy extension for Arc-e": {
                        "identity": {
                          "principalId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0adc5395-9169-4b9b-8687-af838d69410a",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:03.1494757Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:11:09.9202654Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Policy extension for Arc-e",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning Policy extension for Arc-e",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:02.6287548Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:09.5848937Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for SQL on SQL VMs and Arc-enabled SQL Servers": {
                        "identity": {
                          "principalId": "bdb637b4-220c-43e3-8799-de2b19952905",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/d7c3ea3a-edf3-4bd5-bd64-d5b635b05393",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:10.8468481Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:09.8723388Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:09.8723388Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC OpenSourceRelationalDatabasesProtection (subscription: 1c083bf3-30ac-4804-aa81-afddc58c78dc)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:10:59.0498943Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:10:59.0335423Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:10:59.0335423Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn": {
                        "properties": {
                          "displayName": "ASC Default (subscription: 1c083bf3-30ac-4804-aa81-afddc58c78dc)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "parameters": {},
                          "description": "This is the default set of policies monitored by Azure Security Center. It was automatically assigned as part of onboarding to Security Center. The default assignment contains only audit policies. For more information please visit https://aka.ms/ascpolicies",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "5b78eb55-3d4e-49c7-b443-a90799761640",
                            "createdOn": "2024-07-17T04:01:15.4212238Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SecurityCenterBuiltIn",
                        "systemData": {
                          "createdBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "createdByType": "Application",
                          "createdAt": "2024-07-17T04:01:14.5637089Z",
                          "lastModifiedBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2024-07-17T04:01:14.5637089Z"
                        }
                      },
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection": {
                        "identity": {
                          "principalId": "50b1f477-5130-4552-b100-e6e77210db45",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL Servers on Machines provisioning (subscription: 1c083bf3-30ac-4804-aa81-afddc58c78dc)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/c1529623-9fc2-45bc-b84b-b14cd0b7484e",
                          "scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "description": "This initiative enables Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "2edb2aec-6497-405f-9b4c-3b489dcf0c45",
                            "createdOn": "2025-11-10T21:04:52.2025593Z",
                            "updatedBy": "6ee43372-341c-4b21-81ed-b62c0d888d2e",
                            "updatedOn": "2025-11-10T21:05:23.065163Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SqlVmAndArcSqlServersProtection",
                        "location": "westeurope",
                        "systemData": {
                          "createdBy": "77cef9f1-f194-4ef3-aeb9-5976388f3945",
                          "createdByType": "Application",
                          "createdAt": "2025-11-10T21:04:50.8764731Z",
                          "lastModifiedBy": "5387eab3-6a7f-4717-a121-913f426edaf9",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2025-11-10T21:05:22.8685645Z"
                        }
                      }
                    },
                    "RoleAssignments": {
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/0cb1603e-55b1-ccea-47f0-ac871526a1d3": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/0cb1603e-55b1-ccea-47f0-ac871526a1d3",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "id-alz-mgmt-eastus2-plan-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Reader (alz-mgmt)",
                          "RoleDefinitionId": "89737a5a-a182-3c5a-849f-aafd11be99ff",
                          "ObjectId": "8083fb27-b991-474f-b1e6-c2a8e20fcb25",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/152c5bbd-4d8f-4824-9332-6f872979cffc": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/152c5bbd-4d8f-4824-9332-6f872979cffc",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "ebb4952e-6c2b-4a98-b018-349935a41bda",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/19285e91-bbcc-41e9-e276-4afd5cd46103": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/19285e91-bbcc-41e9-e276-4afd5cd46103",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "bdb637b4-220c-43e3-8799-de2b19952905",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/22753ce3-f7d6-4a09-863a-21c0c6136261": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/22753ce3-f7d6-4a09-863a-21c0c6136261",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/298abe1e-e4a8-43a5-bf3d-2468b1eabcfa": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/298abe1e-e4a8-43a5-bf3d-2468b1eabcfa",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "EventGrid Contributor",
                          "RoleDefinitionId": "1e241071-0855-49ea-94dc-649edcd759de",
                          "ObjectId": "e6c6eb57-dba7-4ff1-a91f-6c7cb9fbf805",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/2f4263be-e32e-4ce1-94a1-265a3da7aa7f": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/2f4263be-e32e-4ce1-94a1-265a3da7aa7f",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "50b1f477-5130-4552-b100-e6e77210db45",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/32862f74-4214-4863-112a-510bb31f23d6": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/32862f74-4214-4863-112a-510bb31f23d6",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "0e0c4910-eba1-43b4-8dcf-fedf8e56335c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/33fea1d9-c31a-45c1-526f-520abe3290e8": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/33fea1d9-c31a-45c1-526f-520abe3290e8",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/3a932074-f398-47a5-2776-0df4a3aa7971": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/3a932074-f398-47a5-2776-0df4a3aa7971",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "0b4e17b1-fe4a-44d8-a8c3-b53c0e035da0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/3f9ae6e3-c35b-45b8-b39e-836a145f67af": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/3f9ae6e3-c35b-45b8-b39e-836a145f67af",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Microsoft Defender for Cloud Servers Scanner Resource Provider",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Agentless VM Scan",
                          "RoleDefinitionId": "d24ecba3-c1f4-40fa-a7bb-4588a071e8fd",
                          "ObjectId": "65d577d2-0846-488c-94ff-5a5b872010f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4133c7e3-7f4f-4ffd-2b41-611644db645e": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4133c7e3-7f4f-4ffd-2b41-611644db645e",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "ebb4952e-6c2b-4a98-b018-349935a41bda",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/461f6cba-3901-40fd-ac9a-405f78c18544": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/461f6cba-3901-40fd-ac9a-405f78c18544",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "ebb4952e-6c2b-4a98-b018-349935a41bda",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/46bf1e92-bc46-4b80-2155-e9605397fef6": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/46bf1e92-bc46-4b80-2155-e9605397fef6",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "ebb4952e-6c2b-4a98-b018-349935a41bda",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/494e0128-5cc6-4ea3-6324-b5edcae2f288": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/494e0128-5cc6-4ea3-6324-b5edcae2f288",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "0e0c4910-eba1-43b4-8dcf-fedf8e56335c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4a867ab9-3429-4c20-cd53-4b57ca137416": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4a867ab9-3429-4c20-cd53-4b57ca137416",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "0b4e17b1-fe4a-44d8-a8c3-b53c0e035da0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4d0da781-0731-48b5-a1f7-0506485e9e1a": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4d0da781-0731-48b5-a1f7-0506485e9e1a",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Microsoft Demos",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "3ba76acc-be40-4508-a9cb-2853c9ef3396",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4e47ae1d-bbb2-4b4e-fe72-907e8f4723fa": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/4e47ae1d-bbb2-4b4e-fe72-907e8f4723fa",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/50a19f74-d4c6-4767-6e9e-7bd277155496": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/50a19f74-d4c6-4767-6e9e-7bd277155496",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Monitoring Contributor",
                          "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                          "ObjectId": "bdb637b4-220c-43e3-8799-de2b19952905",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/57e1ba84-dc5f-4871-b507-27bcf9828377": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/57e1ba84-dc5f-4871-b507-27bcf9828377",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender CSPM Storage Scanner Operator",
                          "RoleDefinitionId": "8480c0f0-4509-4229-9339-7c10018cb8c4",
                          "ObjectId": "5c5bba36-3ed1-4f83-97c9-3cae291e77c5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/5c64fc7e-f8a0-4118-6d4b-24079cb0ee00": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/5c64fc7e-f8a0-4118-6d4b-24079cb0ee00",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "ASC provisioning default LA agent Linux Arc",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "cf96e6be-f825-4d30-9258-7bb0f3c6f655",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/689003c9-9360-4c10-aaf8-6529a59f6143": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/689003c9-9360-4c10-aaf8-6529a59f6143",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Sensitive Data Discovery",
                          "RoleDefinitionId": "0b6ca2e8-2cdc-4bd6-b896-aa3d8c21fc35",
                          "ObjectId": "6dcb3a76-70b1-42aa-87fd-9f2b131a5970",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/6c9cf392-dd1b-486b-1ab8-76acd96c083a": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/6c9cf392-dd1b-486b-1ab8-76acd96c083a",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "ebb4952e-6c2b-4a98-b018-349935a41bda",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/704fc110-0ee7-4860-b72a-c593b1da4579": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/704fc110-0ee7-4860-b72a-c593b1da4579",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "4afd26a4-e9d2-4c33-b153-70bd5362f432",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/72fc4e25-383f-49d2-c1cb-4a326bd8c279": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/72fc4e25-383f-49d2-c1cb-4a326bd8c279",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/730086fd-62af-4320-5ddd-a0c4b1119989": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/730086fd-62af-4320-5ddd-a0c4b1119989",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "0b4e17b1-fe4a-44d8-a8c3-b53c0e035da0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/78e2e816-d75b-4a2f-8214-bfd2dbe0bd5a": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/78e2e816-d75b-4a2f-8214-bfd2dbe0bd5a",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "MCAPSGov-AutomationApp",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "d2d58a6c-d725-401a-944d-19d295b91ed0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/806ad657-760c-48a5-5f9a-4065a3101595": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/806ad657-760c-48a5-5f9a-4065a3101595",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Contributor",
                          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                          "ObjectId": "bdb637b4-220c-43e3-8799-de2b19952905",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/817de0b1-e372-4483-958d-f5ccc85e24de": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/817de0b1-e372-4483-958d-f5ccc85e24de",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Scanner Operator",
                          "RoleDefinitionId": "0f641de8-0b88-4198-bdef-bd8b45ceba96",
                          "ObjectId": "e6c6eb57-dba7-4ff1-a91f-6c7cb9fbf805",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/8b3bd824-2a86-48d4-8d41-327869e3c176": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/8b3bd824-2a86-48d4-8d41-327869e3c176",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "0e0c4910-eba1-43b4-8dcf-fedf8e56335c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/905e1c3c-927d-41de-89ad-769eab1a7da7": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/905e1c3c-927d-41de-89ad-769eab1a7da7",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "5c5bba36-3ed1-4f83-97c9-3cae291e77c5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/984982a0-4677-4724-b199-156fe69f76d0": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/984982a0-4677-4724-b199-156fe69f76d0",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage Blob Data Reader",
                          "RoleDefinitionId": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
                          "ObjectId": "6dcb3a76-70b1-42aa-87fd-9f2b131a5970",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/9c2ee3b9-cc8e-4b52-efc9-db5947e91495": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/9c2ee3b9-cc8e-4b52-efc9-db5947e91495",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "bdb637b4-220c-43e3-8799-de2b19952905",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/a2ed4dd4-0de2-493c-798d-6158e5094bc2": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/a2ed4dd4-0de2-493c-798d-6158e5094bc2",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/a4402890-934d-49d4-ba9e-f3fd81e49292": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/a4402890-934d-49d4-ba9e-f3fd81e49292",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "CDX-SecurityScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "179fdd30-50b7-4d26-8d04-659ff0f09467",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/b262a930-eac8-4a52-b453-6084506a8317": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/b262a930-eac8-4a52-b453-6084506a8317",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "4afd26a4-e9d2-4c33-b153-70bd5362f432",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/b6cd1b15-34b0-4b64-b200-32eced86d283": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/b6cd1b15-34b0-4b64-b200-32eced86d283",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Cloud Infrastructure Entitlement Management",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "499b1a12-a346-48b0-be20-8ac5ecd42c40",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/baf17d13-bdbd-4679-81e8-d2fdca82fa49": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/baf17d13-bdbd-4679-81e8-d2fdca82fa49",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "managedenvironments-ar-tenant-connector",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "40b922de-ef06-430f-a397-a32d3fa5afca",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/be405edf-eb92-45fa-868e-9a7fa9dd60e4": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/be405edf-eb92-45fa-868e-9a7fa9dd60e4",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Managed Identity Operator",
                          "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                          "ObjectId": "50b1f477-5130-4552-b100-e6e77210db45",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/c6740c88-28aa-42f6-c2bd-c77d1b7c9959": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/c6740c88-28aa-42f6-c2bd-c77d1b7c9959",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/c9a330d9-3cda-431b-4d14-fb679162610a": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/c9a330d9-3cda-431b-4d14-fb679162610a",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "0e0c4910-eba1-43b4-8dcf-fedf8e56335c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/cbeb1e55-23cf-4d71-633d-23377922979a": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/cbeb1e55-23cf-4d71-633d-23377922979a",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d30e767f-e568-4c97-f12c-7fd26a9a354f": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d30e767f-e568-4c97-f12c-7fd26a9a354f",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "d1c48665-9bee-4196-9849-ac00ebc87b55",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d5952484-de80-42cc-916c-4473a9e378bd": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d5952484-de80-42cc-916c-4473a9e378bd",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage File Data Privileged Reader",
                          "RoleDefinitionId": "b8eda974-7b85-4f76-af95-65846b26df6d",
                          "ObjectId": "6dcb3a76-70b1-42aa-87fd-9f2b131a5970",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d752a10c-4fb5-4b46-cfe4-1f4c282778ec": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d752a10c-4fb5-4b46-cfe4-1f4c282778ec",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                          "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                          "ObjectId": "bdb637b4-220c-43e3-8799-de2b19952905",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d805b946-b9d3-46f3-9ef6-6f009ed4a928": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/d805b946-b9d3-46f3-9ef6-6f009ed4a928",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/dc0dacd3-7b05-0135-0ac0-63e80d0c1986": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/dc0dacd3-7b05-0135-0ac0-63e80d0c1986",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Owner (alz-mgmt)",
                          "RoleDefinitionId": "f95e05f3-0265-c57d-a9f9-d78015027a11",
                          "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/dcf97380-58b1-4aed-85ee-999157a97c8f": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/dcf97380-58b1-4aed-85ee-999157a97c8f",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "50b1f477-5130-4552-b100-e6e77210db45",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/ddb81fbe-de1e-4cad-e821-92085de8101e": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/ddb81fbe-de1e-4cad-e821-92085de8101e",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "0b4e17b1-fe4a-44d8-a8c3-b53c0e035da0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/df841a24-a205-400e-fa5d-47d337ea5d2e": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/df841a24-a205-400e-fa5d-47d337ea5d2e",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "ASC provisioning default LA agent Windows Arc",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "aaf3926e-2755-4bc3-8158-c8bcae463565",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/e1d8d777-bf9a-4e12-f89a-1035f4dd0d7d": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/e1d8d777-bf9a-4e12-f89a-1035f4dd0d7d",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "0e0c4910-eba1-43b4-8dcf-fedf8e56335c",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/e90a044d-b694-6944-cd47-b8ccf5b1de66": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/e90a044d-b694-6944-cd47-b8ccf5b1de66",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Data Scanner",
                          "RoleDefinitionId": "1e7ca9b1-60d1-4db8-a914-f2ca1ff27c40",
                          "ObjectId": "6dcb3a76-70b1-42aa-87fd-9f2b131a5970",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/ed74817b-90dc-4f3f-3af9-6a903ab9db39": [
                        {
                          "RoleAssignmentId": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc/providers/microsoft.authorization/roleassignments/ed74817b-90dc-4f3f-3af9-6a903ab9db39",
                          "Scope": "/subscriptions/1c083bf3-30ac-4804-aa81-afddc58c78dc",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "0b4e17b1-fe4a-44d8-a8c3-b53c0e035da0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ]
                    },
                    "BlueprintAssignments": {},
                    "DiagnosticSettings": {
                      "subscriptionToLa": {
                        "Name": "subscriptionToLa",
                        "Type": "LA",
                        "TargetId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                        "Settings": [
                          {
                            "Category": "Administrative",
                            "Enabled": true
                          },
                          {
                            "Category": "Security",
                            "Enabled": true
                          },
                          {
                            "Category": "ServiceHealth",
                            "Enabled": true
                          },
                          {
                            "Category": "Alert",
                            "Enabled": true
                          },
                          {
                            "Category": "Recommendation",
                            "Enabled": true
                          },
                          {
                            "Category": "Policy",
                            "Enabled": true
                          },
                          {
                            "Category": "Autoscale",
                            "Enabled": true
                          },
                          {
                            "Category": "ResourceHealth",
                            "Enabled": true
                          }
                        ]
                      }
                    },
                    "ResourceGroups": {}
                  }
                },
                "ManagementGroups": {}
              },
              "management": {
                "MgId": "management",
                "MgName": "Management",
                "mgParentId": "platform",
                "mgParentName": "Platform",
                "level": "3",
                "PolicyDefinitionsCustom": {},
                "PolicySetDefinitionsCustom": {},
                "BlueprintDefinitions": {},
                "PolicyAssignments": {},
                "RoleAssignments": {
                  "/providers/microsoft.management/managementgroups/management/providers/microsoft.authorization/roleassignments/e8cf3269-d502-4360-807a-6f6f081eb204": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/management/providers/microsoft.authorization/roleassignments/e8cf3269-d502-4360-807a-6f6f081eb204",
                      "Scope": "/providers/Microsoft.Management/managementGroups/management",
                      "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                      "SignInName": null,
                      "RoleDefinitionName": "Owner",
                      "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                      "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                },
                "DiagnosticSettings": {},
                "Subscriptions": {
                  "8ff0bc40-d483-4e35-be1d-b49568bd9c5f": {
                    "SubscriptionName": "azr-mge-dev-sub-03",
                    "SubscriptionQuotaId": "Internal_2014-09-01",
                    "SubscriptionState": "Enabled",
                    "SubscriptionTags": [
                      {
                        "Key": "alz-alias",
                        "Value": "management",
                        "Name": "alz-alias"
                      },
                      {
                        "Key": "Division",
                        "Value": "Core",
                        "Name": "Division"
                      },
                      {
                        "Key": "Environment",
                        "Value": "Hybrid",
                        "Name": "Environment"
                      },
                      {
                        "Key": "Purpose",
                        "Value": "UserTenant",
                        "Name": "Purpose"
                      },
                      {
                        "Key": "TimeZone",
                        "Value": "_P10138588_United States_444350001",
                        "Name": "TimeZone"
                      },
                      {
                        "Key": "trn-alias",
                        "Value": "management",
                        "Name": "trn-alias"
                      }
                    ],
                    "PolicyDefinitionsCustom": {},
                    "PolicySetDefinitionsCustom": {},
                    "BlueprintDefinitions": {},
                    "PolicyAssignments": {
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC DataProtection (subscription: 8ff0bc40-d483-4e35-be1d-b49568bd9c5f)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
                          "scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:11:20.1636123Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "DataProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:11:20.1158944Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:11:20.1158944Z"
                        }
                      },
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC OpenSourceRelationalDatabasesProtection (subscription: 8ff0bc40-d483-4e35-be1d-b49568bd9c5f)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
                          "scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:13:05.2383421Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:13:05.0720033Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:13:05.0720033Z"
                        }
                      },
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn": {
                        "properties": {
                          "displayName": "ASC Default (subscription: 8ff0bc40-d483-4e35-be1d-b49568bd9c5f)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
                          "scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "parameters": {},
                          "description": "This is the default set of policies monitored by Azure Security Center. It was automatically assigned as part of onboarding to Security Center. The default assignment contains only audit policies. For more information please visit https://aka.ms/ascpolicies",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "5b78eb55-3d4e-49c7-b443-a90799761640",
                            "createdOn": "2024-07-17T04:00:02.2701513Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SecurityCenterBuiltIn",
                        "systemData": {
                          "createdBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "createdByType": "Application",
                          "createdAt": "2024-07-17T04:00:00.7308405Z",
                          "lastModifiedBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2024-07-17T04:00:00.7308405Z"
                        }
                      },
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection": {
                        "identity": {
                          "principalId": "e3f26cc9-d2d7-4bee-8ceb-d3d8866650e5",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL Servers on Machines provisioning (subscription: 8ff0bc40-d483-4e35-be1d-b49568bd9c5f)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/c1529623-9fc2-45bc-b84b-b14cd0b7484e",
                          "scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "description": "This initiative enables Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "2edb2aec-6497-405f-9b4c-3b489dcf0c45",
                            "createdOn": "2025-11-10T21:04:54.4913874Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SqlVmAndArcSqlServersProtection",
                        "location": "westeurope",
                        "systemData": {
                          "createdBy": "77cef9f1-f194-4ef3-aeb9-5976388f3945",
                          "createdByType": "Application",
                          "createdAt": "2025-11-10T21:04:52.7629202Z",
                          "lastModifiedBy": "77cef9f1-f194-4ef3-aeb9-5976388f3945",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2025-11-10T21:04:52.7629202Z"
                        }
                      }
                    },
                    "RoleAssignments": {
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/167549d5-9df2-4bba-a866-eb1ed7de6620": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/167549d5-9df2-4bba-a866-eb1ed7de6620",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "Microsoft Demos",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "3ba76acc-be40-4508-a9cb-2853c9ef3396",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/2ea7813e-423b-4bd9-9449-41814d5aa5b7": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/2ea7813e-423b-4bd9-9449-41814d5aa5b7",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/30288099-56c4-404c-9e72-2df74e3c8f63": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/30288099-56c4-404c-9e72-2df74e3c8f63",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "e3f26cc9-d2d7-4bee-8ceb-d3d8866650e5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/32e4b8bb-2482-47ae-a3d3-be86a3aea481": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/32e4b8bb-2482-47ae-a3d3-be86a3aea481",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Managed Identity Operator",
                          "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                          "ObjectId": "e3f26cc9-d2d7-4bee-8ceb-d3d8866650e5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/3b9759cc-eb54-4808-98fd-31315564149c": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/3b9759cc-eb54-4808-98fd-31315564149c",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "814ec3b2-8117-4a83-b32c-539ddad6ff38",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/3bc15687-90c4-4a12-9eeb-4578d3d6f91e": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/3bc15687-90c4-4a12-9eeb-4578d3d6f91e",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "Microsoft Defender for Cloud Servers Scanner Resource Provider",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Agentless VM Scan",
                          "RoleDefinitionId": "d24ecba3-c1f4-40fa-a7bb-4588a071e8fd",
                          "ObjectId": "65d577d2-0846-488c-94ff-5a5b872010f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/439b195c-ba2f-412f-a6bd-a37dd6e50afc": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/439b195c-ba2f-412f-a6bd-a37dd6e50afc",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "Cloud Infrastructure Entitlement Management",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "499b1a12-a346-48b0-be20-8ac5ecd42c40",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/449610e3-a79b-4bc2-805e-ea56e6d83ac2": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/449610e3-a79b-4bc2-805e-ea56e6d83ac2",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "EventGrid Contributor",
                          "RoleDefinitionId": "1e241071-0855-49ea-94dc-649edcd759de",
                          "ObjectId": "89807709-e82c-48b3-ab57-e38ab53f965d",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/45ebe77b-f635-40bc-a16b-59e23da221c2": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/45ebe77b-f635-40bc-a16b-59e23da221c2",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "CDX-SecurityScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "179fdd30-50b7-4d26-8d04-659ff0f09467",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/4f44f570-407e-43a0-1a00-066f3a91d842": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/4f44f570-407e-43a0-1a00-066f3a91d842",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Owner (alz-mgmt)",
                          "RoleDefinitionId": "f95e05f3-0265-c57d-a9f9-d78015027a11",
                          "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/5116551b-dc11-4ad9-bc2b-78c0aaf175ee": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/5116551b-dc11-4ad9-bc2b-78c0aaf175ee",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "MCAPSGov-AutomationApp",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "d2d58a6c-d725-401a-944d-19d295b91ed0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/561561ab-f18c-490b-93d4-0254e0bde5fd": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/561561ab-f18c-490b-93d4-0254e0bde5fd",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "managedenvironments-ar-tenant-connector",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "40b922de-ef06-430f-a397-a32d3fa5afca",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/70ca615b-eb53-43ce-8d43-952920c162f6": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/70ca615b-eb53-43ce-8d43-952920c162f6",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "814ec3b2-8117-4a83-b32c-539ddad6ff38",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/7c51f86a-f323-49d4-a6d2-6a496b72bd53": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/7c51f86a-f323-49d4-a6d2-6a496b72bd53",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage File Data Privileged Reader",
                          "RoleDefinitionId": "b8eda974-7b85-4f76-af95-65846b26df6d",
                          "ObjectId": "7407ffd8-70e5-41ca-bead-05f389df7be5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/a515fb93-523d-412e-9b87-bb9f8e0954de": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/a515fb93-523d-412e-9b87-bb9f8e0954de",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/ac709a59-23d6-4eae-b828-d603f1656b52": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/ac709a59-23d6-4eae-b828-d603f1656b52",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "3ef27b2c-117a-472a-b3af-3a787999a245",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/c71a95ef-1f59-6bc8-df62-1181c574d5f3": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/c71a95ef-1f59-6bc8-df62-1181c574d5f3",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Data Scanner",
                          "RoleDefinitionId": "1e7ca9b1-60d1-4db8-a914-f2ca1ff27c40",
                          "ObjectId": "7407ffd8-70e5-41ca-bead-05f389df7be5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/d06e3aed-3d9c-069c-403d-c7e678d8d254": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/d06e3aed-3d9c-069c-403d-c7e678d8d254",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "id-alz-mgmt-eastus2-plan-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Reader (alz-mgmt)",
                          "RoleDefinitionId": "89737a5a-a182-3c5a-849f-aafd11be99ff",
                          "ObjectId": "8083fb27-b991-474f-b1e6-c2a8e20fcb25",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/d88bce41-0686-49b0-8b9b-78223a118ee1": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/d88bce41-0686-49b0-8b9b-78223a118ee1",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage Blob Data Reader",
                          "RoleDefinitionId": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
                          "ObjectId": "7407ffd8-70e5-41ca-bead-05f389df7be5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/e76ba9c5-3b8a-4f72-9230-52dfaa1be089": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/e76ba9c5-3b8a-4f72-9230-52dfaa1be089",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Scanner Operator",
                          "RoleDefinitionId": "0f641de8-0b88-4198-bdef-bd8b45ceba96",
                          "ObjectId": "89807709-e82c-48b3-ab57-e38ab53f965d",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/eb7f63da-7fa1-45f6-80a3-156f5fb2a25b": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/eb7f63da-7fa1-45f6-80a3-156f5fb2a25b",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Sensitive Data Discovery",
                          "RoleDefinitionId": "0b6ca2e8-2cdc-4bd6-b896-aa3d8c21fc35",
                          "ObjectId": "7407ffd8-70e5-41ca-bead-05f389df7be5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/f15ee650-4f92-4d3f-95e6-49311d985f66": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/f15ee650-4f92-4d3f-95e6-49311d985f66",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "e3f26cc9-d2d7-4bee-8ceb-d3d8866650e5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/f9e885c5-5937-4a11-8605-df2426c0f1a9": [
                        {
                          "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/providers/microsoft.authorization/roleassignments/f9e885c5-5937-4a11-8605-df2426c0f1a9",
                          "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender CSPM Storage Scanner Operator",
                          "RoleDefinitionId": "8480c0f0-4509-4229-9339-7c10018cb8c4",
                          "ObjectId": "3ef27b2c-117a-472a-b3af-3a787999a245",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ]
                    },
                    "BlueprintAssignments": {},
                    "DiagnosticSettings": {
                      "subscriptionToLa": {
                        "Name": "subscriptionToLa",
                        "Type": "LA",
                        "TargetId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                        "Settings": [
                          {
                            "Category": "Administrative",
                            "Enabled": true
                          },
                          {
                            "Category": "Security",
                            "Enabled": true
                          },
                          {
                            "Category": "ServiceHealth",
                            "Enabled": true
                          },
                          {
                            "Category": "Alert",
                            "Enabled": true
                          },
                          {
                            "Category": "Recommendation",
                            "Enabled": true
                          },
                          {
                            "Category": "Policy",
                            "Enabled": true
                          },
                          {
                            "Category": "Autoscale",
                            "Enabled": true
                          },
                          {
                            "Category": "ResourceHealth",
                            "Enabled": true
                          }
                        ]
                      }
                    },
                    "ResourceGroups": {
                      "alz-mgmt": {
                        "Resources": {
                          "microsoft.insights-datacollectionrules_alz-dcr-vm-insights": {
                            "RoleAssignments": {
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/05f8058e-a969-5019-a458-f993c1b50b47": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/05f8058e-a969-5019-a458-f993c1b50b47",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VMSS-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/20f9407a-ecb4-5232-a05a-a17a9b8b279f": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/20f9407a-ecb4-5232-a05a-a17a9b8b279f",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VM-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/4b91d7ed-5622-5a28-bac9-5d637ed7343e": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/4b91d7ed-5622-5a28-bac9-5d637ed7343e",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VM-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "81b00aeb-4e32-4c27-b3db-05d69d83e58b",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/4de9a622-3187-5672-8d77-10eac4c90580": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/4de9a622-3187-5672-8d77-10eac4c90580",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VM-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/577bb43a-c660-5d60-9935-8bcce12db49a": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/577bb43a-c660-5d60-9935-8bcce12db49a",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VMSS-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/7ceaa443-e9cd-57be-823c-8a33a87eb101": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/7ceaa443-e9cd-57be-823c-8a33a87eb101",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VM-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "f630e0cd-1258-40fb-a837-8c42696b6efd",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/8a86ebba-59f7-55ee-9308-af5620cc4ec7": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/8a86ebba-59f7-55ee-9308-af5620cc4ec7",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-vmHybr-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "7d21f057-956c-43e8-9076-507ca45fb4d8",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/a20c3838-ac5e-5518-aad4-7c72985d128a": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/a20c3838-ac5e-5518-aad4-7c72985d128a",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VMSS-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "080618cd-73bd-4eb3-b022-2e7c2df530b4",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/d5c19b56-56ab-5ee7-b356-d09e78304263": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/d5c19b56-56ab-5ee7-b356-d09e78304263",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-vmHybr-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "d24e793f-c3f8-495a-8573-cc7d4eb413e3",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/e843961c-ee73-5df9-bfe0-2d178444119a": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/e843961c-ee73-5df9-bfe0-2d178444119a",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-VMSS-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "e3ac9c21-008c-40d9-8758-7b3e699a5add",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/eb3cca59-a234-5216-92b8-f1592657ed3c": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/eb3cca59-a234-5216-92b8-f1592657ed3c",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-vmHybr-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "d24e793f-c3f8-495a-8573-cc7d4eb413e3",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/f49bfa78-8ffd-5b9f-aed3-f545e5746030": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.insights/datacollectionrules/alz-dcr-vm-insights/providers/microsoft.authorization/roleassignments/f49bfa78-8ffd-5b9f-aed3-f545e5746030",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.Insights/dataCollectionRules/alz-dcr-vm-insights",
                                  "DisplayName": "Deploy-vmHybr-Monitoring",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "7d21f057-956c-43e8-9076-507ca45fb4d8",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          },
                          "microsoft.operationalinsights-workspaces_alz-law": {
                            "RoleAssignments": {
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/024bf760-4557-5bfd-b4ae-e8fe06540809": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/024bf760-4557-5bfd-b4ae-e8fe06540809",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-AzSqlDb-Auditing",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "32ba4a2b-8a18-4bae-81f4-04f5323b950d",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/7ddbcab3-fa78-5569-b72d-d7e2043cebf0": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/7ddbcab3-fa78-5569-b72d-d7e2043cebf0",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-AzSqlDb-Auditing",
                                  "SignInName": null,
                                  "RoleDefinitionName": "SQL Security Manager",
                                  "RoleDefinitionId": "056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                                  "ObjectId": "32ba4a2b-8a18-4bae-81f4-04f5323b950d",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/9711ba84-7f7b-5123-9728-abfadf38aa39": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/9711ba84-7f7b-5123-9728-abfadf38aa39",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-AzActivity-Log",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Monitoring Contributor",
                                  "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                                  "ObjectId": "64a5556e-e809-46ca-98ad-41a4aeef802f",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/ac4ebe52-2e07-5b53-ad78-a283192d2281": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/ac4ebe52-2e07-5b53-ad78-a283192d2281",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-MDFC-Config-H224",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Defender Containers Sensor",
                                  "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                                  "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/dcfece09-f994-52ff-a19b-5594aa09eb96": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/dcfece09-f994-52ff-a19b-5594aa09eb96",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-Diag-LogsCat",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "f49137a2-3586-48ed-b5ec-28f2b3ea8f8b",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/de03c9dd-c69c-59d4-93d0-196a43a0c0d2": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/de03c9dd-c69c-59d4-93d0-196a43a0c0d2",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-MDFC-Config-H224",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Contributor",
                                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                                  "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/f39cab4c-2d71-5118-919c-43bfbefb17fb": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/f39cab4c-2d71-5118-919c-43bfbefb17fb",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-AzActivity-Log",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Log Analytics Contributor",
                                  "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                                  "ObjectId": "64a5556e-e809-46ca-98ad-41a4aeef802f",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/f7f93c0f-6dcf-597c-af60-df629d9a9480": [
                                {
                                  "RoleAssignmentId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/microsoft.operationalinsights/workspaces/alz-law/providers/microsoft.authorization/roleassignments/f7f93c0f-6dcf-597c-af60-df629d9a9480",
                                  "Scope": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourceGroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                                  "DisplayName": "Deploy-MDFC-Config-H224",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                                  "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                                  "ObjectId": "f44fb9d8-b77d-4dd3-bc10-3cf07f7486db",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "ManagementGroups": {}
              },
              "security": {
                "MgId": "security",
                "MgName": "Security",
                "mgParentId": "platform",
                "mgParentName": "Platform",
                "level": "3",
                "PolicyDefinitionsCustom": {},
                "PolicySetDefinitionsCustom": {},
                "BlueprintDefinitions": {},
                "PolicyAssignments": {},
                "RoleAssignments": {
                  "/providers/microsoft.management/managementgroups/security/providers/microsoft.authorization/roleassignments/c12f80e8-cc49-4a3b-ba08-878aa8ccaff1": [
                    {
                      "RoleAssignmentId": "/providers/microsoft.management/managementgroups/security/providers/microsoft.authorization/roleassignments/c12f80e8-cc49-4a3b-ba08-878aa8ccaff1",
                      "Scope": "/providers/Microsoft.Management/managementGroups/security",
                      "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                      "SignInName": null,
                      "RoleDefinitionName": "Owner",
                      "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                      "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                },
                "DiagnosticSettings": {},
                "Subscriptions": {
                  "dee9fea3-65b6-45ad-8b44-f38b05c31fa9": {
                    "SubscriptionName": "azr-mge-dev-sub-05",
                    "SubscriptionQuotaId": "Internal_2014-09-01",
                    "SubscriptionState": "Enabled",
                    "SubscriptionTags": [
                      {
                        "Key": "alz-alias",
                        "Value": "online",
                        "Name": "alz-alias"
                      },
                      {
                        "Key": "Division",
                        "Value": "Core",
                        "Name": "Division"
                      },
                      {
                        "Key": "dvc-environment",
                        "Value": "dev",
                        "Name": "dvc-environment"
                      },
                      {
                        "Key": "Environment",
                        "Value": "Hybrid",
                        "Name": "Environment"
                      },
                      {
                        "Key": "Purpose",
                        "Value": "UserTenant",
                        "Name": "Purpose"
                      },
                      {
                        "Key": "TimeZone",
                        "Value": "_P10138588_United States_444350001",
                        "Name": "TimeZone"
                      }
                    ],
                    "PolicyDefinitionsCustom": {},
                    "PolicySetDefinitionsCustom": {},
                    "BlueprintDefinitions": {},
                    "PolicyAssignments": {
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC DataProtection (subscription: dee9fea3-65b6-45ad-8b44-f38b05c31fa9)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:03:23.0442146Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "DataProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:03:22.8783775Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:03:22.8783775Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning AKS Security Profile": {
                        "identity": {
                          "principalId": "4ecad9be-15a3-4b6a-b243-ce7eecfbeb06",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning AKS Security Profile",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:03:44.3029004Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:06:16.0382656Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning AKS Security Profile",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning AKS Security Profile",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:03:43.7404905Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:06:15.8381896Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning ARC k8s Enabled": {
                        "identity": {
                          "principalId": "11918318-515f-4faf-849d-2f5c1ed854da",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/708b60a6-d253-4fe0-9114-4be4c00f012c",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:03:44.2047623Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:06:16.0760664Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning ARC k8s Enabled",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning ARC k8s Enabled",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:03:43.726879Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:06:15.7913168Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Azure Policy Addon for Kub": {
                        "identity": {
                          "principalId": "4629a3ff-7cba-4ead-a172-2dc0f1ef2581",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:03:44.1719438Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:06:15.9808272Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Azure Policy Addon for Kub",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning Azure Policy Addon for Kub",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:03:43.7611843Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:06:15.7593468Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Policy extension for Arc-e": {
                        "identity": {
                          "principalId": "502b865f-8c99-4e6b-aa57-12c48ddf64c9",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0adc5395-9169-4b9b-8687-af838d69410a",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:03:44.1866181Z",
                            "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "updatedOn": "2024-08-13T16:06:16.0002433Z"
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for Containers provisioning Policy extension for Arc-e",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for Containers provisioning Policy extension for Arc-e",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:03:43.6672674Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:06:15.7611045Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for SQL on SQL VMs and Arc-enabled SQL Servers": {
                        "identity": {
                          "principalId": "7164a0fa-ff9a-43b9-9b63-8dc8e1003b50",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/d7c3ea3a-edf3-4bd5-bd64-d5b635b05393",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "parameters": {},
                          "description": "This policy assignment was automatically created by Microsoft Defender for Cloud for agent installation as configured in Defender for Cloud auto provisioning.",
                          "metadata": {
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:06:17.179824Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                        "location": "centralus",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:06:16.526899Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:06:16.526899Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter": {
                        "properties": {
                          "displayName": "ASC OpenSourceRelationalDatabasesProtection (subscription: dee9fea3-65b6-45ad-8b44-f38b05c31fa9)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "description": "This policy assignment was automatically created by Azure Security Center",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                            "createdOn": "2024-08-13T16:03:26.8481953Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "OpenSourceRelationalDatabasesProtectionSecurityCenter",
                        "systemData": {
                          "createdBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "createdByType": "User",
                          "createdAt": "2024-08-13T16:03:26.8271177Z",
                          "lastModifiedBy": "admin@MngEnvMCAP799126.onmicrosoft.com",
                          "lastModifiedByType": "User",
                          "lastModifiedAt": "2024-08-13T16:03:26.8271177Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn": {
                        "properties": {
                          "displayName": "ASC Default (subscription: dee9fea3-65b6-45ad-8b44-f38b05c31fa9)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "parameters": {},
                          "description": "This is the default set of policies monitored by Azure Security Center. It was automatically assigned as part of onboarding to Security Center. The default assignment contains only audit policies. For more information please visit https://aka.ms/ascpolicies",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "5b78eb55-3d4e-49c7-b443-a90799761640",
                            "createdOn": "2024-07-17T04:00:02.3086769Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SecurityCenterBuiltIn",
                        "systemData": {
                          "createdBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "createdByType": "Application",
                          "createdAt": "2024-07-17T04:00:01.3726764Z",
                          "lastModifiedBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2024-07-17T04:00:01.3726764Z"
                        }
                      },
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection": {
                        "identity": {
                          "principalId": "bf4d9bb1-d0b6-44e6-bab5-78909cdae0c0",
                          "tenantId": "54d665dd-30f1-45c5-a8d5-d6ffcdb518f9",
                          "type": "SystemAssigned"
                        },
                        "properties": {
                          "displayName": "Defender for SQL Servers on Machines provisioning (subscription: dee9fea3-65b6-45ad-8b44-f38b05c31fa9)",
                          "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/c1529623-9fc2-45bc-b84b-b14cd0b7484e",
                          "scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "description": "This initiative enables Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "metadata": {
                            "assignedBy": "Security Center",
                            "createdBy": "418d18ef-f39e-4f09-bd16-6c9c69f87bef",
                            "createdOn": "2025-10-01T18:06:50.2059669Z",
                            "updatedBy": null,
                            "updatedOn": null
                          },
                          "enforcementMode": "Default"
                        },
                        "id": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/Microsoft.Authorization/policyAssignments/SqlVmAndArcSqlServersProtection",
                        "type": "Microsoft.Authorization/policyAssignments",
                        "name": "SqlVmAndArcSqlServersProtection",
                        "location": "westeurope",
                        "systemData": {
                          "createdBy": "9c3c7f83-9a52-4995-aa6e-3e29a8cb9255",
                          "createdByType": "Application",
                          "createdAt": "2025-10-01T18:06:49.3476283Z",
                          "lastModifiedBy": "9c3c7f83-9a52-4995-aa6e-3e29a8cb9255",
                          "lastModifiedByType": "Application",
                          "lastModifiedAt": "2025-10-01T18:06:49.3476283Z"
                        }
                      }
                    },
                    "RoleAssignments": {
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/04464ae0-e3e0-4b52-a705-1fcb177c52af": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/04464ae0-e3e0-4b52-a705-1fcb177c52af",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "11918318-515f-4faf-849d-2f5c1ed854da",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/181d00fc-f350-45db-d0b7-c29a6f683a49": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/181d00fc-f350-45db-d0b7-c29a6f683a49",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "502b865f-8c99-4e6b-aa57-12c48ddf64c9",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/1885879d-55dd-4027-b223-3047373346ea": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/1885879d-55dd-4027-b223-3047373346ea",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Microsoft Defender for Cloud Servers Scanner Resource Provider",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Agentless VM Scan",
                          "RoleDefinitionId": "d24ecba3-c1f4-40fa-a7bb-4588a071e8fd",
                          "ObjectId": "65d577d2-0846-488c-94ff-5a5b872010f2",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/213bdbb7-7af6-4040-a203-b488de859d4b": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/213bdbb7-7af6-4040-a203-b488de859d4b",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Connected Machine Resource Administrator",
                          "RoleDefinitionId": "cd570a14-e51a-42ad-bac8-bafd67325302",
                          "ObjectId": "7164a0fa-ff9a-43b9-9b63-8dc8e1003b50",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/256b04e8-9c6b-414b-ff74-38e53a24d943": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/256b04e8-9c6b-414b-ff74-38e53a24d943",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "502b865f-8c99-4e6b-aa57-12c48ddf64c9",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/283c15ea-54cd-4ff4-138d-d4d7d26bd86f": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/283c15ea-54cd-4ff4-138d-d4d7d26bd86f",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "4ecad9be-15a3-4b6a-b243-ce7eecfbeb06",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/2d005075-8101-b561-a2c1-6399730db69b": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/2d005075-8101-b561-a2c1-6399730db69b",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "id-alz-mgmt-eastus2-plan-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Reader (alz-mgmt)",
                          "RoleDefinitionId": "89737a5a-a182-3c5a-849f-aafd11be99ff",
                          "ObjectId": "8083fb27-b991-474f-b1e6-c2a8e20fcb25",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/307fdc58-e566-4e34-8c76-a1038dc6b61e": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/307fdc58-e566-4e34-8c76-a1038dc6b61e",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Managed Identity Operator",
                          "RoleDefinitionId": "f1a07417-d97a-45cb-824c-7a7467783830",
                          "ObjectId": "bf4d9bb1-d0b6-44e6-bab5-78909cdae0c0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/341f84d4-90cd-4994-83f2-f112cbcae846": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/341f84d4-90cd-4994-83f2-f112cbcae846",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "managedenvironments-ar-tenant-connector",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "40b922de-ef06-430f-a397-a32d3fa5afca",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/357bb4b3-7475-405e-1d44-1117206ceca7": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/357bb4b3-7475-405e-1d44-1117206ceca7",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "4629a3ff-7cba-4ead-a172-2dc0f1ef2581",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/51cf117c-77ac-45fe-cb15-b6b20bacb23f": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/51cf117c-77ac-45fe-cb15-b6b20bacb23f",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "4ecad9be-15a3-4b6a-b243-ce7eecfbeb06",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/59a61164-b9f3-4ba5-9a06-591aabe86931": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/59a61164-b9f3-4ba5-9a06-591aabe86931",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "4629a3ff-7cba-4ead-a172-2dc0f1ef2581",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/5b4fd1c8-98db-4fd8-f3d1-01eb11256135": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/5b4fd1c8-98db-4fd8-f3d1-01eb11256135",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Monitoring Contributor",
                          "RoleDefinitionId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                          "ObjectId": "7164a0fa-ff9a-43b9-9b63-8dc8e1003b50",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/6462fcb3-c462-4f81-7428-08a6a30f68ae": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/6462fcb3-c462-4f81-7428-08a6a30f68ae",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "11918318-515f-4faf-849d-2f5c1ed854da",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/69fd90db-63c4-4c2e-8080-6e3602124136": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/69fd90db-63c4-4c2e-8080-6e3602124136",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage Blob Data Reader",
                          "RoleDefinitionId": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
                          "ObjectId": "e8c13c93-9dc3-478d-a77a-844d4244685a",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/72c4f84c-9cbb-415e-0c2a-c62a83f9a75d": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/72c4f84c-9cbb-415e-0c2a-c62a83f9a75d",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "502b865f-8c99-4e6b-aa57-12c48ddf64c9",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/79866c1b-788a-4b72-81eb-7f11ffbd436b": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/79866c1b-788a-4b72-81eb-7f11ffbd436b",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/7a6343a9-d312-490f-11bb-0652e037b7ce": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/7a6343a9-d312-490f-11bb-0652e037b7ce",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "4629a3ff-7cba-4ead-a172-2dc0f1ef2581",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/7bf88495-5a19-48ae-4c62-c74222cce460": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/7bf88495-5a19-48ae-4c62-c74222cce460",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "4629a3ff-7cba-4ead-a172-2dc0f1ef2581",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/7c7865d4-9bb5-4ac8-9819-f43db4660a08": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/7c7865d4-9bb5-4ac8-9819-f43db4660a08",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Containers Sensor",
                          "RoleDefinitionId": "5e93ba01-8f92-4c7a-b12a-801e3df23824",
                          "ObjectId": "e4ef779f-31f6-49a8-b073-8fb49830cab5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/936949b9-e576-4dfd-90a3-d93308cff072": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/936949b9-e576-4dfd-90a3-d93308cff072",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Sensitive Data Discovery",
                          "RoleDefinitionId": "0b6ca2e8-2cdc-4bd6-b896-aa3d8c21fc35",
                          "ObjectId": "e8c13c93-9dc3-478d-a77a-844d4244685a",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/9ad83d42-e671-4886-8f97-050b0ab60f6d": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/9ad83d42-e671-4886-8f97-050b0ab60f6d",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "bf4d9bb1-d0b6-44e6-bab5-78909cdae0c0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/9b6a6cfd-c6af-460b-e2f5-f4ebe9e8b555": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/9b6a6cfd-c6af-460b-e2f5-f4ebe9e8b555",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "502b865f-8c99-4e6b-aa57-12c48ddf64c9",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/af657c72-f7bf-45f0-89b8-ab720b26e625": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/af657c72-f7bf-45f0-89b8-ab720b26e625",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": null,
                          "SignInName": null,
                          "RoleDefinitionName": "Contributor",
                          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                          "ObjectId": "e2cc3383-ddef-4691-be5e-32afc7a5eb58",
                          "ObjectType": "Unknown",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/b7a0d167-3e37-46fe-99b2-fd85a21e9dc0": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/b7a0d167-3e37-46fe-99b2-fd85a21e9dc0",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Kubernetes Extension Contributor",
                          "RoleDefinitionId": "85cb6faf-e071-4c9b-8136-154b5a04f717",
                          "ObjectId": "11918318-515f-4faf-849d-2f5c1ed854da",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/b9369b64-0efd-4f06-bc9f-571a300bcd1c": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/b9369b64-0efd-4f06-bc9f-571a300bcd1c",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "EventGrid Contributor",
                          "RoleDefinitionId": "1e241071-0855-49ea-94dc-649edcd759de",
                          "ObjectId": "07542a4c-708b-452b-8157-af073e42f8e0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ba61cc3a-b02b-430b-4cba-bad3f92ea31a": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ba61cc3a-b02b-430b-4cba-bad3f92ea31a",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "4ecad9be-15a3-4b6a-b243-ce7eecfbeb06",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/c66fc1fd-e6d9-4245-b8ca-42077be88ea4": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/c66fc1fd-e6d9-4245-b8ca-42077be88ea4",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "System Administrator",
                          "SignInName": "autocloudarc@autocloudarc.dev",
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                          "ObjectType": "User",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/c7e1a7d6-1134-4bb5-6b09-ecdc41281966": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/c7e1a7d6-1134-4bb5-6b09-ecdc41281966",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "4ecad9be-15a3-4b6a-b243-ce7eecfbeb06",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/c92f3313-b706-4e62-b691-461d5bc58bf6": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/c92f3313-b706-4e62-b691-461d5bc58bf6",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "6af7d5c7-01e7-4ccc-86c4-1f426747ea47",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/cd48eaf6-c301-4be1-b43b-c2c76b34f33d": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/cd48eaf6-c301-4be1-b43b-c2c76b34f33d",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Containers/securityOperators/DefenderForContainersSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes API Access",
                          "RoleDefinitionId": "d5a2ae44-610b-4500-93be-660a0c5f5ca6",
                          "ObjectId": "e4ef779f-31f6-49a8-b073-8fb49830cab5",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/cf0f42e0-cdcb-46b4-ddc1-10a0ea25565c": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/cf0f42e0-cdcb-46b4-ddc1-10a0ea25565c",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning AKS Security Profile",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "4ecad9be-15a3-4b6a-b243-ce7eecfbeb06",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/cfcc2cf4-5526-4a62-973e-9701a6941834": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/cfcc2cf4-5526-4a62-973e-9701a6941834",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": null,
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "0bdff719-ed75-4ad2-9d42-abdaaa21548f",
                          "ObjectType": "Unknown",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d28b9f60-3c52-4ed7-91ee-9fceee051a56": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d28b9f60-3c52-4ed7-91ee-9fceee051a56",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Kubernetes Service Contributor Role",
                          "RoleDefinitionId": "ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                          "ObjectId": "11918318-515f-4faf-849d-2f5c1ed854da",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d4084d09-9c85-49b9-977e-914c2fa556a6": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d4084d09-9c85-49b9-977e-914c2fa556a6",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Storage File Data Privileged Reader",
                          "RoleDefinitionId": "b8eda974-7b85-4f76-af95-65846b26df6d",
                          "ObjectId": "e8c13c93-9dc3-478d-a77a-844d4244685a",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d7a2d351-bb26-46c3-b956-7357bc464cc5": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d7a2d351-bb26-46c3-b956-7357bc464cc5",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "CloudPosture/securityOperators/DefenderCSPMSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender CSPM Storage Scanner Operator",
                          "RoleDefinitionId": "8480c0f0-4509-4229-9339-7c10018cb8c4",
                          "ObjectId": "6af7d5c7-01e7-4ccc-86c4-1f426747ea47",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d8ced57f-e52b-41aa-a6ad-a0113c25f5f4": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d8ced57f-e52b-41aa-a6ad-a0113c25f5f4",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "CDX-SecurityScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "179fdd30-50b7-4d26-8d04-659ff0f09467",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d96dd2c4-af83-4634-dc80-c3236a2fd8ac": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d96dd2c4-af83-4634-dc80-c3236a2fd8ac",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning ARC k8s Enabled",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "11918318-515f-4faf-849d-2f5c1ed854da",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d9a3f835-1325-4d45-b177-a00ff7e374ac": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/d9a3f835-1325-4d45-b177-a00ff7e374ac",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Policy extension for Arc-e",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "502b865f-8c99-4e6b-aa57-12c48ddf64c9",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/db3d2cf0-0b34-47fe-7e44-a053b3f2dd62": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/db3d2cf0-0b34-47fe-7e44-a053b3f2dd62",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "7164a0fa-ff9a-43b9-9b63-8dc8e1003b50",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ddf913a1-0a23-456a-a8ce-8ff912669b9c": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ddf913a1-0a23-456a-a8ce-8ff912669b9c",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "autocloudarc-mcaps-tfm-iac-acr-67b259d1-9128-472a-9d9e-9ae8d41ae32c",
                          "SignInName": null,
                          "RoleDefinitionName": "Contributor",
                          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                          "ObjectId": "e11b2103-82f1-4ae1-817b-6ca44e302b64",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/def64692-5119-46e9-bf10-4e857954a210": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/def64692-5119-46e9-bf10-4e857954a210",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Microsoft Demos",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "3ba76acc-be40-4508-a9cb-2853c9ef3396",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/e633d463-c419-497c-8c90-26428c8695cf": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/e633d463-c419-497c-8c90-26428c8695cf",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Cloud Infrastructure Entitlement Management",
                          "SignInName": null,
                          "RoleDefinitionName": "Reader",
                          "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
                          "ObjectId": "499b1a12-a346-48b0-be20-8ac5ecd42c40",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/e6549fad-b0fd-4881-669d-3fab76c98617": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/e6549fad-b0fd-4881-669d-3fab76c98617",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Virtual Machine Contributor",
                          "RoleDefinitionId": "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                          "ObjectId": "7164a0fa-ff9a-43b9-9b63-8dc8e1003b50",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/e8725023-3c34-43e7-b991-a51cd3017cf5": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/e8725023-3c34-43e7-b991-a51cd3017cf5",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "MCAPSGov-AutomationApp",
                          "SignInName": null,
                          "RoleDefinitionName": "Owner",
                          "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                          "ObjectId": "d2d58a6c-d725-401a-944d-19d295b91ed0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ec983c62-54f7-49fc-3473-83ddb41139e9": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ec983c62-54f7-49fc-3473-83ddb41139e9",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for Containers provisioning Azure Policy Addon for Kub",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender Kubernetes Agent Operator",
                          "RoleDefinitionId": "8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
                          "ObjectId": "4629a3ff-7cba-4ead-a172-2dc0f1ef2581",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/f6b5348f-7d00-4db0-a1bb-d854d5dbc6db": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/f6b5348f-7d00-4db0-a1bb-d854d5dbc6db",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
                          "SignInName": null,
                          "RoleDefinitionName": "Contributor",
                          "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                          "ObjectId": "7164a0fa-ff9a-43b9-9b63-8dc8e1003b50",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/f9112585-d5bc-445d-8445-780ebe37c615": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/f9112585-d5bc-445d-8445-780ebe37c615",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "SqlVmAndArcSqlServersProtection",
                          "SignInName": null,
                          "RoleDefinitionName": "Log Analytics Contributor",
                          "RoleDefinitionId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                          "ObjectId": "bf4d9bb1-d0b6-44e6-bab5-78909cdae0c0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/f921ae2f-dbf7-ada9-e145-e588ce151be1": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/f921ae2f-dbf7-ada9-e145-e588ce151be1",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                          "SignInName": null,
                          "RoleDefinitionName": "Azure Landing Zones Subscription Owner (alz-mgmt)",
                          "RoleDefinitionId": "f95e05f3-0265-c57d-a9f9-d78015027a11",
                          "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/fc9ff0a9-418c-fea1-d06b-aa1820e49b01": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/fc9ff0a9-418c-fea1-d06b-aa1820e49b01",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "storageDataScanner",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Data Scanner",
                          "RoleDefinitionId": "1e7ca9b1-60d1-4db8-a914-f2ca1ff27c40",
                          "ObjectId": "e8c13c93-9dc3-478d-a77a-844d4244685a",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ],
                      "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ff66b6e8-9673-46d0-bc7d-84ca8c108a78": [
                        {
                          "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/providers/microsoft.authorization/roleassignments/ff66b6e8-9673-46d0-bc7d-84ca8c108a78",
                          "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9",
                          "DisplayName": "StorageAccounts/securityOperators/DefenderForStorageSecurityOperator",
                          "SignInName": null,
                          "RoleDefinitionName": "Defender for Storage Scanner Operator",
                          "RoleDefinitionId": "0f641de8-0b88-4198-bdef-bd8b45ceba96",
                          "ObjectId": "07542a4c-708b-452b-8157-af073e42f8e0",
                          "ObjectType": "ServicePrincipal",
                          "PIM": "false"
                        }
                      ]
                    },
                    "BlueprintAssignments": {},
                    "DiagnosticSettings": {
                      "subscriptionToLa": {
                        "Name": "subscriptionToLa",
                        "Type": "LA",
                        "TargetId": "/subscriptions/8ff0bc40-d483-4e35-be1d-b49568bd9c5f/resourcegroups/alz-mgmt/providers/Microsoft.OperationalInsights/workspaces/alz-law",
                        "Settings": [
                          {
                            "Category": "Administrative",
                            "Enabled": true
                          },
                          {
                            "Category": "Security",
                            "Enabled": true
                          },
                          {
                            "Category": "ServiceHealth",
                            "Enabled": true
                          },
                          {
                            "Category": "Alert",
                            "Enabled": true
                          },
                          {
                            "Category": "Recommendation",
                            "Enabled": true
                          },
                          {
                            "Category": "Policy",
                            "Enabled": true
                          },
                          {
                            "Category": "Autoscale",
                            "Enabled": true
                          },
                          {
                            "Category": "ResourceHealth",
                            "Enabled": true
                          }
                        ]
                      }
                    },
                    "ResourceGroups": {
                      "rg-ops-tier-dev": {
                        "Resources": {
                          "microsoft.keyvault-vaults_kv-subvending-001": {
                            "RoleAssignments": {
                              "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/resourcegroups/rg-ops-tier-dev/providers/microsoft.keyvault/vaults/kv-subvending-001/providers/microsoft.authorization/roleassignments/056da49e-23f4-45b7-a7d3-653328e07236": [
                                {
                                  "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/resourcegroups/rg-ops-tier-dev/providers/microsoft.keyvault/vaults/kv-subvending-001/providers/microsoft.authorization/roleassignments/056da49e-23f4-45b7-a7d3-653328e07236",
                                  "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/resourceGroups/rg-ops-tier-dev/providers/Microsoft.KeyVault/vaults/kv-subvending-001",
                                  "DisplayName": "System Administrator",
                                  "SignInName": "autocloudarc@autocloudarc.dev",
                                  "RoleDefinitionName": "Key Vault Administrator",
                                  "RoleDefinitionId": "00482a5a-887f-4fb3-b363-3b7fe8e74483",
                                  "ObjectId": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
                                  "ObjectType": "User",
                                  "PIM": "false"
                                }
                              ],
                              "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/resourcegroups/rg-ops-tier-dev/providers/microsoft.keyvault/vaults/kv-subvending-001/providers/microsoft.authorization/roleassignments/3454c92d-7936-46d0-adca-ca3922371c02": [
                                {
                                  "RoleAssignmentId": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/resourcegroups/rg-ops-tier-dev/providers/microsoft.keyvault/vaults/kv-subvending-001/providers/microsoft.authorization/roleassignments/3454c92d-7936-46d0-adca-ca3922371c02",
                                  "Scope": "/subscriptions/dee9fea3-65b6-45ad-8b44-f38b05c31fa9/resourceGroups/rg-ops-tier-dev/providers/Microsoft.KeyVault/vaults/kv-subvending-001",
                                  "DisplayName": "data-ops-01",
                                  "SignInName": null,
                                  "RoleDefinitionName": "Key Vault Secrets User",
                                  "RoleDefinitionId": "4633458b-17de-408a-b874-0445c86b69e6",
                                  "ObjectId": "2fd04b2e-beea-4aec-a93a-9015e5582f56",
                                  "ObjectType": "ServicePrincipal",
                                  "PIM": "false"
                                }
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "ManagementGroups": {}
              }
            }
          },
          "sandbox": {
            "MgId": "sandbox",
            "MgName": "Sandbox",
            "mgParentId": "alz",
            "mgParentName": "Azure Landing Zones",
            "level": "2",
            "PolicyDefinitionsCustom": {},
            "PolicySetDefinitionsCustom": {},
            "BlueprintDefinitions": {},
            "PolicyAssignments": {
              "/providers/Microsoft.Management/managementGroups/sandbox/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox": {
                "identity": {
                  "type": "None"
                },
                "properties": {
                  "displayName": "Enforce ALZ Sandbox Guardrails",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
                  "scope": "/providers/Microsoft.Management/managementGroups/sandbox",
                  "notScopes": [],
                  "parameters": {
                    "listOfResourceTypesNotAllowed": {
                      "value": [
                        "microsoft.network/expressroutecircuits",
                        "microsoft.network/expressroutegateways",
                        "microsoft.network/expressrouteports",
                        "microsoft.network/virtualwans",
                        "microsoft.network/virtualhubs",
                        "microsoft.network/vpngateways",
                        "microsoft.network/p2svpngateways",
                        "microsoft.network/vpnsites",
                        "microsoft.network/virtualnetworkgateways"
                      ]
                    }
                  },
                  "description": "This initiative will help enforce and govern subscriptions that are placed within the Sandbox Management Group. See https://aka.ms/alz/policies for more information.",
                  "metadata": {
                    "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                    "createdOn": "2026-01-21T00:37:29.8458569Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default",
                  "nonComplianceMessages": [
                    {
                      "message": "ALZ Sandbox Guardrails must be enforced."
                    }
                  ]
                },
                "id": "/providers/Microsoft.Management/managementGroups/sandbox/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "Enforce-ALZ-Sandbox",
                "location": "eastus2",
                "systemData": {
                  "createdBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "createdByType": "Application",
                  "createdAt": "2026-01-21T00:37:29.6807519Z",
                  "lastModifiedBy": "2fb557e8-a7b2-4828-b19d-b2ddee966115",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2026-01-21T00:37:29.6807519Z"
                }
              }
            },
            "RoleAssignments": {
              "/providers/microsoft.management/managementgroups/sandbox/providers/microsoft.authorization/roleassignments/11d7473f-13d8-4fe3-be55-b992cb6fe9b2": [
                {
                  "RoleAssignmentId": "/providers/microsoft.management/managementgroups/sandbox/providers/microsoft.authorization/roleassignments/11d7473f-13d8-4fe3-be55-b992cb6fe9b2",
                  "Scope": "/providers/Microsoft.Management/managementGroups/sandbox",
                  "DisplayName": "id-alz-mgmt-eastus2-apply-001",
                  "SignInName": null,
                  "RoleDefinitionName": "Owner",
                  "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "ObjectId": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ]
            },
            "DiagnosticSettings": {},
            "Subscriptions": {},
            "ManagementGroups": {}
          }
        }
      }
    },
    "CustomRoleDefinitions": {
      "0d95a564-76a6-5489-9bb7-ee099c979392": {
        "roleName": "Subscription-Owner (alz)",
        "type": "CustomRole",
        "description": "Delegated role for subscription owner generated from subscription Owner role",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/alz"
        ],
        "permissions": [
          {
            "actions": [
              "*"
            ],
            "notActions": [
              "Microsoft.Authorization/*/write",
              "Microsoft.Network/vpnGateways/*",
              "Microsoft.Network/expressRouteCircuits/*",
              "Microsoft.Network/routeTables/write",
              "Microsoft.Network/vpnSites/*"
            ],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-21T00:36:53.1189546Z",
        "updatedOn": "2026-01-21T00:36:53.1189546Z",
        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
        "updatedBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590"
      },
      "1a71cbe6-6cb7-57f5-9cf1-f3971f40fcfa": {
        "roleName": "Security-Operations (alz)",
        "type": "CustomRole",
        "description": "Security Administrator role with a horizontal view across the entire Azure estate and the Azure Key Vault purge policy.",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/alz"
        ],
        "permissions": [
          {
            "actions": [
              "*/read",
              "*/register/action",
              "Microsoft.KeyVault/locations/deletedVaults/purge/action",
              "Microsoft.PolicyInsights/*",
              "Microsoft.Authorization/policyAssignments/*",
              "Microsoft.Authorization/policyDefinitions/*",
              "Microsoft.Authorization/policyExemptions/*",
              "Microsoft.Authorization/policySetDefinitions/*",
              "Microsoft.Insights/alertRules/*",
              "Microsoft.Resources/deployments/*",
              "Microsoft.Security/*",
              "Microsoft.Support/*"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-21T00:36:53.1889709Z",
        "updatedOn": "2026-01-21T00:36:53.1889709Z",
        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
        "updatedBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590"
      },
      "32d651bb-1537-3a6b-024e-2205aac0943a": {
        "roleName": "Azure Landing Zones Management Group Contributor (alz-mgmt)",
        "type": "CustomRole",
        "description": "This is a custom role created by the Azure Landing Zones Accelerator for Writing the Management Group Structure.",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/54d665dd-30f1-45c5-a8d5-d6ffcdb518f9"
        ],
        "permissions": [
          {
            "actions": [
              "Microsoft.Management/managementGroups/delete",
              "Microsoft.Management/managementGroups/read",
              "Microsoft.Management/managementGroups/subscriptions/delete",
              "Microsoft.Management/managementGroups/subscriptions/write",
              "Microsoft.Management/managementGroups/settings/read",
              "Microsoft.Management/managementGroups/settings/write",
              "Microsoft.Management/managementGroups/settings/delete",
              "Microsoft.Management/managementGroups/write",
              "Microsoft.Management/managementGroups/subscriptions/read",
              "Microsoft.Authorization/policyDefinitions/write",
              "Microsoft.Authorization/policySetDefinitions/write",
              "Microsoft.Authorization/policyAssignments/write",
              "Microsoft.Authorization/roleDefinitions/write",
              "Microsoft.Authorization/*/read",
              "Microsoft.Authorization/roleAssignments/write",
              "Microsoft.Authorization/roleAssignments/delete",
              "Microsoft.Insights/diagnosticSettings/write"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-20T23:23:07.2229904Z",
        "updatedOn": "2026-01-20T23:23:07.2229904Z",
        "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
        "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9"
      },
      "45613b78-4a7e-5d1f-ab20-8c6dec903bb5": {
        "roleName": "Network-Management (alz)",
        "type": "CustomRole",
        "description": "Platform-wide global connectivity management: virtual networks, UDRs, NSGs, NVAs, VPN, Azure ExpressRoute, and others",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/alz"
        ],
        "permissions": [
          {
            "actions": [
              "*/read",
              "Microsoft.Network/*",
              "Microsoft.Resources/deployments/*",
              "Microsoft.Support/*"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-21T00:36:53.1097036Z",
        "updatedOn": "2026-01-21T00:36:53.1097036Z",
        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
        "updatedBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590"
      },
      "85f7bdaf-24fb-5c33-80ad-ffae9246eeb9": {
        "roleName": "Application-Owners (alz)",
        "type": "CustomRole",
        "description": "Contributor role granted for application/operations team at resource group level",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/alz"
        ],
        "permissions": [
          {
            "actions": [
              "*"
            ],
            "notActions": [
              "Microsoft.Authorization/*/write",
              "Microsoft.Network/publicIPAddresses/write",
              "Microsoft.Network/virtualNetworks/write",
              "Microsoft.KeyVault/locations/deletedVaults/purge/action"
            ],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-21T00:36:53.5397034Z",
        "updatedOn": "2026-01-21T00:36:53.5397034Z",
        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
        "updatedBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590"
      },
      "89737a5a-a182-3c5a-849f-aafd11be99ff": {
        "roleName": "Azure Landing Zones Subscription Reader (alz-mgmt)",
        "type": "CustomRole",
        "description": "This is a custom role created by the Azure Landing Zones Accelerator for Reading the platform subscriptions.",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/54d665dd-30f1-45c5-a8d5-d6ffcdb518f9"
        ],
        "permissions": [
          {
            "actions": [
              "*/read",
              "Microsoft.Resources/subscriptions/resourceGroups/write",
              "Microsoft.ManagedIdentity/userAssignedIdentities/write",
              "Microsoft.Automation/automationAccounts/write",
              "Microsoft.OperationalInsights/workspaces/write",
              "Microsoft.OperationalInsights/workspaces/linkedServices/write",
              "Microsoft.OperationsManagement/solutions/write",
              "Microsoft.Insights/dataCollectionRules/write",
              "Microsoft.Authorization/locks/write",
              "Microsoft.Network/*/write",
              "Microsoft.Resources/deployments/whatIf/action",
              "Microsoft.Resources/deployments/write",
              "Microsoft.SecurityInsights/onboardingStates/write"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-20T23:23:07.338538Z",
        "updatedOn": "2026-01-20T23:23:07.338538Z",
        "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
        "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9"
      },
      "b0b8fb15-899d-5b9d-af28-c92583a31ed4": {
        "roleName": "Network-Subnet-Contributor (alz)",
        "type": "CustomRole",
        "description": "Enterprise-scale custom Role Definition. Grants full access to manage Virtual Network subnets, but no other network resources.",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/alz"
        ],
        "permissions": [
          {
            "actions": [
              "Microsoft.Authorization/*/read",
              "Microsoft.Insights/alertRules/*",
              "Microsoft.ResourceHealth/availabilityStatuses/read",
              "Microsoft.Resources/deployments/*",
              "Microsoft.Resources/subscriptions/resourceGroups/read",
              "Microsoft.Support/*",
              "Microsoft.Network/*/read",
              "Microsoft.Network/virtualNetworks/subnets/*"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-21T00:36:53.1136522Z",
        "updatedOn": "2026-01-21T00:36:53.1136522Z",
        "createdBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590",
        "updatedBy": "bbd0bbbd-16fc-4c39-a530-65ced78b7590"
      },
      "bf7bae25-9c1f-9d76-7b03-e57c3d4aaec4": {
        "roleName": "Azure Landing Zones Management Group Reader (alz-mgmt)",
        "type": "CustomRole",
        "description": "This is a custom role created by the Azure Landing Zones Accelerator for Reading the Management Group Structure.",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/54d665dd-30f1-45c5-a8d5-d6ffcdb518f9"
        ],
        "permissions": [
          {
            "actions": [
              "Microsoft.Management/managementGroups/read",
              "Microsoft.Management/managementGroups/subscriptions/read",
              "Microsoft.Management/managementGroups/settings/read",
              "Microsoft.Authorization/*/read",
              "Microsoft.Authorization/policyDefinitions/write",
              "Microsoft.Authorization/policySetDefinitions/write",
              "Microsoft.Authorization/roleDefinitions/write",
              "Microsoft.Authorization/policyAssignments/write",
              "Microsoft.Insights/diagnosticSettings/write",
              "Microsoft.Insights/diagnosticSettings/read",
              "Microsoft.Resources/deployments/whatIf/action",
              "Microsoft.Resources/deployments/write",
              "Microsoft.Resources/deploymentStacks/read",
              "Microsoft.Resources/deploymentStacks/validate/action"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-20T23:23:07.268203Z",
        "updatedOn": "2026-01-20T23:23:07.268203Z",
        "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
        "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9"
      },
      "f95e05f3-0265-c57d-a9f9-d78015027a11": {
        "roleName": "Azure Landing Zones Subscription Owner (alz-mgmt)",
        "type": "CustomRole",
        "description": "This is a custom role created by the Azure Landing Zones Accelerator for Writing in platform subscriptions.",
        "assignableScopes": [
          "/providers/Microsoft.Management/managementGroups/54d665dd-30f1-45c5-a8d5-d6ffcdb518f9"
        ],
        "permissions": [
          {
            "actions": [
              "*"
            ],
            "notActions": [],
            "dataActions": [],
            "notDataActions": []
          }
        ],
        "createdOn": "2026-01-20T23:23:07.2002424Z",
        "updatedOn": "2026-01-20T23:23:07.2002424Z",
        "createdBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9",
        "updatedBy": "1c928d69-50e7-4ffe-a193-f1dbc9ec2ff9"
      }
    }
  }
}
